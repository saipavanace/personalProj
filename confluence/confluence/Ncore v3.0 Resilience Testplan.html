<h1 id="Ncorev3.0ResilienceTestplan-TableofContentstrue"><style>[data-colorid=w2e7wnkvnl]{color:#007600} html[data-color-mode=dark] [data-colorid=w2e7wnkvnl]{color:#89ff89}[data-colorid=ks88ea2pb3]{color:#b01100} html[data-color-mode=dark] [data-colorid=ks88ea2pb3]{color:#ff604f}[data-colorid=y6g79ukxus]{color:#b00113} html[data-color-mode=dark] [data-colorid=y6g79ukxus]{color:#fe4f61}</style>Table of Contents<style type="text/css">/*<![CDATA[*/
div.rbtoc1759724707658 {padding: 0px;}
div.rbtoc1759724707658 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1759724707658 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1759724707658">
<ul class="toc-indentation">
<li><span class="TOCOutline">1</span> <a href="#Ncorev3.0ResilienceTestplan-TableofContentstrue">Table of Contents</a>
<ul class="toc-indentation">
<li><span class="TOCOutline">1.1</span> <a href="#Ncorev3.0ResilienceTestplan-1.History">1. History</a></li>
<li><span class="TOCOutline">1.2</span> <a href="#Ncorev3.0ResilienceTestplan-1.1Version">1.1 Version</a></li>
<li><span class="TOCOutline">1.3</span> <a href="#Ncorev3.0ResilienceTestplan-1.2.References">1.2. References</a></li>
</ul>
</li>
<li><span class="TOCOutline">2</span> <a href="#Ncorev3.0ResilienceTestplan-2.Introduction">2. Introduction</a>
<ul class="toc-indentation">
<li><span class="TOCOutline">2.1</span> <a href="#Ncorev3.0ResilienceTestplan-2.1Topleveldiagram">2.1 Top level diagram</a></li>
<li><span class="TOCOutline">2.2</span> <a href="#Ncorev3.0ResilienceTestplan-2.2Faulttypesandtheirtriggers">2.2 Fault types and their triggers</a></li>
</ul>
</li>
<li><span class="TOCOutline">3</span> <a href="#Ncorev3.0ResilienceTestplan-3.Testbenchdescription">3. Testbench description</a>
<ul class="toc-indentation">
<li><span class="TOCOutline">3.1</span> <a href="#Ncorev3.0ResilienceTestplan-3.1TransportErrorInjectionandChecking(SMIerrors)">3.1 Transport Error Injection and Checking (SMI errors)</a></li>
<li><span class="TOCOutline">3.2</span> <a href="#Ncorev3.0ResilienceTestplan-3.1Typesoffaultinjectionandchecksimplementedinthetestbench:">3.1 Types of fault injection and checks implemented in the testbench:</a>
<ul class="toc-indentation">
<li><span class="TOCOutline">3.2.1</span> <a href="#Ncorev3.0ResilienceTestplan-Mission/Latentfaultinjection">Mission/Latent fault injection</a></li>
<li><span class="TOCOutline">3.2.2</span> <a href="#Ncorev3.0ResilienceTestplan-MissionandLatentFaultCauses">Mission and Latent Fault Causes</a></li>
<li><span class="TOCOutline">3.2.3</span> <a href="#Ncorev3.0ResilienceTestplan-Systemlevelfaultcontrollerverification">System level fault controller verification</a></li>
<li><span class="TOCOutline">3.2.4</span> <a href="#Ncorev3.0ResilienceTestplan-BISTsequenceandcorrespondingchecks">BIST sequence and corresponding checks</a></li>
<li><span class="TOCOutline">3.2.5</span> <a href="#Ncorev3.0ResilienceTestplan-RTLbehaviorforimportantscenarios">RTL behavior for important scenarios</a></li>
</ul>
</li>
<li><span class="TOCOutline">3.3</span> <a href="#Ncorev3.0ResilienceTestplan-3.2Resiliencyparametervaluesintheconfigurationsused">3.2 Resiliency parameter values in the configurations used</a></li>
<li><span class="TOCOutline">3.4</span> <a href="#Ncorev3.0ResilienceTestplan-4.Resilience">4. Resilience</a></li>
</ul>
</li>
</ul>
</div></h1><h2 id="Ncorev3.0ResilienceTestplan-1.History">1.&nbsp; &nbsp; History</h2><h2 id="Ncorev3.0ResilienceTestplan-1.1Version">1.1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Version</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner">version</div></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner">date</div></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner">comments</div></div></th><th colspan="1" class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner">Reviewers</div></div></th></tr></thead><tbody><tr><td class="confluenceTd">0.1</td><td class="confluenceTd">02/22/2019</td><td class="confluenceTd"><p>Added first draft (similar to the Ncore 2.6 resiliency testplan)</p></td><td colspan="1" class="confluenceTd"><br /></td></tr><tr><td colspan="1" class="confluenceTd">0.2</td><td colspan="1" class="confluenceTd">05/31/2019</td><td colspan="1" class="confluenceTd">Modified the testplan w.r.t. Ncore 3.0 setup, added current resiliency verification status</td><td colspan="1" class="confluenceTd"><br /></td></tr><tr><td colspan="1" class="confluenceTd">0.3</td><td colspan="1" class="confluenceTd">03/06/2020</td><td colspan="1" class="confluenceTd">Modified smi error injection scheme</td><td colspan="1" class="confluenceTd"><br /></td></tr><tr><td colspan="1" class="confluenceTd">0.4</td><td colspan="1" class="confluenceTd">07/01/2020</td><td colspan="1" class="confluenceTd">Updated test plan as per latest resiliency verification environment.</td><td colspan="1" class="confluenceTd"><br /></td></tr></tbody></table></div><h2 id="Ncorev3.0ResilienceTestplan-1.2.References">1.2.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; References</h2><ul><li><a href="https://arterisip.atlassian.net/wiki/spaces/OP/pages/16777888/fault_checker" data-linked-resource-id="16777888" data-linked-resource-version="12" data-linked-resource-type="page">fault_checker</a></li><li><a href="https://arterisip.atlassian.net/wiki/spaces/OP/pages/16777526/Arch-Resiliency" data-linked-resource-id="16777526" data-linked-resource-version="3" data-linked-resource-type="page">Arch-Resiliency</a></li><li><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16777310/Ncore+2.6+Resiliency+Verification+Testplan+Unit+Level+and+System+Level" data-linked-resource-id="16777310" data-linked-resource-version="38" data-linked-resource-type="page">Ncore 2.6 Resiliency Verification Testplan (Unit Level and System Level)</a></li><li><a href="https://arterisip.atlassian.net/wiki/spaces/OP/pages/16777366/FSC+Testplan" data-linked-resource-id="16777366" data-linked-resource-version="17" data-linked-resource-type="page">FSC Testplan</a></li><li><a class="external-link" href="https://confluence.arteris.com/display/OP/FLTC+Testplan" rel="nofollow">https://confluence.arteris.com/display/OP/FLTC+Testplan</a></li><li><a class="external-link" href="https://svn.arteris.com/engdocs/trunk/Sonata%20Project/Concerto%20Rev%20C%20-%20Working/Ncore3SysArch.pdf?view=log" rel="nofollow">https://svn.arteris.com/engdocs/trunk/Sonata%20Project/Concerto%20Rev%20C%20-%20Working/Ncore3SysArch.pdf?view=log</a>&nbsp;</li><li><a class="external-link" href="https://confluence.arteris.com/pages/viewpage.action?pageId=4853089" rel="nofollow">https://confluence.arteris.com/pages/viewpage.action?pageId=4853089</a></li><li><a class="external-link" href="https://confluence.arteris.com/display/OP/Ncore+3.0+FSC+Micro-Architecture+Specification" rel="nofollow">https://confluence.arteris.com/display/OP/Ncore+3.0+FSC+Micro-Architecture+Specification</a></li></ul><p><strong>NOTE</strong>: First three documents should suffice to understand the resiliency feature.</p><p><strong>Resiliency verification status as of 05/31/3019:</strong></p><p><a href="/wiki/spaces/ENGR/pages/16777284/Ncore+v3.0+Resilience+Testplan?preview=%2F16777284%2F16779275%2FResiliency_status_ak053019.docx"><span style="background: url('/wiki/s/-672721829/6452/d621ad2a33e27b90ca05c475b216bfab745e08a2/1000.0.0-d621ad2a33e2/_/download/resources/com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-resources/images/placeholder-medium-doc.png'); width: 177px; height: 95px; display: inline-block; padding-top: 155px; margin: 2px; border: 1px solid #ddd; text-align: center; vertical-align: text-bottom; text-decoration: none; font-size: 12px; color: #000;">Resiliency_status_ak0530&hellip;</span></a></p><p><br /></p><p><strong>Knowledge transfer meetings:</strong></p><p>URL:&nbsp;&nbsp;&nbsp; <a class="external-link" href="https://synfs.arteris.com:5001/" rel="nofollow">https://synfs.arteris.com:5001/</a></p><p>Login:&nbsp;&nbsp; training (no password)</p><p>close the default viewer window on the webpage</p><p>folder:&nbsp;&nbsp; File Station -&gt; Video -&gt; &ldquo;Ncore 3.0 Resilience KB&rdquo; -&gt;</p><p>2.6 / basics:</p><p>knowledge transfer</p><p>knowledge transfer II</p><p>3.0:</p><p>Testbench knowledge transfer</p><p>Signals knowledge transfer</p><p><br /></p><h1 id="Ncorev3.0ResilienceTestplan-2.Introduction">2.&nbsp;&nbsp;&nbsp;Introduction</h1><p>In this&nbsp;testplan, testbench support for Resiliency verification has been described including the knobs used in the testbench to control the fault injection, Checks and used APFs.</p><p>You can find more detail on Resiliency feature on the&nbsp;above mentioned&nbsp;references.</p><h2 id="Ncorev3.0ResilienceTestplan-2.1Topleveldiagram">2.1 Top level diagram</h2><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16777284/image2019-7-31%2010_16_59.png?api=v2" /></span></p><h2 id="Ncorev3.0ResilienceTestplan-2.2Faulttypesandtheirtriggers">2.2 Fault types and their triggers</h2><ol><li>Mission fault: All the&nbsp;below described&nbsp;faults lead to a Mission fault in that unit and the System<ol><li>Uncorrectable error from place holder:&nbsp;This fault comes into the picture when the placeholder has been enabled in RTL. This error comes when a transaction comes from an Agent with uncorrectable error injected and the placeholder logic catches it.</li><li>Uncorrectable error from SMI interface checker:&nbsp;This fault occurs when the SMI request (header/message/data) is received by a unit with uncorrectable error injected.</li><li>Uncorrectable error from Memory: When uncorrectable error has been detected inside memory.</li><li>Other than the above faults, Mission fault can be triggered if the output signals of functional and checker units are different.</li></ol></li><li>Latent fault<ol><li>To catch the issue in the fault checker itself, fault checker logic is duplicated and then outputs of both fault checker units (functional and checker) are compared and if they do not match , it should drive the Latent fault. This fault only comes into the picture if the Unit is duplicated or the BIST sequence is running.</li><li>Note :&nbsp;<span class="legacy-color-text-blue3">Any mismatch in output signals of the functional unit and late unit excluding uncorrectable faults causes a mission fault. Which means only mismatch related to uncorrectable error fault causes latent faule, else it will only assert Mission fault.</span></li></ol></li><li>Correctable error fault<ol><li>Its drivers are the same as the Mission fault but mission fault triggers when uncorrectable error comes whereas cerr_fault occurs when correctable error fault occurs.</li></ol></li></ol><h1 id="Ncorev3.0ResilienceTestplan-3.Testbenchdescription">3. Testbench description</h1><h2 id="Ncorev3.0ResilienceTestplan-3.1TransportErrorInjectionandChecking(SMIerrors)">3.1 Transport Error Injection and Checking (SMI errors)</h2><p><strong>Notes:</strong></p><ul><li>SMI errors can be injected at HDR, NDP, or DP, and the types of errors can be injected as HDR, NDP, and DP. Errors will be injected into randomly selected bits to the full length, including payloads and their protection bits.</li><li>&nbsp;Error injection is controlled by plus args.</li><li>&nbsp;+inj_cntl=%d. The value is encoded bit[2] enables parity error injection, bit 1 and bit 0 enable SECDED error injection with bit 1 as uncorrectable error and bit 0 as correctable error.<ul><li>+inj_cntl&nbsp; = 1 will inject ECC Correctable Error.</li><li>+inj_cntl&nbsp; = 2 will inject ECC UnCorrectable Error.</li><li>+inj_cntl&nbsp; = 4 will inject Parity UnCorrectable Error.</li></ul></li><li>&nbsp;alternatively, one can use +inject_smi_corr_error, or +inject_smi_uncorr_error to control SECDED error injection. Note: the selection of parity or SECDED protection is built into Json file. In this method, one has finer control as where the error will be injected, for example smi header, smi_dp, or smi_ndp. For smi_ndp, one can further control error injection to a particular message, e.g. +cmd_req_err_inj.</li><li>&nbsp;One can also use +inject_smi_checkbits_only to restrict error injection to protection bits only. This maybe useful for debugging as the message itself is error-free.</li></ul><p>&nbsp; &nbsp; &nbsp; * Above controls are being set from runsim_testlist.json and are used in smi_driver.sv and ConcertoHelperFunction</p><h2 id="Ncorev3.0ResilienceTestplan-3.1Typesoffaultinjectionandchecksimplementedinthetestbench:"><span data-colorid="y6g79ukxus">&nbsp;</span><span data-colorid="w2e7wnkvnl">&nbsp;</span><span data-colorid="ks88ea2pb3">&nbsp;</span>3.1 Types of fault injection and checks implemented in the testbench:</h2><p><strong>Notes:</strong></p><ol><li>All scoreboards should be disabled in all tests except in case of Correctable error injection.</li><li>If a transaction has been killed in the middle of the test due to error injection, then test should exit after a fixed timeout as the test may hang if not ended forcefully.</li><li>Uncorrectable errors should be injected in only one unit in any test because injecting uncorrectable errors in multiple units in a single test might lead to a system hang and units might stop receiving transactions. Then, uncorrectable errors won't be not detected by all the selected units which will lead to test failure.</li><li>Latent&nbsp;fault should always be 0 in case of Unit Duplication except when BIST seq is running,in that case, it should follow the BIST step requirements.</li><li>use +expect_mission_fault = 1 plusArg to kill test once error is injected and mission fault is detected.</li></ol><h3 id="Ncorev3.0ResilienceTestplan-Mission/Latentfaultinjection"><strong>Mission/Latent fault injection</strong></h3><ol><li>Force different outputs at&nbsp;functional and checker modules (on checker module only if the unit duplication is enabled) using the following steps:<ol><li>Knob used:<strong>&nbsp;&quot;</strong>test_unit_duplication<strong><strong>&quot;</strong></strong></li><li>Forces randomly selected outputs of&nbsp;functional or checker module different than the other (to select the module &quot;inject_unit&quot; knobs is used),<ol><li>Any mismatch in output signals of the functional unit and late unit excluding uncorrectable faults causes a mission fault.</li></ol></li><li>Checks:<ol><li>Mission fault should be high and the Latent fault should be low of that unit</li></ol></li><li>Then, call BIST sequence to clear out the faults</li><li>Repeat it for all the outputs and all the units</li></ol></li><li>Inject placeholder faults<ol><li>This is a manual test</li><li>In this, a configuration is created with a few added signals related to&nbsp;placeholder</li><li>Then, RTL is modified manually to use the added input signals to drive Mission/Latent/Cerr faults</li><li>Testbench randomly drives those added signals</li><li>At the end of the simulation, check all the faults according to what testbench is driving</li></ol></li></ol><h3 id="Ncorev3.0ResilienceTestplan-MissionandLatentFaultCauses">Mission and Latent Fault Causes</h3><ol><li>Any mismatch in output signals of the functional unit and late unit excluding uncorrectable faults causes a mission fault.</li><li>The table below.</li></ol><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Uncorrectable Functional</p></th><th style="text-align: left;" class="confluenceTh"><p>Uncorrectable Late</p></th><th style="text-align: left;" class="confluenceTh"><p>Mission Fault</p></th><th colspan="1" style="text-align: left;" class="confluenceTh"><p>Latent Fault</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd">1</td><td style="text-align: left;" class="confluenceTd">1</td><td style="text-align: left;" class="confluenceTd">1</td><td colspan="1" style="text-align: left;" class="confluenceTd">0</td></tr><tr><td style="text-align: left;" class="confluenceTd">1</td><td style="text-align: left;" class="confluenceTd">0</td><td style="text-align: left;" class="confluenceTd">1</td><td colspan="1" style="text-align: left;" class="confluenceTd">1</td></tr><tr><td style="text-align: left;" class="confluenceTd">0</td><td style="text-align: left;" class="confluenceTd">1</td><td style="text-align: left;" class="confluenceTd">1</td><td colspan="1" style="text-align: left;" class="confluenceTd">1</td></tr><tr><td style="text-align: left;" class="confluenceTd">0</td><td style="text-align: left;" class="confluenceTd">0</td><td style="text-align: left;" class="confluenceTd">0</td><td colspan="1" style="text-align: left;" class="confluenceTd">0</td></tr></tbody></table></div><h3 id="Ncorev3.0ResilienceTestplan-Systemlevelfaultcontrollerverification">System level fault controller verification</h3><p>&nbsp; &nbsp; &nbsp;System level fault controller verification is pending.</p><h3 id="Ncorev3.0ResilienceTestplan-BISTsequenceandcorrespondingchecks"><strong>BIST sequence and corresponding checks</strong></h3><ol><li>BIST sequence is run before any type of error injection or when clearing out all types of faults</li><li><a class="external-link" href="https://confluence.arteris.com/pages/viewpage.action?spaceKey=OP&amp;title=Arch-Resiliency" rel="nofollow">https://confluence.arteris.com/pages/viewpage.action?spaceKey=OP&amp;title=Arch-Resiliency</a>&nbsp;: Page 8</li><li>One BIST step completes after following steps:<ol><li>bist_next (System) == 1</li><li>bist_next_ack of a unit == 1</li><li>bist_next (System) == 0</li><li>bist_next_ack of a unit == 0</li></ol></li><li>Checks are implemented per unit:<br /><ol><li>After the first BIST step, Corr/Mission/Latent faults should all be 0</li><li>After the second BIST step, Mission and Latent both faults go to 1</li><li>After the third BIST step, Mission fault should be 0 and Latent fault should be 1</li><li>After the fourth BIST step,&nbsp;Mission fault should be 1 and Latent fault should be 0</li><li>After final BIST step, Mission/Latent faults should all be 0<ol><li><p>After final BIST step finishes, wait for N cycles then, check all faults should be 0</p></li></ol></li></ol></li></ol><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="https://arterisip.atlassian.net/wiki/download/attachments/16777284/error_protbits_msg_user.PNG?api=v2" /></span><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="https://arterisip.atlassian.net/wiki/download/attachments/16777284/BIST%20steps.PNG?api=v2" /></span></p><h3 id="Ncorev3.0ResilienceTestplan-RTLbehaviorforimportantscenarios">RTL behavior for important&nbsp;scenarios</h3><ol><li>Notes<ol><li>Mission fault is driven by mission_fault_tree and Latent fault is XOR of the latent and mission fault trees.</li><li>Mission_fault_tree is driven by the uncorrectable errors of functional unit (placeholder, smi interface or memory) and XOR of functional and checker unit outputs.</li><li>Latent_fault_tree is driven by the same aforementioned uncorrectable errors but of *checker* unit and XOR of functional and checker unit outputs.</li></ol></li><li>Scenario #1:<ol><li>Let's say placeholder fault of both functional and checker units are high, it will lead to high Mission fault tree and Latent fault tree. This will further lead to high Mission fault and low Latent fault.</li><li>After this, if smi interface fault goes high of check unit only, then, it will not lead to high Latent fault as in this case also, both Mission and Latent fault trees are high. Due to which, latent fault will be low.</li><li>Relevant Jira:&nbsp;

    

            



<style>
    .jira-issue {
        padding: 0 0 0 2px;
        line-height: 20px;
    }

    .jira-issue img {
        padding-right: 5px;
    }
    .jira-issue .aui-lozenge {
        line-height: 18px;
        vertical-align: top;
    }

    .jira-issue .icon {
        background-position: left center;
        background-repeat: no-repeat;
        display: inline-block;
        font-size: 0;
        max-height: 16px;
        text-align: left;
        text-indent: -9999em;
        vertical-align: text-bottom;
    }
</style>

    <span class="confluence-jim-macro jira-issue" data-jira-key="CONC-4922" data-client-id="SINGLE_bfb5209b-5e34-3655-9c0b-93d8d0d4bec5_16777284_624b3807a629c30068a79f50">
                <a href="https://arterisip.atlassian.net/browse/CONC-4922" class="jira-issue-key"><span class="aui-icon aui-icon-wait issue-placeholder" />CONC-4922</a>
                    -
            <span class="summary">Getting issue details...</span>
                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-default issue-placeholder">STATUS</span>
            </span>
</li></ol></li></ol><h2 id="Ncorev3.0ResilienceTestplan-3.2Resiliencyparametervaluesintheconfigurationsused">3.2 Resiliency parameter values in the configurations used</h2><h2 id="Ncorev3.0ResilienceTestplan-4.Resilience">4.&nbsp;&nbsp; Resilience</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col /><col /><col /><col /></colgroup><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner"><p><strong>Scenario</strong></p></div></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner"><p><strong>Hash Tag</strong></p></div></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner"><p><strong>Implemented?</strong></p></div></div></th><th class="confluenceTh"><div class="tablesorter-header-inner"><div class="tablesorter-header-inner"><p><strong>NOTE</strong></p></div></div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>Injecting all types of uncorrectable errors in one test?</p><p>and in the same test, drive the outputs of functional and checker units different?</p></td><td class="confluenceTd"><br /></td><td class="confluenceTd"><br /></td><td class="confluenceTd"><br /></td></tr></tbody></table></div>