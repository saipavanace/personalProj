<div class="table-wrap"><table data-layout="default" data-local-id="8c7731af-f86e-4500-bdfb-cfab76ce49cf" class="confluenceTable"><colgroup><col style="width: 190.0px;"/><col style="width: 190.0px;"/><col style="width: 190.0px;"/><col style="width: 190.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Version</strong></p></th><th class="confluenceTh"><p><strong>Editor</strong></p></th><th class="confluenceTh"><p><strong>Change</strong></p></th><th class="confluenceTh"><p><strong>Date</strong></p></th></tr><tr><td class="confluenceTd"><p>0.3</p></td><td class="confluenceTd"><p>Darshan Alagud</p></td><td class="confluenceTd"><p>Initial draft</p></td><td class="confluenceTd"><p>06-02-2023</p></td></tr><tr><td class="confluenceTd"><p>0.5</p></td><td class="confluenceTd"><p>Bernard Bonardi</p></td><td class="confluenceTd"><p>Added a Table of Contents and Figure #</p></td><td class="confluenceTd"><p>06-02-2023</p></td></tr><tr><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><h1 id="Supportforend-to-endmessageprotectioninconcertomux-TableofContents">Table of Contents</h1><style type='text/css'>/*<![CDATA[*/
div.rbtoc1759725034044 {padding: 0px;}
div.rbtoc1759725034044 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1759725034044 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1759725034044'>
<ul class='toc-indentation'>
<li><a href='#Supportforend-to-endmessageprotectioninconcertomux-TableofContents'>Table of Contents</a></li>
<li><a href='#Supportforend-to-endmessageprotectioninconcertomux-Overview'>Overview</a></li>
<li><a href='#Supportforend-to-endmessageprotectioninconcertomux-Modulesused'>Modules used</a></li>
<li><a href='#Supportforend-to-endmessageprotectioninconcertomux-ProtectionencodingonTXmessages'>Protection encoding on TX messages</a></li>
<li><a href='#Supportforend-to-endmessageprotectioninconcertomux-ErrordetectionandcorrectiononRXmessages'>Error detection and correction on RX messages</a></li>
<li><a href='#Supportforend-to-endmessageprotectioninconcertomux-Errorreporting'>Error reporting</a></li>
</ul>
</div><h1 id="Supportforend-to-endmessageprotectioninconcertomux-Overview">Overview</h1><p>The concerto mux is capable of implementing end-to-end protection for concerto and SMI messages (<a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">HW-SYM InterfaceSMI</a> )that are exchanged between Ncore units. It provides both ECC (SECDED) and parity protection options. This involves encoding of protection bits for messages (TX) going into the SMI layer and error detection and correction for messages (RX) received from the SMI layer. </p><h1 id="Supportforend-to-endmessageprotectioninconcertomux-Modulesused">Modules used</h1><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16163260/prot+interface" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16163260/prot+interface</a> </p><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16163276/correct+interface" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16163276/correct+interface</a> </p><h1 id="Supportforend-to-endmessageprotectioninconcertomux-ProtectionencodingonTXmessages">Protection encoding on TX messages</h1><p>For messages going into the SMI layer, the protection bits are encoded separately for </p><ol start="1"><li><p>The concerto message header which includes concerto message fields that are packetized into the ‘<em>ndp’</em> field of the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-NDP channel. The encoded protection bits are driven on the ‘<em>m_prot</em>’ field of the concerto message header. Width of bits on which protection is applied, <em>protWidth </em>= sum of widths of all concerto message fields that go into the ‘<em>ndp</em>’ field.</p></li><li><p>The SMI message header which includes fields in the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-NDP channel except for the ‘<em>ndp</em>’ field: ‘targ_id’, ‘src_id’, ‘msg_type’, and ‘msg_id’. Width of bits on which protection is applied, <em>protWidth </em>= width of all the SMI header fields except for ‘<em>ndp</em>’ field.</p></li><li><p>Each double-word (64-bits) of data, along with remaining payload fields, for messages with payload. The protection bits are driven on the ‘<em>dprot</em>’ field of the concerto message (The ‘dprot’ field along with ‘dwid', ‘be’, ‘dbad’ are all packetized into the ‘user’ signal of <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-DP channel ). Width of bits on which protection is applied, <em>protWidth</em> = 64 + wDwid + wDbab + wBe.</p></li></ol><p /><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/247234835/image-20230602-224304.png?api=v2"></span><p style="text-align: center;">Figure 1: Protection encoding on TX messages</p><h1 id="Supportforend-to-endmessageprotectioninconcertomux-ErrordetectionandcorrectiononRXmessages">Error detection and correction on RX messages</h1><p>For messages received from the SMI layer, error is detection and correction (only when ECC is used) is performed separately for:</p><ol start="1"><li><p>The concerto message header which includes concerto message fields that are depacketized from the ‘<em>ndp’</em> field of the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-NDP channel, except for the ‘<em>m_prot</em>’ field.</p></li><li><p>The SMI message header which includes fields in the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-NDP channel except for the ‘<em>ndp</em>’ field: ‘targ_id’, ‘src_id’, ‘msg_type’, and ‘msg_id’. The protection bits are encoded into the ‘<em>user</em>’ signals of the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-NDP channel.</p></li><li><p>Each double-word (64-bits) of data, along with remaining payload fields, for messages with payload. The protection bits are driven on the ‘<em>dprot</em>’ field of the concerto message (The ‘dprot’ field along with ‘dwid', ‘be’, ‘dbad’ are all packetized into the ‘<em>user</em>’ signal of <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168917/HW-SYM+InterfaceSMI" data-linked-resource-id="16168917" data-linked-resource-version="9" data-linked-resource-type="page">SMI</a>-DP channel ).</p></li></ol><p /><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/247234835/image-20230602-224323.png?api=v2"></span><p style="text-align: center;">Figure 2:  Error detection and correction on RX messages</p><h1 id="Supportforend-to-endmessageprotectioninconcertomux-Errorreporting">Error reporting</h1><p>Error is reported via a pair of correctable (rx_header_protection_c) error and uncorrectable (rx_header_protection_uc) error signals for each RX concerto message header, RX SMI message header, and for each double-word of data, along with the corresponding bits of the remaining fields in the payload.</p>