<h2 id="HW-SYMcreateInterruptPinParser-Path">Path</h2><p>hw-lib/js/sym_csr_lib.js</p><h2 id="HW-SYMcreateInterruptPinParser-Description">Description</h2><p>This is a factory function that returns a parser object with methods to parse an element (pin object) of the &quot;<em>interruptBitTrees</em>&quot; array (described here: <a class="external-link" href="https://confluence.arteris.com/display/ENGR/Generating+Interrupt+Status+Bit+Trees+from+IP-XACT+register+descriptions" rel="nofollow" style="text-decoration: none;">Generating Interrupt Status Bit Trees from IP-XACT register descriptions</a>). Internally the function converts each element of <em>interruptBitTrees</em> as a tree. A node in the tree stores an object that represents an interrupt valid/status bit. The children nodes represent interrupt bits that can set the interrupt bit in the parent node. An interrupt-bit object has the following structure:<br/><strong>Interrupt bit object</strong><span> structure</span>:<br/>{<br/>     <em>statusBit</em>: A positive integer or zero. Bit position of the interrupt status or valid bit in the interrupt register.<br/>     <em>statusRegister</em>: A string. Name of the interrupt register that contains the above status bit.<br/>     <em>addrBlock</em>: A string. Name of the address block that has the above register.<br/>     <em>blockID</em>: A positive integer or zero. Block ID of the Symphony (software-visible) block that has the interrupt register.<br/>     <em>maskBit</em>: A positive integer or zero. Bit position of the interrupt mask bit in the interrupt mask register.<br/>     <em>maskRegister</em>: A string. Name of the mask register that contains the above mask bit.<br/>}<br/><br/>Most parser methods return arrays of<span> </span><em>bit</em><span> </span>objects described above. Sometimes however it's more useful for the parser methods to group together interrupt bits that belong to the same register into a single object with the following structure:<br/><strong>Interrupt register object</strong><span> </span>structure:<br/>{<br/> <span> </span><em>name</em>: A string. Name of the register that has interrupt bits<br/> <span> </span><em>addrBlock</em>: A string. Name of the address block that has the above register.<br/> <span> </span><em>blockID</em>: A positive integer or zero. Block ID of the Symphony (software-visible) block that has the interrupt register.<br/> <span> </span><em>statusBits</em>: An array of<span> </span><em>statusBit</em><span> </span>types. Array of interrupt bit positions if any present in the register.<br/> <span> </span><em>maskBits</em>: An array of<span> </span><em>maskBit</em><span> </span>types. Array of mask bit positions if any present in the register.<br/>}</p><h2 id="HW-SYMcreateInterruptPinParser-Usage">Usage</h2><p>const tree   = createInterruptPinParser( pin );</p><p>Here pin refers to an element of the <em>interruptBitTrees</em> array. It returns a parser to parse an interrupt tree or interrupt pin object, with methods described below:</p><h2 id="HW-SYMcreateInterruptPinParser-Methods">Methods</h2><p>The parser provides the following functions to parse an &quot;<em>interruptBitTrees</em>&quot; JSON object:</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-find(fn)">find( fn )</h5><p>Returns the first interrupt bit object, in depth-first order, for which the function fn returns true. The callback function, fn, must take a single interrupt bit object and return a boolean value (or else will be interpreted in boolean context). If fn returns false for all node bits in the tree, then the find function returns undefined.</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-findPath(fn)">findPath( fn )</h5><p>Returns the path from the root of the tree to the interrupt bit object for which the function fn returns true. The callback function, fn, must take a single interrupt bit object and return a boolean value (or else will be interpreted in boolean context). The path object is an array of interrupt bit objects. If fn returns false for all interrupt bit objects in the tree, then findPath returns an empty array.</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-getSrcReg()">getSrcReg( )</h5><p>Returns the first interrupt register object (described above) that drives this tree or pin. In addition to the properties described above in the interrupt register object, the returned object includes a method called:</p><h6 id="HW-SYMcreateInterruptPinParser-getSrcReg(statusBit)">getSrcReg( statusBit )</h6><p>Returns the first interrupt register object that drives the specified interrupt bit/status bit (param). In addition, the returned object has another getSrcReg( <em>statusBit</em> ) method. The method returns undefined if no other interrupt bits drive the specified interrupt bit.</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-getSrcBits()">getSrcBits( )</h5><p>Returns an array of interrupt bit objects (described above) that drive this tree or pin. In addition to the properties described above in the interrupt bit object, the elements in the returned array include a method called:</p><h6 id="HW-SYMcreateInterruptPinParser-getSrcBits().1">getSrcBits( )</h6><p>Returns an array of interrupt bit objects that drives the specified interrupt bit/status bit represented by the array element. In addition to the usual properties in the interrupt bit object, the elements of the returned array in turn include another <em>getSrcBits</em>(  ) method. The method returns an empty array if no other interrupt bits drive the interrupt bit on which this method is called.</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-getRegisters*()">getRegisters*( )</h5><p>Returns an iterator that iterates over all the interrupt register objects in the tree. This includes both interrupt registers and mask registers.</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-forEach(fn)">forEach( fn )</h5><p>Works like the built-in method of .forEach( ) method of a JS array except that the callback function, fn, is called for every interrupt bit object in the tree.</p><p><br/></p><h5 id="HW-SYMcreateInterruptPinParser-Defaultiterator">Default iterator</h5><p>The default iterator iterates over or returns an interrupt bit object in each iteration. Thus the tree object returned by the <em>createInterruptPinParser</em>( ) function can be used in the context of for-of loops, as argument to Array.from( ), and with spread operators (...). This avoids having to create an array by iterating through the tree first and then iterating through the array again.</p><p><br/></p><h2 id="HW-SYMcreateInterruptPinParser-Usageexamples">Usage examples</h2><p>// Creating a tree / pinParser object<br/>const parser                     = createInterruptBitTreeParser( interruptBitTrees );     // Parser for parsing the whole <em>interruptBitTrees</em> array<br/>const pins                        = parser.getPinNames( );  // Returns an array of strings that must match the names of master interrupt interfaces of DUT<br/>const tree                         = parser.getTree( pins[0] ); // Returns a parser to pass an interrupt tree under an interrupt pin.</p><p>tree.find(bit =&gt; (bit.addrBlock === &quot;atu_atuI_0_CTL&quot;) &amp;&amp; (bit.statusRegister === &quot;CTLBWIR&quot;) &amp;&amp; (bit.statusBit === 0)); // Returns the corresponding<span> </span><em>bit</em><span> </span>object<br/>tree.findPath(bit =&gt; (bit.addrBlock === &quot;atu_atuI_0_CTL&quot;) &amp;&amp; (bit.statusRegister === &quot;CTLBWIR&quot;) &amp;&amp; (bit.statusBit === 0));  // Returns an array of<span> </span><em>bit</em><span> </span>objects from the top of the tree to the interrupt bit specified</p><p><span class="legacy-color-text-blue3">for( const register of tree) {</span><br/><span class="legacy-color-text-blue3">     // Print list of interrupt registers inside block with ID 3</span><br/><span class="legacy-color-text-blue3">}</span></p><p>const bitIterator           = parser.getTree( pins[1] );   // Returns an iterator to iterate over all interrupt bits that drive pins[1]<br/>const bitArray              = Array.from(bitIterator);    // Returns an array of all interrupt bits that drive interrupt pin, pins[1]</p><p>const topIntAccumulatorReg     = tree.getSrcReg( ); // Returns the top interrupt accumulator register object<br/>const level2InterruptReg            = topIntAccumulatorReg.getSrcReg( 3 ); // Returns the interrupt register that's driving bit 3 of the top interrupt accumulator register<br/>const level3InterruptReg            = level2InterruptReg.getSrcReg( 1 ); // Returns the interrupt register that's driving bit 1 of the level2InterruptReg returned above.</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>