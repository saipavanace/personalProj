<p><style>[data-colorid=va2378y5ll]{color:#ff5630} html[data-color-mode=dark] [data-colorid=va2378y5ll]{color:#cf2600}[data-colorid=bf9juwjw9u]{color:#ff5630} html[data-color-mode=dark] [data-colorid=bf9juwjw9u]{color:#cf2600}[data-colorid=yvsu5in9jl]{color:#ff5630} html[data-color-mode=dark] [data-colorid=yvsu5in9jl]{color:#cf2600}</style>This confluence page provides the steps to setup the Ncore container repo for a particular project and the steps to reproduce regression failures and how to make a fix and share it with other users.</p><p>Currently this Ncore container repo flow is setup from Ncore3.4 project onwards. This flow is not supported for previous projects.</p><p>Please refer to git advanced training session from <a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a>  to understand the details of git sub-modules.</p><p><a class="external-link" href="https://arteris-my.sharepoint.com/:v:/p/michel_klein/EeiYLI5rozdPlJroXc78sSUBxgSKZkWdidmsSWO0hR7xwA" rel="nofollow">https://arteris-my.sharepoint.com/:v:/p/michel_klein/EeiYLI5rozdPlJroXc78sSUBxgSKZkWdidmsSWO0hR7xwA</a></p><p><strong>Section A: Setting up Ncore container repo for Ncore3.4 project (Equivalent to setup_concerto and source SOURCEME ncore3.4):</strong></p><ol><li><p>mkdir &lt;workspace_dir_name&gt;</p></li><li><p>cd &lt;work_space_dir_name&gt;</p></li><li><p>git clone --recursive <a class="external-link" href="mailto:git@gitlab.arteris.com" rel="nofollow">git@gitlab.arteris.com</a>:hardware/ncore.git</p></li><li><p>cd ncore</p></li><li><p>git checkout Ncore3.4/master</p></li><li><p>git submodule update --remote</p></li><li><p>source setup_script.sh or source setup_script.csh</p></li><li><p>which maestro</p></li></ol><p>which maestro command should display as below:</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/45318437/image-20220823-001530.png?api=v2" /></span><p>Note: Notice if you go into any individual repo directory (hw-ncr, hw-test-projects, hw-lib, hw-ccp, hw-sym, hw-scripts) you will see they all will in detached head state. This detached head will point to the latest git hash of that repo at the time of creating the workspace. </p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/45318437/image-20220823-000938.png?api=v2" /></span><p>You can update the repo time to time by running step 6 from ncore directory. </p><ol><li><p>cd &lt;work_space_dir_name&gt;/ncore</p></li><li><p>git submodule update --remote (equivalent to update_concerto)</p></li></ol><p>If you want to check in files you need to switch to the appropriate branch using git checkout command (refer to the below table for which branch to use for each individual repo). The steps to push files to the repository are same as before.</p><p><strong>Example for hw-ncr:</strong></p><ol><li><p>cd &lt;work_space_dir_name&gt;/ncore/hw-ncr</p></li><li><p>git checkout Ncore3.4/develop</p></li></ol><div class="table-wrap"><table data-layout="default" data-local-id="b0c60391-431f-4864-81a6-0b0cfa03d4c5" class="confluenceTable"><colgroup><col style="width: 340.0px;" /><col style="width: 340.0px;" /></colgroup><tbody><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p><strong>Repo Name</strong></p></th><td class="confluenceTd"><p><strong>Ncore3.4 (Branch name)</strong></p></td></tr><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p>hw-ncr</p></th><td class="confluenceTd"><p>Ncore3.4/develop</p></td></tr><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p>hw-test-projects</p></th><td class="confluenceTd"><p>Ncore3.4/develop</p></td></tr><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p>hw-sym</p></th><td class="confluenceTd"><p>master</p></td></tr><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p>hw-lib</p></th><td class="confluenceTd"><p>master</p></td></tr><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p>hw-ccp</p></th><td class="confluenceTd"><p>Ncore3</p></td></tr><tr><th data-highlight-colour="var(--ds-background-neutral, #F4F5F7)" class="confluenceTh"><p>hw-scripts</p></th><td class="confluenceTd"><p>Ncore3</p></td></tr></tbody></table></div><p><strong>Section B: Steps to reproduce regression failure:</strong></p><p>If you already have a ncore container repo set up, do the following steps</p><ol><li><p>cd &lt;workspace_dir_name&gt;/ncore</p></li><li><p>git checkout &lt;regression_branch_name&gt;</p></li><li><p>git submodule update</p></li><li><p>source setup_script.sh or source setup_script.csh</p></li><li><p>which maestro</p></li></ol><p>If you want to start with fresh ncore container repo set up, do the following steps:</p><ol><li><p>mkdir &lt;workspace_dir_name&gt;</p></li><li><p>cd &lt;work_space_dir_name&gt;</p></li><li><p>git clone --recursive <a class="external-link" href="mailto:git@gitlab.arteris.com" rel="nofollow">git@gitlab.arteris.com</a>:hardware/ncore.git</p></li><li><p>cd ncore</p></li><li><p>git checkout &lt;regression_branch_name&gt;</p></li><li><p>git submodule update</p></li><li><p>source setup_script.sh or source setup_script.csh</p></li><li><p>which maestro</p></li><li><p>Run the necessary runsim or node command for the failing test.</p></li></ol><p>which maestro will not be pointing to master/maestro-product/stable, instead it will be pointing to maestro build that was used at the time of running the regression <span data-colorid="va2378y5ll">(The below output is just an example and maestro build no in this case is 5107)</span></p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/45318437/image-20220823-003038.png?api=v2" /></span><p>For Ncore3.4, ioaiu_nightly, nightly, nightly_fsys, nightly_rand regressions have been updated to follow the Ncore container repo flow. So, the regression_branch_name (used in step 2 or step 5) would be NCore_3.4/&lt;regression_name&gt;_regression_&lt;buildno&gt;</p><p>Example: For this particular nightly_fsys regression (see red box in the screen shot):</p><p><a class="external-link" href="http://jenkins.arteris.com:8080/job/NCore_3.4/job/nightly_fsys/32/console" rel="nofollow">NCore_3.4 &raquo; nightly_fsys #32 Console [Jenkins] (arteris.com)</a></p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/45318437/image-20220822-223556.png?api=v2" /></span><p>The regression_branch_name will be NCore_3.4/nightly_fsys_regression_32 (highlighted in red box below)</p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/45318437/image-20220822-224410.png?api=v2" /></span><p><strong>Section C: Steps to share fix with others:</strong></p><p>After you are able to reproduce a specific regression failure (Following steps in Section B). Let&rsquo;s say you want to make a fix and share it work another user. Below are the steps:</p><ol><li><p>cd &lt;workspace_dir_name&gt;/ncore/hw-ncr</p></li><li><p>git checkout -b &lt;branch_name_for_fix&gt;</p></li><li><p>Update the required files and do git add &lt;updated_file_name&gt;; git commit -m &ldquo;Log message&rdquo;; git push</p></li><li><p>git push origin &lt;branch_name_for_fix&gt;</p></li></ol><p><span data-colorid="yvsu5in9jl">Note: Step 4 is required to be done only once by the person creating the branch for the first time.</span></p><p>Now the other user can setup the particular failing regression workspace using the steps mentioned in Section B. To get the fix from the other user using branch name.</p><ol><li><p>cd &lt;workspace_dir_name&gt;/ncore/hw-ncr</p></li><li><p>git checkout &lt;branch_name_for_fix&gt;</p></li><li><p>More files can be updated and pushed to the same branch using git add &lt;updated_file_name&gt;; git commit -m &ldquo;Log message&rdquo;; git push</p></li></ol><p>In case the updated file is design .tachl file you need to run refresh_rtl as below to see the changes while running simulations (Notice the -b &lt;build no&gt; option because we want to use the same maestro build used during regression. The build no is the number you will see when you run which maestro command. See Section B for details)</p><ol><li><p>$WORK_TOP/dv/scripts/refresh_rtl -b &lt;build no&gt; </p></li><li><p>source $WORK_TOP/SOURCEME_image or $WORK_TOP/SOURCEME_image.tcsh</p></li></ol><p><strong><span data-colorid="bf9juwjw9u">You will not be allowed to push any updates to the Ncore container regression branch (Example of regression branch would be NCore_3.4/nightly_fsys_regression_32 described in Section B). This is because Ncore container regression branches are protected. We want the regression failures to reproducible at all times and prevent someone accidentally updating the branch. If you still, try to update it you will see error message like this:</span></strong></p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image image-center" src="https://arterisip.atlassian.net/wiki/download/attachments/45318437/image-20220825-023103.png?api=v2" /></span><p><strong>Section D: Steps to commit fix to hw-ncr Ncore3.4/develop branch:</strong></p><p>After verifying the fixes, when you are ready to push the files to Ncore3.4/develop branch, create a workspace by either using the old method (setup_concerto and source SOURCEME ncore3.4) or using the new Ncore container repo (steps mentioned in Section A). Note that the files you have fixed might have been updated in the latest Ncore3.4/develop branch so don&rsquo;t blindly copy the whole file. Use the latest Ncore3.4/develop branch version files and apply the fixes. After that you can push to the repo using push_ncr command.</p><p /><p />