<h2 id="OBSOLETE-DELETEHW-CTFhdr_translate-module_name">module_name</h2><p>hdr_translate</p><h2 id="OBSOLETE-DELETEHW-CTFhdr_translate-JavaScriptparameters">JavaScript parameters</h2><p><strong><em>depth</em></strong>: Depth of pipe in terms of number of ingress beats. Must be zero or a non-negative integral power of 2. For N &gt; 1, depth is internally set to N if depth &lt; N. ( See section 'Derived parameters' for definition of N ).</p><p><em><strong>pipeForward</strong></em>: A boolean. Setting to false indicates that a timing path exists between <em>inInterface</em><span> </span>and <em>outInterface</em>, hence zero latency between the two interfaces. Setting to true will add a cycle of latency between<span> </span><em>valid</em><span> </span>signals of <em>inInterface</em><span> </span>and <em>outInterface</em>, but helps ease timing.</p><p><em><strong>pipeBackWard</strong></em>: A boolean. Setting to false indicates that a timing path exists between<span> </span><em>ready</em><span> </span>signals of <em>inInterface</em><span> </span>and the <em>outInterface. </em>Setting to true will add a pipe in the path of <em>ready</em><span> </span>signals of the <em>inInterface</em><span> </span>and <em>outInterface</em>. <em>pipeForward</em><span> </span>= false is used inside the block to write into a FIFO when it is full, at the same clock when the FIFO is being read. Detecting this conditions creates a timing path between the two<span> </span><em>ready</em><span> </span>signals.</p><p><strong><em>inPktArray</em></strong>: (Required only if using old styled interfaces). Array of packet field description objects, generated by the getPacketArray() function for the inInterface.</p><p><strong><em>outPktArray</em></strong>: (Required only if using old styled interfaces). Array of packet field description objects, generated by the getPacketArray() function for the outInterface.</p><p><strong><em>protectionStyle</em></strong>: <a class="external-link" href="https://confluence.arteris.com/display/ENGR/protectionStyle" rel="nofollow" style="text-decoration: none;">protectionStyle</a></p><h2 id="OBSOLETE-DELETEHW-CTFhdr_translate-Derivedparameters">Derived parameters</h2><p><em><strong>numOutHdrBeats</strong></em>: A positive integer. Number of egress header beats in the packets. numOutHdrBeats is always equal to 1 for serial and parallel styled packets.</p><p><em><strong>N</strong></em>: A positive integer. N = Max ( Number of ingress header beats required to generate nth ingress header beat ), n = 1, 2, ... <em>numOutHdrBeats</em>. N is always equal to 1 for serial and parallel styled packets.</p><h2 id="OBSOLETE-DELETEHW-CTFhdr_translate-Interfaces">Interfaces</h2><p><em>clkInterface</em>: A slave interface of type <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfaceCLK" rel="nofollow" style="text-decoration: none;">InterfaceCLK</a>.</p><p><em>inInterface</em>: A slave interface of type <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfaceATP" rel="nofollow" style="text-decoration: none;">InterfaceATP</a> for the ingress ATP link. Packet style for this interface must be either &quot;fixed&quot; or &quot;serial&quot; only.</p><p><em>outInterface</em>: A master interface of type <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfaceATP" rel="nofollow" style="text-decoration: none;">InterfaceATP</a> for the egress ATP link. Packet style for this interface must be either &quot;fixed&quot; or &quot;serial&quot; only.</p><p><em>protInterface</em>: (Optional interface). A master interface of type <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfacePROT" rel="nofollow" style="text-decoration: none;">InterfacePROT</a>.</p><h2 id="OBSOLETE-DELETEHW-CTFhdr_translate-ModulesUsed">Modules Used</h2><p><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16157070/HW-CTF+aw_fifo" data-linked-resource-id="16157070" data-linked-resource-version="1" data-linked-resource-type="page">HW-CTF aw_fifo</a></p><p><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16156466/HW-CTF+sym_pipe_adapter" data-linked-resource-id="16156466" data-linked-resource-version="2" data-linked-resource-type="page">HW-CTF sym_pipe_adapter</a></p><h2 id="OBSOLETE-DELETEHW-CTFhdr_translate-Description">Description</h2><p>The hdr_translate block translates header beats on the ingress link to header beats on the egress link. In other words, it performs header-cycle adaption.</p><h3 id="OBSOLETE-DELETEHW-CTFhdr_translate-SerialandParallelpacketstyles">Serial and Parallel packet styles</h3><p>The solution is straightforward and simply involves wire or bit mapping of header fields on ingress and egress packets, and an optional pipe as shown in diagram 1.1.</p><h3 id="OBSOLETE-DELETEHW-CTFhdr_translate-Fixedpacketstyle">Fixed packet style</h3><p>The solution depends on which fields ( and bits ) of an egress header-beat depend on which fields, bits, and beats of the ingress packet. To compute, this we generate a data-structure, <em>windows</em> by analyzing fields and their positions in both the packets. The <em>windows</em> data-structure is an array with as many window objects as the number of header-beats in the egress packet. Below is the structure of this data-structure:</p><p><em>windows</em>  =  [<br/>     {  lower: earliest ingress beat required to generate egress beat 0, upper: last ingress beat required to generate egress beat 0 },<br/>     {  lower: earliest ingress beat required to generate egress beat 1, upper: last ingress beat required to generate egress beat 1 },<br/>              .<br/>              .<br/>              .<br/>     {  lower: earliest ingress beat required to generate the last egress beat, upper: last ingress beat required to generate the last egress beat }<br/>]<br/><br/>Each entry in <em>windows</em>, is called a window object or simply '<em>window'</em>. A <em>window</em> represents the window of ingress header beats that is required to generate an egress header beat. As the egress state advances, the window advances.</p><ol><li>The <em>lower</em> beat of a window tells that all previous ingress beats in the buffer (aw_fifo) can be discarded as they are no longer required to generate an egress header beat.</li><li>The <em>upper</em> beat of a window tells that an egress header beat can be generated as soon as this ( <em>upper</em> ) ingress beat is available. </li></ol><p>It is possible for N to be equal to 1 for <em>fixed</em> style packets also if any egress header beat can be generated by exactly one ingress header beat. This means the <em>hdr_translate</em> block doesn't wait till it accumulates all ingress header beats before sending out the first header beat. Instead it starts sending out an egress header beat as soon as the required ingress header beats are available. This can be determined via the signal, <em>dMin</em> of the aw_fifo, which tells us the number of ingress beats available in the buffer at each clock, and by keeping track of the state.</p><p>In addition, the <em>hdr_translate</em> clears out or discards ingress beats that are no longer required as the state advances. The aw_fifo allows us to pop out variable number of entries in the buffer via the <em>rd_n</em> signal. </p><p>The egress-state machine is simply a counter that counts the number of header beats sent on the egress link. The state is used to determine the current window of ingress beats that are necessary to generate the current egress header beat.</p><p><br/></p><p>Below are the block diagrams:</p><p><br/></p><p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image confluence-external-resource image-center" src="https://confluence.arteris.com/plugins/servlet/confluence/placeholder/unknown-attachment?locale=en_US&amp;version=2" data-image-src="https://confluence.arteris.com/plugins/servlet/confluence/placeholder/unknown-attachment?locale=en_US&amp;version=2" loading="lazy"></span></p><p style="text-align: center;">1.1 Block diagram for N = 1</p><p><br/></p><p><br/></p><p><span class="confluence-embedded-file-wrapper image-center-wrapper"><img class="confluence-embedded-image confluence-external-resource image-center" src="https://confluence.arteris.com/plugins/servlet/confluence/placeholder/unknown-attachment?locale=en_US&amp;version=2" data-image-src="https://confluence.arteris.com/plugins/servlet/confluence/placeholder/unknown-attachment?locale=en_US&amp;version=2" loading="lazy"></span></p><p style="text-align: center;">1.2 Block diagram for N &gt; 1</p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>