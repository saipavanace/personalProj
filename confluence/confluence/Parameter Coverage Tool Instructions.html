<h1 id="ParameterCoverageToolInstructions-HowtorunparametercoveragefromrunsimandgenerateHTMLreport?">How to run parameter coverage from runsim and generate HTML report ?</h1><h6 id="ParameterCoverageToolInstructions-STEP0"><u>STEP0</u></h6><p>For example, if you want to test the generation of param coverage report on a regression with 100 config of randomizer v3 base1:</p><pre>cd $WORK_TOP/tcl_gen.v3<br/>./randomizer.tcl 100 base1<br/>cd testcases/<br/>add_tcl_cfg nl JCP_GENV3_</pre><h6 id="ParameterCoverageToolInstructions-STEP1"><u>STEP 1</u></h6><p>Now, you can launch runsim and generates the report. <br/>You run with exe option 801 : GenJSON and Parameter Coverage. Those option are the minimal options to generate the Parameter Coverage report.</p><p> <span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="https://arterisip.atlassian.net/wiki/download/attachments/16171989/runsim_exe_list.png?api=v2"></span>                              </p><pre>runsim -e top_nl -c .*JCP_GENV3_.* -l default_nl -exe <span class="inline-comment-marker" data-ref="2d6f3d3d-a4e9-4fb4-ad6e-1c98f942efc6">801</span> -g</pre><h6 id="ParameterCoverageToolInstructions-STEP2"><u>STEP 2</u></h6><p>If all is ok, results of the regression are in $WORK_TOP/regression/2021_<em>MM_DD_HOUR</em>/debug/pc_reports/*.html.</p><p>You can see the result with your explorer, for example :</p><pre>konqueror $WORK_TOP/regression/2021_04_27_0952/debug/pc_reports/atui_apb.html<br/>                               </pre><p>If you have already generated JSON and RTL, you can launch the generation with the option -exe 800:</p><pre>runsim -e top_nl -c .*JCP_GENV3_.* -l default_nl -exe 800 -g</pre><h1 id="ParameterCoverageToolInstructions-WhereistheHTMLreportandhowtoview?">Where is the HTML report and how to view?</h1><p>In this example the HTML reports are stored in directory 'reports' . If you look, you will see a file per software visible block and interface for whom coverage is recorded:</p><pre>[kavish@gr6-3]$ ls $WORK_TOP/regression/2021_04_27_0952/debug/pc_reports<br/>atui_axi.html        atut_axi.html        InterfaceATP.html    InterfaceCLK.html    InterfacePROT.html   report_parmCvg.json  sym_buf_switch.html  sym_multicast.html   sym_switch.html</pre><p>Loading one of the files in a browser</p><pre>[kavish@gr6-3]$ firefox $WORK_TOP/regression/2021_04_27_0952/debug/pc_reports/sym_swicth.html</pre><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16171989/image2020-5-28%2018:15:43.png?api=v2"></span></p><p>Note: The report only records &quot;true&quot; covered as of now and does not display cross-coverage statistics.</p><h1 id="ParameterCoverageToolInstructions-WhattoseeintheHTMLreport?">What to see in the HTML report ?</h1><p><br/>For each block or interface to cover, there are one html report.<br/>In the report, there are 5 columns :</p><ul><li>Parameter : this is the name of the parameter. In CPR files, only some parameter coverage are activated, and we find them in this list.</li><li>CoverType (all Ranges) : this is the list of value that parameters should cover.</li><li>Covered : this is the list of value in the coverType which have been covered.</li><li>Coverage : this is the percentage of Covered parameter in the CoverType. If coverage is full (100%), the case is colored in green.</li><li>Unexpected : this is the value records as &quot;true&quot; covered but not in the CoverType. If unexpected value is not empty, the case is colored in orange.</li></ul><p>An example of report:</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16171989/example_report.png?api=v2"></span></p><p>Note: With the unexpected column, we can detect which range are not well define, or which random value are generated outside the authorized value.</p><p><br/></p><p>At the top of report, there are blocks or interfaces coverage counter. There are 4 kinds of counter :</p><ul><li>number of parameters to cover. This is the number of parameters with the coverage option enabled into CPR files.</li><li>number of parameters full covered. This is the number of parameters with the coverage option enabled into CPR files and with 100% of coverage.</li><li>number of cover points to cover. This is the sum of all cover points of all of parameters with the coverage option enabled.</li><li>number of cover points covered. This is the sum of all hits of all of parameters with the coverage option enabled.</li></ul><p> <span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16171989/coverage_counter.png?api=v2"></span></p><p>At the left of report, there are global coverage counter and resume of blocks/interfaces coverage counter :</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16171989/coverage_global.png?api=v2"></span></p><h1 id="ParameterCoverageToolInstructions-Howtorunregressionstepbystep&amp;Howitworks">How to run regression step by step &amp; How it works</h1><h3 id="ParameterCoverageToolInstructions-1.Createaregressionarea:">1. Create a regression area:</h3><p>mkdir regress<br/>cd regress<br/>/engr/dev/tools/script/setup_sym<br/>source SOURCEME</p><h3 id="ParameterCoverageToolInstructions-2.Createanareatoruncheckandruncheck:">2. Create an area to run check and run check:</h3><p>mkdir parm_cover<br/>cd parm_cover<br/>mkdir data_base</p><h3 id="ParameterCoverageToolInstructions-3.ExtractasetofJSONfilesfromabench:">3. Extract a set of JSON files from a bench:</h3><p>mkdir split_json<br/>$WORK_TOP/../../hw-lib/js/create_hierarchy.js -i $WORK_TOP/gen_cfg/maestro_1x8_enflame_3_unicast/tb.json -o `pwd`/split_json</p><h3 id="ParameterCoverageToolInstructions-4.RunthetooltogetcoverageonsplitJSONfiles:">4. Run the tool to get coverage on split JSON files:</h3><p>$WORK_TOP/../../hw-lib/js/updateParmCvg.js -w $WORK_TOP/../.. -d ./data_base -j ./split_json</p><p>....</p><p>TOTAL COVERAGE STATISTICS<br/>COVER POINTS: 70<br/>HIT COVER POINTS: 4<br/>HIT COVER PERCENTAGE: 0.05714285714285714<br/>TOTAL POINTS: 81<br/>HIT TOTAL POINTS: 15<br/>HIT TOTAL PERCENTAGE: 0.18518518518518517</p><h3 id="ParameterCoverageToolInstructions-5.RunthetooltogenerateHTMLreportsoncoveragedata_base:">5. Run the tool to generate HTML reports on coverage data_base:</h3><p>mkdir reports<br/>$WORK_TOP/../../hw-lib/js/reportParmCvg.js -d ./data_base -r ./reports</p><p>....<br/>Open any HTML file inside `pwd`/reports folder in a browser. The HTML report file have the ability to navigate between each design/Interface file</p><h3 id="ParameterCoverageToolInstructions-6.ExtractanothersetofJSONfilesfromabenchandaddittothedatabase:">6. Extract another set of JSON files from a bench and add it to the database:</h3><p>mkdir split_json2<br/>$WORK_TOP/../../hw-lib/js/create_hierarchy.js -i $WORK_TOP/gen_cfg/maestro_seagate_parallel_12_10/tb.json -o `pwd`/split_json2<br/>$WORK_TOP/../../hw-lib/js/updateParmCvg.js -w $WORK_TOP/../.. -d ./data_base -j ./split_json2</p><p>....</p><p>TOTAL COVERAGE STATISTICS<br/>COVER POINTS: 70<br/>HIT COVER POINTS: 16<br/>HIT COVER PERCENTAGE: 0.22857142857142856<br/>TOTAL POINTS: 110<br/>HIT TOTAL POINTS: 56<br/>HIT TOTAL PERCENTAGE: 0.509090909090909</p><h3 id="ParameterCoverageToolInstructions-7.Whereisthedatabaseandwhatisit?">7. Where is the database and what is it?</h3><p>In this example the database is stored in directory data_base. If you look, you will see a file per software visible block and interface:</p><pre>[jcodd@mondavi parm_cover]$ ls data_base<br/>atui_axi_db.json InterfaceAPB_db.json InterfaceCLK_db.json InterfacePMAControl_db.json sym_buf_switch_db.json sym_switch_db.json<br/>atut_axi_db.json InterfaceATP_db.json InterfaceGeneric_db.json InterfacePROT_db.json sym_multicast_db.json<br/>dw_adapter_db.json InterfaceAXI_db.json InterfaceINT_db.json sym_async_adapter_db.json sym_pipe_adapter_db.json</pre><p>Looking at the structure on one of the files we have:</p><pre>[jcodd@mondavi data_base]$ cat InterfaceCLK_db.json <br/>{&quot;version&quot;:&quot;0.0&quot;,<br/> &quot;InterfaceCLK&quot;:<br/>  {&quot;name&quot;:{},<br/>   &quot;params&quot;:{&quot;reference&quot;:&quot;InterfaceParams&quot;},<br/>   &quot;interface&quot;:{},<br/>   &quot;direction&quot;:{},<br/>   &quot;blkClkGateOn&quot;:{}},<br/> &quot;InterfaceParams&quot;:<br/>  {&quot;wTestEn&quot;:{},<br/>   &quot;wClkEn&quot;:{},<br/>   &quot;wEdgeEn&quot;:{},<br/>   &quot;wPreEdgeEn&quot;:{},<br/>   &quot;wRetRst&quot;:{}}}</pre><p>The structure is a hashed list of db[param_group][param]. In the list above there are two param_groups: InterfaceCLK and InterfaceParams. In the above example, none of the parameters are being covered. Below is an example of of a paramater that is being covered by the tool:</p><pre>&quot;numPri&quot;: {<br/>   &quot;pc_db&quot;: {<br/>     &quot;value&quot;: {<br/>       &quot;1&quot;: {&quot;cnt&quot;: 228,&quot;cover&quot;: true},<br/>       &quot;2&quot;: {&quot;cnt&quot;: 0,&quot;cover&quot;: true},<br/>       &quot;3&quot;: {&quot;cnt&quot;: 0,&quot;cover&quot;: true}},<br/>     &quot;index&quot;: null,<br/>     &quot;crossValue&quot;: null,<br/>     &quot;crossIndex&quot;: null},<br/>   &quot;parameterCoverage&quot;: {&quot;coverRange&quot;:[&quot;1 to 3&quot;]}}</pre><p>The parameter parameterCoverage is copied from the CPR and its format is describe here: <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171938/Extensions+to+CPR+for+Parameter+Coverage" data-linked-resource-id="16171938" data-linked-resource-version="16" data-linked-resource-type="page">Extensions to CPR for Parameter Coverage</a>.</p><p>The parameter pc_db stores the results of the coverage and can be added to incrementally by rerunning the tool on different split JSON files and pointing at the same database directory.</p><p><br/></p>