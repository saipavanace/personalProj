<h1 id="ArbitersTestPlan-History">History</h1><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"> </th><th class="confluenceTh">Date</th><th class="confluenceTh">Owner</th><th class="confluenceTh">Comment</th></tr><tr><td class="confluenceTd">0.1</td><td class="confluenceTd">11-Jan-2018</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd">Initial version</td></tr><tr><td class="confluenceTd">0.2</td><td class="confluenceTd">17-Jan-2018</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd">incorporate edits from Saad</td></tr><tr><td class="confluenceTd">1.0</td><td class="confluenceTd">19-Jan-2018</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd"><p>incorporate notes from review</p></td></tr><tr><td colspan="1" class="confluenceTd">1.1</td><td colspan="1" class="confluenceTd">06-Sep-2019</td><td colspan="1" class="confluenceTd">Andrew Brock</td><td colspan="1" class="confluenceTd">incorporate notes from review</td></tr></tbody></table></div><p style="text-align: left;"> </p><h1 id="ArbitersTestPlan-ReviewHistory">Review History</h1><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"> </th><th class="confluenceTh">Date</th><th class="confluenceTh">Presenter</th><th class="confluenceTh">Attendees</th></tr><tr><td class="confluenceTd">0.2</td><td class="confluenceTd">19-Jan-2018</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd">Design, Verification, Architecture</td></tr><tr><td class="confluenceTd">1.0</td><td class="confluenceTd">30-Aug-2019</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a>, <a class="confluence-userlink user-mention" data-account-id="5ed63c82037d930c16bd8c73" href="https://arterisip.atlassian.net/wiki/people/5ed63c82037d930c16bd8c73?ref=confluence" target="_blank" data-linked-resource-id="327834" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Saad Zahid</a>, <a class="confluence-userlink user-mention" data-account-id="624b37fc258562006fa692fa" href="https://arterisip.atlassian.net/wiki/people/624b37fc258562006fa692fa?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">John Coddington (Deactivated)</a>, <a class="confluence-userlink user-mention" data-account-id="624b37e8699649006ae9901f" href="https://arterisip.atlassian.net/wiki/people/624b37e8699649006ae9901f?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Eric Taylor (Deactivated)</a>, <a class="confluence-userlink user-mention" data-account-id="624b38261da0e100713c9b4b" href="https://arterisip.atlassian.net/wiki/people/624b38261da0e100713c9b4b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Bill Chandler (Deactivated)</a>, <a class="confluence-userlink user-mention" data-account-id="624b374cad6b7e006aa7d803" href="https://arterisip.atlassian.net/wiki/people/624b374cad6b7e006aa7d803?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Aniq Shahid (Deactivated)</a>, <a class="confluence-userlink user-mention" data-account-id="624b373df6a26900695fd0fc" href="https://arterisip.atlassian.net/wiki/people/624b373df6a26900695fd0fc?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Syed Shah (Deactivated)</a></td></tr><tr><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td></tr></tbody></table></div><p> </p><p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1759724118728 {padding: 0px;}
div.rbtoc1759724118728 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1759724118728 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1759724118728'>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1</span> <a href='#ArbitersTestPlan-History'>History</a></li>
<li><span class='TOCOutline'>2</span> <a href='#ArbitersTestPlan-ReviewHistory'>Review History</a></li>
<li><span class='TOCOutline'>3</span> <a href='#ArbitersTestPlan-Introduction'>Introduction</a></li>
<li><span class='TOCOutline'>4</span> <a href='#ArbitersTestPlan-TestbenchDescription'>Testbench Description</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.1</span> <a href='#ArbitersTestPlan-ACL2Formal'>ACL2 Formal</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.1.1</span> <a href='#ArbitersTestPlan-GeneralStructure'>General Structure</a></li>
<li><span class='TOCOutline'>4.1.2</span> <a href='#ArbitersTestPlan-arb_rr1'>arb_rr1</a></li>
<li><span class='TOCOutline'>4.1.3</span> <a href='#ArbitersTestPlan-arb_rr2'>arb_rr2</a></li>
<li><span class='TOCOutline'>4.1.4</span> <a href='#ArbitersTestPlan-arb_pri_rr1'>arb_pri_rr1</a></li>
<li><span class='TOCOutline'>4.1.5</span> <a href='#ArbitersTestPlan-arb_pri_rr2'>arb_pri_rr2</a></li>
<li><span class='TOCOutline'>4.1.6</span> <a href='#ArbitersTestPlan-arb_wrr_rr1'>arb_wrr_rr1</a></li>
<li><span class='TOCOutline'>4.1.7</span> <a href='#ArbitersTestPlan-arb_wrr_rr2'>arb_wrr_rr2</a></li>
<li><span class='TOCOutline'>4.1.8</span> <a href='#ArbitersTestPlan-arb_spri'>arb_spri</a></li>
<li><span class='TOCOutline'>4.1.9</span> <a href='#ArbitersTestPlan-arb_fifo'>arb_fifo</a></li>
<li><span class='TOCOutline'>4.1.10</span> <a href='#ArbitersTestPlan-sym_sw_arb'>sym_sw_arb</a></li>
</ul>
</li>
<li><span class='TOCOutline'>4.2</span> <a href='#ArbitersTestPlan-RuntimeAssertions'>Runtime Assertions</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.2.1</span> <a href='#ArbitersTestPlan-EnvironmentalAssertions'>Environmental Assertions</a></li>
<li><span class='TOCOutline'>4.2.2</span> <a href='#ArbitersTestPlan-arb_rr1.1'>arb_rr1</a></li>
<li><span class='TOCOutline'>4.2.3</span> <a href='#ArbitersTestPlan-arb_rr2.1'>arb_rr2</a></li>
<li><span class='TOCOutline'>4.2.4</span> <a href='#ArbitersTestPlan-arb_pri_rr1.1'>arb_pri_rr1</a></li>
<li><span class='TOCOutline'>4.2.5</span> <a href='#ArbitersTestPlan-arb_pri_rr2.1'>arb_pri_rr2</a></li>
<li><span class='TOCOutline'>4.2.6</span> <a href='#ArbitersTestPlan-arb_wrr_rr1.1'>arb_wrr_rr1</a></li>
<li><span class='TOCOutline'>4.2.7</span> <a href='#ArbitersTestPlan-arb_wrr_rr2.1'>arb_wrr_rr2</a></li>
<li><span class='TOCOutline'>4.2.8</span> <a href='#ArbitersTestPlan-sym_sw_arb.1'>sym_sw_arb</a></li>
</ul>
</li>
</ul>
</li>
<li><span class='TOCOutline'>5</span> <a href='#ArbitersTestPlan-ConfigurationSpace'>Configuration Space</a></li>
</ul>
</div></p><h1 id="ArbitersTestPlan-Introduction">Introduction</h1><h1 id="ArbitersTestPlan-TestbenchDescription">Testbench Description</h1><h2 id="ArbitersTestPlan-ACL2Formal">ACL2 Formal</h2><h3 id="ArbitersTestPlan-GeneralStructure">General Structure</h3><pre>  (implies (and (unsigned-byte-p state-width st)
              (one-hot-p st)
              (unsigned-byte-p in-width in)
              (&gt; in 0)
              (bitp next)
              (= next 1))
         (and (equal (cdr (assoc-equal 'out (run-rtl)))
                     (highest-of in st))
              (equal (cdr (assoc-equal 'st (run-rtl)))
                     (next-state in st))))
(implies (and (unsigned-byte-p state-width st)
              (one-hot-p st)
              (unsigned-byte-p in-width in)
              (bitp next)
              (= next 0))
         (and (equal (cdr (assoc-equal 'out (run-rtl))) 0)
              (equal (cdr (assoc-equal 'st (run-rtl))) st)))
(implies (and (one-hot-p st)
              (unsigned-byte-p state-width st)
              (unsigned-byte-p in-width in)
              (bitp next))
         (one-hot-p st))
</pre><p>highest-of and next-state are implementation-dependent and will vary among the different arbiters. This architecture is sufficiently general to handle the priority versions of the arbiters, with their considerably wider effective inputs and states, as output width is not tied to input or state width anywhere in here.</p><p>The MSB of the arbiter state is inverted to simplify reset logic: this must be accounted for.</p><h3 id="ArbitersTestPlan-arb_rr1">arb_rr1</h3><pre>  (equal (next-state in st)
       (highest-of in st))
</pre><h3 id="ArbitersTestPlan-arb_rr2">arb_rr2</h3><pre>  (equal (next-state in st)
       (logical-rotate-left in st))
</pre><h3 id="ArbitersTestPlan-arb_pri_rr1">arb_pri_rr1</h3><p>arb_pri_rr1 splits the input matrix into priorities and handles each by first calling arb_rr1 highest-of, then priority encoding.</p><h3 id="ArbitersTestPlan-arb_pri_rr2">arb_pri_rr2</h3><p>arb_pri_rr2 splits the input matrix into priorities and handles each by first calling arb_rr2 highest-of, then priority encoding.</p><h3 id="ArbitersTestPlan-arb_wrr_rr1">arb_wrr_rr1</h3><p>arb_wrr_rr1 maintains a counter for each priority, plus more state for the final rr1 arbiter</p><h3 id="ArbitersTestPlan-arb_wrr_rr2">arb_wrr_rr2</h3><p>arb_wrr_rr1 maintains a counter for each priority, plus more state for the final rr2 arbiter.</p><h3 id="ArbitersTestPlan-arb_spri">arb_spri</h3><p>This is a simple priority arbiter. It is used as a component in the WRR and PRI arbiters, so it does not require its own testbench.</p><h3 id="ArbitersTestPlan-arb_fifo">arb_fifo</h3><p>This arbiter maintains a history of received requests. Boon has verified it using whitebox SVA techniques.</p><h3 id="ArbitersTestPlan-sym_sw_arb">sym_sw_arb</h3><p>The two-stage switch arbiter has been verified using end-to-end black- and whitebox SVA assertions to guarantee one-hot-ness, forward progress, and VC locking, but not end-to-end locking.</p><h2 id="ArbitersTestPlan-RuntimeAssertions">Runtime Assertions</h2><h3 id="ArbitersTestPlan-EnvironmentalAssertions">Environmental Assertions</h3><p>We will validate that if next=1, req!=0. Note that the converse is not true: the arbiter can be locked with pending requests.</p><h3 id="ArbitersTestPlan-arb_rr1.1">arb_rr1</h3><ol><li><p>We will test the reset state of the arbiter, as that is not covered by the ACL2 proof.</p></li><li><p>We will test that the state is one-hot.</p></li><li><p>We will test that the granted output is correct (including onehot and zero assertions, depending on request state).</p></li><li><p>We will test that the next state is correct.</p></li></ol><h3 id="ArbitersTestPlan-arb_rr2.1">arb_rr2</h3><ol><li><p>We will test the reset state of the arbiter, as that is not covered by the ACL2 proof.</p></li><li><p>We will test that the state is one-hot.</p></li><li><p>We will test that the granted output is correct (including onehot and zero assertions, depending on request state).</p></li><li><p>We will test that the next state is correct.</p></li></ol><h3 id="ArbitersTestPlan-arb_pri_rr1.1">arb_pri_rr1</h3><ol><li>We will test the reset state of the arbiter, as that is not covered by the ACL2 proof.</li><li>We will test that each within-priority arbiter is rr1 (including onehot and zero assertions, depending on request state).</li><li>We will test that the priority encoder priority-encodes (including onehot and zero assertions).</li></ol><h3 id="ArbitersTestPlan-arb_pri_rr2.1">arb_pri_rr2</h3><ol><li>We will test the reset state of the arbiter, as that is not covered by the ACL2 proof.</li><li>We will test that each within-priority arbiter is rr2 (including onehot and zero assertions, depending on request state).</li><li>We will test that the priority encoder priority-encodes (including onehot and zero assertions).</li></ol><h3 id="ArbitersTestPlan-arb_wrr_rr1.1">arb_wrr_rr1</h3><ol><li>We will test the reset state of the arbiter, as that is not covered by the ACL2 proof.</li><li>We will test that inputs that have run out of tokens are not selected.</li><li>We will test that inputs that are selected lose a token.</li><li>We will test that final arbitration is rr1 (including onehot and zero assertions, depending on request state).</li></ol><h3 id="ArbitersTestPlan-arb_wrr_rr2.1">arb_wrr_rr2</h3><ol><li>We will test the reset state of the arbiter, as that is not covered by the ACL2 proof.</li><li>We will test that inputs that have run out of tokens are not selected.</li><li>We will test that inputs that are selected lose a token.</li><li>We will test that final arbitration is rr2 (including onehot and zero assertions, depending on request state).</li></ol><h3 id="ArbitersTestPlan-sym_sw_arb.1">sym_sw_arb</h3><p>Need something covering the &quot;lock logic&quot; (about which more details are needed) and the other loose logic in the per-VC ARB described in <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16167479/OBSOLETE-DELETE+HW-SYM+sym_sw_arb" data-linked-resource-id="16167479" data-linked-resource-version="50" data-linked-resource-type="page">OBSOLETE-DELETE HW-SYM sym_sw_arb</a>.</p><h1 id="ArbitersTestPlan-ConfigurationSpace">Configuration Space</h1><p>All testbenches will require all configuration details pertaining to the module they test.</p>