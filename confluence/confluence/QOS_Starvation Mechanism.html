<h2 id="QOS/StarvationMechanism-Overview">Overview</h2><p>The QoS ensures preferential treatment to requests marked as higher priority over other lower priority requests.The OTT starvation resolution mechanism can be configured with parameters and the behavior can be controlled through a CSR. Starvation avoidance has two phases: Starvation Detection and Starvation Handling</p><p><strong>Reference Document/Links:</strong></p><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><h2 id="QOS/StarvationMechanism-StimulusDescriptions">Stimulus Descriptions </h2><div class="table-wrap"><table data-table-width="1800" data-layout="center" data-local-id="c13f4cd0-1513-4908-a9f7-4689a677e49a" class="confluenceTable"><colgroup><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/><col style="width: 180.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Name of Field</strong></p></th><th class="confluenceTh"><p><strong>Description</strong></p></th><th class="confluenceTh"><p><strong>Constraint</strong></p></th><th class="confluenceTh"><p><strong>Ref Doc </strong></p></th><th class="confluenceTh"><p><strong>Hash tag</strong></p></th><th class="confluenceTh"><p><strong>Tb Location</strong></p></th><th class="confluenceTh"><p><strong>Priority </strong></p></th><th class="confluenceTh"><p><strong>Implemented </strong></p></th><th class="confluenceTh"><p><strong>Status</strong></p></th><th class="confluenceTh"><p><strong>Remarks</strong></p></th></tr><tr><td class="confluenceTd"><p>XAIUQOSCR.EventThreshold</p></td><td class="confluenceTd"><p>&quot;Event threshold value counts every event (command issues) if value is 0 event count is disabled (event starvation disabled).</p></td><td class="confluenceTd"><p>Randomize using following distribution</p><p>0:=2</p><p>[1:3]:=98</p></td><td class="confluenceTd"><p>cpr/csr/miscCSR.json</p><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a>  </p><p>8.5.8 OTT starvation resolution mechanism</p></td><td class="confluenceTd"><p>#Stimulus.IOAIU.Starvation</p></td><td class="confluenceTd"><p>ioaiu_csr_seq_lib.svh</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>arqos/awqos</p></td><td class="confluenceTd"><p>QOS value driven on the nativeInterface</p></td><td class="confluenceTd"><p>Randomize using following distribution</p><p>[0:5] := 5</p><p>[6:15] := 95</p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p></td><td class="confluenceTd"><p>#Stimulus.IOAIU.Qos</p></td><td class="confluenceTd"><p>axi_txn.svh</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><h2 id="QOS/StarvationMechanism-Functionalcheckandcoverage">Functional check and coverage </h2><div class="table-wrap"><table data-table-width="1800" data-layout="full-width" data-local-id="9f82efb4-d1d8-4333-8f50-c0e3f9f100b6" class="confluenceTable"><colgroup><col style="width: 85.0px;"/><col style="width: 85.0px;"/><col style="width: 85.0px;"/><col style="width: 85.0px;"/><col style="width: 85.0px;"/><col style="width: 85.0px;"/><col style="width: 85.0px;"/><col style="width: 85.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p>Scenario</p></th><th class="confluenceTh"><p>Ref Doc</p></th><th class="confluenceTh"><p>Hash Tag</p></th><th class="confluenceTh"><p>Tb Location</p></th><th class="confluenceTh"><p>Priority </p></th><th class="confluenceTh"><p>Implemented </p></th><th class="confluenceTh"><p>Status</p></th><th class="confluenceTh"><p>Remarks</p></th></tr><tr><td class="confluenceTd"><p>Check that QOSSR.EventStatus is asserted at least once in the testcase.</p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p></td><td class="confluenceTd"><p>#Check.IOAIU.Starvation.EventStatus</p><p /></td><td class="confluenceTd"><p>ioaiu_csr_seq_lib.svh</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>Check that QOSSR.EventStatus is never asserted when QOSCR.EventThreshold=0 or fnQosEnable=0</p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p><p>cpr/csr/miscCSR.json</p></td><td class="confluenceTd"><p>#Check.IOAIU.NoStarvation_ThresholdZero</p></td><td class="confluenceTd"><p>ioaiu_csr_seq_lib.sv</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>Check that QOSSR.EventStatusCount correctly reflects the number of times design went into starvation </p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p><p>cpr/csr/miscCSR.json</p></td><td class="confluenceTd"><p>#Check.IOAIU.Starvation.EventStatusCount</p></td><td class="confluenceTd"><p>ioaiu_csr_seq_lib.sv</p></td><td class="confluenceTd"><p>High </p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>Check that QOSSR.EventStatusCountOverflow is asserted when QOSSR.EventStatusCount reads max-value i.e 2^16 - 1, and design enters starvation mode one more time. </p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p><p>cpr/csr/miscCSR.json</p></td><td class="confluenceTd"><p>n/a</p></td><td class="confluenceTd"><p>n/a</p></td><td class="confluenceTd"><p>Low</p></td><td class="confluenceTd"><p>Not Started</p></td><td class="confluenceTd"><p>Cancelled</p></td><td class="confluenceTd"><p>This is going to be extremely hard to hit, since we would need to model a testcase that would cause design to enter starvation 65,535 times.</p></td></tr><tr><td class="confluenceTd"><p>Cover that every core enters starvation at least once.</p><p>cover QOSSR.EventStatus. Sample this for every core.</p><p /><p /></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p><p>cpr/csr/miscCSR.json</p></td><td class="confluenceTd"><p>#Cover.IOAIU.Starvation.EachCore_EventStatus</p></td><td class="confluenceTd"><p>ioaiu_coverage.svh</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>Cover QOSSR.EventStatusCount for every core. </p><p>we can have bin groups:</p><p>bins_1_5 = {[1:5]}</p><p>bins_6_10 = {[6:10]}</p><p>bins_11_15 = {[11:15]}</p><p>bins_16_20 = {[16:20]}</p><p /></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p><p>cpr/csr/miscCSR.json</p></td><td class="confluenceTd"><p>#Cover.IOAIU.Starvation.EachCore_EventStatusCount</p></td><td class="confluenceTd"><p>ioaiu_coverage.svh</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><h2 id="QOS/StarvationMechanism-Directed/RandomTestcase">Directed/Random Testcase</h2><div class="table-wrap"><table data-table-width="1800" data-layout="center" data-local-id="1bd84bfe-8ad6-4ec4-96a1-fc8f613b3c07" class="confluenceTable"><colgroup><col style="width: 152.0px;"/><col style="width: 109.0px;"/><col style="width: 165.0px;"/><col style="width: 146.0px;"/><col style="width: 88.0px;"/><col style="width: 127.0px;"/><col style="width: 90.0px;"/><col style="width: 923.0px;"/></colgroup><tbody><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>testcase Name </p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p> Scenario </p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>Ref Doc</p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>Hash Tag</p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>Priority</p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>Implemented </p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>Status </p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p>Remarks </p></th></tr><tr><td class="confluenceTd"><p>starvation_stress_test_unq_addr</p></td><td class="confluenceTd"><p>testcase create scenario to enter starvation mode with all unique addresses</p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p></td><td class="confluenceTd"><p>#Test.IOAIU.Starvation.UnqAddr</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p> </p></td></tr><tr><td class="confluenceTd"><p>starvation_stress_test_nonunq_addr</p></td><td class="confluenceTd"><p>testcase create scenario to enter starvation mode random probability of unq-nonunq addresses</p></td><td class="confluenceTd"><p><a data-card-appearance="inline" href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification" rel="nofollow">https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/208666703/Ncore+3.6+IO-AIU+Micro-Architecture+Specification</a> </p><p>8.5.7 Qos</p><p>8.5.8     OTT starvation resolution mechanism</p></td><td class="confluenceTd"><p>#Test.IOAIU.Starvation.NonUnqAddr</p></td><td class="confluenceTd"><p>High</p></td><td class="confluenceTd"><p>Done</p></td><td class="confluenceTd"><p>Pass</p></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><h2 id="QOS/StarvationMechanism-Configs">Configs</h2><div class="table-wrap"><table data-table-width="1800" data-layout="center" data-local-id="c73d53da-2548-4a38-aa2c-710dfc646e25" class="confluenceTable"><colgroup><col style="width: 123.0px;"/><col style="width: 335.0px;"/><col style="width: 1342.0px;"/></colgroup><tbody><tr><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Sr No</strong></p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Configs</strong></p></th><th data-highlight-colour="#f0f0f0" class="confluenceTh"><p><strong>Remarks</strong></p></th></tr><tr><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><p>ioc</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>2</p></td><td class="confluenceTd"><p>ioc_4c</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>3</p></td><td class="confluenceTd"><p>ace</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>4</p></td><td class="confluenceTd"><p>ace_lite</p></td><td class="confluenceTd"><p /></td></tr><tr><td class="confluenceTd"><p>5</p></td><td class="confluenceTd"><p>ace_lite_e</p></td><td class="confluenceTd"><p /></td></tr></tbody></table></div><h2 id="QOS/StarvationMechanism-OTTThreshold1/6,1/3&amp;1/2oftotalOTT:">OTT Threshold 1/6, 1/3 &amp; 1/2 of total OTT:</h2><p> Implementing a threshold in the NCAIU OTT to reserve OTT positions for write transactions.</p><p>The problem is the following :</p><ul><li><p>Read transactions have a tendency to fill the OTT a lot faster than write transactions, because they are allocated faster than write transactions</p></li><li><p>This leads to write transactions using only the one or two spots reserved to make sure write transactions make forward progress always</p></li><li><p>Ultimately, write traffic is penalized (bandwidth) compared to read traffic</p></li></ul><p>One solution would be to have a threshold in the OTT to reserved positions for the write transactions.</p><p>DV updated the stimulus and checks done in <a class="external-link" href="http://gitlab.arteris.com/hardware/hw-ncr/-/commit/ab8fcc7fab9c3cb62a0952fb9649df5b62db70ae" rel="nofollow">http://gitlab.arteris.com/hardware/hw-ncr/-/commit/ab8fcc7fab9c3cb62a0952fb9649df5b62db70ae</a></p><p>Jira references : 

    

            



<style>
    .jira-issue {
        padding: 0 0 0 2px;
        line-height: 20px;
    }

    .jira-issue img {
        padding-right: 5px;
    }
    .jira-issue .aui-lozenge {
        line-height: 18px;
        vertical-align: top;
    }

    .jira-issue .icon {
        background-position: left center;
        background-repeat: no-repeat;
        display: inline-block;
        font-size: 0;
        max-height: 16px;
        text-align: left;
        text-indent: -9999em;
        vertical-align: text-bottom;
    }
</style>

    <span class="confluence-jim-macro jira-issue" data-jira-key="CONC-14896" >
                <a href="https://arterisip.atlassian.net/browse/CONC-14896?src=confmacro" class="jira-issue-key">CONC-14896</a>
                            </span>
  

    

            



<style>
    .jira-issue {
        padding: 0 0 0 2px;
        line-height: 20px;
    }

    .jira-issue img {
        padding-right: 5px;
    }
    .jira-issue .aui-lozenge {
        line-height: 18px;
        vertical-align: top;
    }

    .jira-issue .icon {
        background-position: left center;
        background-repeat: no-repeat;
        display: inline-block;
        font-size: 0;
        max-height: 16px;
        text-align: left;
        text-indent: -9999em;
        vertical-align: text-bottom;
    }
</style>

    <span class="confluence-jim-macro jira-issue" data-jira-key="CONC-15222" >
                <a href="https://arterisip.atlassian.net/browse/CONC-15222?src=confmacro" class="jira-issue-key">CONC-15222</a>
                            </span>
  </p><p />