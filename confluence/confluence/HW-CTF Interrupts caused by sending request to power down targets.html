<p>In Symphony, power domain crossings only happened on ATP interfaces. It is assumed that the ATUs, both Initiators and Targets, are tied to customer logic the powers up and down with them so the native protocol interfaces connected to them will not be crossing between power domains. The ATP interfaces are the red and blue arrows shown in the drawing below.</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16156935/PowerConfig_2.svg?api=v2"></span></p><p>Symphony has a bidirectional power adapter (called a clk_pwr_adapter) that is used to span power domains.  The rule is all requests that cross the adapter must have their responses cross back in the opposite direction. The drawing below shows the generic architecture of a bidirectional adapter.</p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16156935/BiDiAdapter.svg?api=v2"></span></p><p>The microarchitecture of the bidirectional power adapter is at: <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16157133/OBSOLETE-DELETE+HW-CTF+clk_pwr_adapter" data-linked-resource-id="16157133" data-linked-resource-version="2" data-linked-resource-type="page">OBSOLETE-DELETE HW-CTF clk_pwr_adapter</a></p><p>When the out side of the clk_pwr_adapter is powered down, any responses coming in will be turned around with an autogenerated error response telling the requester that request has gone to a powered down target. The ATUI that sent the request will then respond with an error on the native interface, and the optionally generate an interrupt (determined at configuration time). In the above first drawing, PD0 and PD1 represent power domains and the blue network represents the request network, and the red network represents the response network. The red and blue wires represent two ATP interfaces that would have a clk_pwr_adapter inserted on if PD1 could be powered down.</p><h1 id="HW-CTFInterruptscausedbysendingrequesttopowerdowntargets-SymphonyR1">Symphony R1</h1><p>For Symphony R1, it was determined that software could not properly place bidirectional adapters in the time provided by the schedule. Because of this a fall back plan was devised. In Symphony all ATP interfaces that cross between power domains are by definition asynchronous to each other. Because of this, unidirectional adapters called async_adapters would need to be placed on ATP interfaces crossing between power domains.  When the domain is powered down, the async adapters would send signals to the other side that indicate they are turned off. When this happens, the onside resets its state and if it's on the receiving side drives its ready signal high, and if it is on the sending side, drives it's valid signal low.</p><p>In this case, if a request packet attempts to cross to a powered down domain, the packet will be accepted, but go nowhere. When this happens, there is a timer function in ATUIs that will time out. When this occurs the ATUI will generate a slave error to the native interface for the request that caused the timeout and optionally generate an interrupt (determined at configuration time). This timeout mechanism is the same for other timeout mechanisms and the ATUI will not be able to determine what caused the timeout. When a timeout occurs, the sequence number for the packet that timed out is retired and not used for future transactions. Because of this, it is considered that timeouts can only occur to aid in debug or to signal the machine the Symphony block is in that something has gone wrong and the system needs to be restarted.</p>