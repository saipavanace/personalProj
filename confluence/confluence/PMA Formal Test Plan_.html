<h1 id="PMAFormalTestPlan:-History">History</h1><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"> </th><th class="confluenceTh">Date</th><th class="confluenceTh">Owner</th><th class="confluenceTh">Comment</th></tr><tr><td class="confluenceTd">0.1</td><td class="confluenceTd">19-Sep-2018</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd">Initial version</td></tr><tr><td class="confluenceTd">0.2</td><td class="confluenceTd"> </td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd">1.0</td><td class="confluenceTd"> </td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd"> </td></tr></tbody></table></div><p style="text-align: left;"> </p><h1 id="PMAFormalTestPlan:-ReviewHistory">Review History</h1><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh"> </th><th class="confluenceTh">Date</th><th class="confluenceTh">Presenter</th><th class="confluenceTh">Attendees</th></tr><tr><td class="confluenceTd">0.1</td><td class="confluenceTd">21-Sep-2018</td><td class="confluenceTd">Andrew Brock</td><td class="confluenceTd">Design, Verification, Architecture</td></tr><tr><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td></tr><tr><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td><td class="confluenceTd"> </td></tr></tbody></table></div><p> </p><p><style type='text/css'>/*<![CDATA[*/
div.rbtoc1759723786241 {padding: 0px;}
div.rbtoc1759723786241 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1759723786241 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1759723786241'>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>1</span> <a href='#PMAFormalTestPlan:-History'>History</a></li>
<li><span class='TOCOutline'>2</span> <a href='#PMAFormalTestPlan:-ReviewHistory'>Review History</a></li>
<li><span class='TOCOutline'>3</span> <a href='#PMAFormalTestPlan:-Introduction'>Introduction</a></li>
<li><span class='TOCOutline'>4</span> <a href='#PMAFormalTestPlan:-TestbenchDescription'>Testbench Description</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.1</span> <a href='#PMAFormalTestPlan:-Master'>Master</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.1.1</span> <a href='#PMAFormalTestPlan:-(P,P)'>(P,P)</a></li>
<li><span class='TOCOutline'>4.1.2</span> <a href='#PMAFormalTestPlan:-(P,Q)'>(P,Q)</a></li>
<li><span class='TOCOutline'>4.1.3</span> <a href='#PMAFormalTestPlan:-(Q,Q)'>(Q,Q)</a></li>
</ul>
</li>
<li><span class='TOCOutline'>4.2</span> <a href='#PMAFormalTestPlan:-Slave'>Slave</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.2.1</span> <a href='#PMAFormalTestPlan:-Q-Channel'>Q-Channel</a></li>
<li><span class='TOCOutline'>4.2.2</span> <a href='#PMAFormalTestPlan:-P-Channel'>P-Channel</a></li>
</ul>
</li>
<li><span class='TOCOutline'>4.3</span> <a href='#PMAFormalTestPlan:-SystemInvariants'>System Invariants</a>
<ul class='toc-indentation'>
<li><span class='TOCOutline'>4.3.1</span> <a href='#PMAFormalTestPlan:-Q-Channel.1'>Q-Channel</a></li>
<li><span class='TOCOutline'>4.3.2</span> <a href='#PMAFormalTestPlan:-P-Channel.1'>P-Channel</a></li>
</ul>
</li>
</ul>
</li>
<li><span class='TOCOutline'>5</span> <a href='#PMAFormalTestPlan:-ConfigurationSpace'>Configuration Space</a></li>
</ul>
</div></p><h1 id="PMAFormalTestPlan:-Introduction">Introduction</h1><h1 id="PMAFormalTestPlan:-TestbenchDescription">Testbench Description</h1><h2 id="PMAFormalTestPlan:-Master">Master</h2><p>The PMA master supports Q-mode operation with Q-mode slaves and P-mode operation with either P- or Q-mode slaves. We specify the necessary configurations here as the pair (masterChannel, slaveChannel), to match the spec. Verification will be by ACL2 model, equivalence proof, and proof of additional theorems based on the model.</p><p>We expect to turn off all synchronizers to simplify the formal proof. In particular, this allows us to assume that signals that would have to cross a synchronizer are instantly available. For example, the proofs in (Q,Q) that various slave-side output signals are simply clones of master-side input signals are not strictly true in a configuration with synchronizers, but they will be true in a synchronizer-free configuration. This will require care to ensure that turning them back on wouldn't invalidate the intent of the proofs.</p><p>Equivalence proofs will be done block-by-block, based on all block inputs and outputs, but the additional theorems will be proven based on configurations of the system as a whole.</p><h3 id="PMAFormalTestPlan:-(P,P)">(P,P)</h3><pre>(filler code)</pre><p>The master cannot enter the Success state unless it is in Request and all slave_ACCEPT signals are asserted.</p><p>The master cannot enter the Idle state unless it is in Success and all slave_ACCEPT signals are deasserted.</p><p>The master cannot enter the Request state unless all slave_ACCEPT and slave_DENY signals are deasserted.</p><p>If any slave_DENY signal is asserted in Request, the master will enter Wait.</p><h3 id="PMAFormalTestPlan:-(P,Q)">(P,Q)</h3><pre>(filler code)</pre><p>The master cannot enter the Success state unless it is in Request and all slave_ACCEPT signals are asserted.</p><p>The master cannot enter the Idle state unless it is in Success and all slave_ACCEPT signals are deasserted.</p><p>The master cannot enter the Request state unless all slave_ACCEPT and slave_DENY signals are deasserted.</p><p>If any slave_DENY signal is asserted in Request, the master will enter Wait.</p><h3 id="PMAFormalTestPlan:-(Q,Q)">(Q,Q)</h3><p>The key invariants here are:</p><ol><li>slave_REQn is equal to REQn, modulo synchronizer effects.</li><li>ACTIVE is equal to |slave_ACTIVE</li><li>ACCEPTn is asserted iff all slave_ACCEPTn bits are asserted and REQn is asserted.</li><li>DENY is equal to |slave_DENY</li><li>An asserted DENY remains asserted if any slave_ACCEPTn bits are deasserted.</li></ol><h2 id="PMAFormalTestPlan:-Slave">Slave</h2><p>All slaves are Q-channel internally. A P2Q converter can be used to allow control by P-channel masters. The ACL2 model is unlikely to have that distinct separation of Q-channel and P2Q sub-blocks, but only one ACL2 slave model will be built, capable of running in both modes depending on configuration. Verification will be by ACL2 model, equivalence proof, and proof of additional theorems based on the model. Note that the major differences appear to be that the P-channel version does not have an ACTIVE interface to assert and ignores attempts to abort power-down externally.</p><h3 id="PMAFormalTestPlan:-Q-Channel">Q-Channel</h3><pre>(filler code)</pre><p>When the slave is in Active state ACCEPTn, DENY, and asleep will be deasserted.</p><p>REQn is cloned to the block-side goto_sleep in the Active state.</p><p>ACCEPTn and DENY can only assert in the Entering Sleep state. Our zero-cycle model doesn't consider reset here.</p><p>The Abort-&gt;Active transition happens iff REQn is deasserted.</p><p>asleep is asserted iff the slave is in the Sleep state.</p><p>When the slave is in Sleep state, ACCEPTn and REQn must be asserted but DENY and ACTIVE must be deasserted.</p><h3 id="PMAFormalTestPlan:-P-Channel">P-Channel</h3><pre>(filler code)</pre><p>When the slave is in Active state ACCEPT, DENY, and asleep will be deasserted.</p><p>REQ is cloned to the block-side goto_sleep in the Active state.</p><p>ACCEPT and DENY can only assert in the Entering Sleep state. Our zero-cycle model doesn't consider reset here.</p><p>The Abort-&gt;Active transition happens iff REQ is deasserted.</p><p>asleep is asserted iff the slave is in the Sleep state.</p><p>When the slave is in Sleep state, ACCEPT and REQ must be asserted but DENY must be deasserted.</p><h2 id="PMAFormalTestPlan:-SystemInvariants">System Invariants</h2><h3 id="PMAFormalTestPlan:-Q-Channel.1">Q-Channel</h3><p>When the master is idle, all slaves will have consistent, stable state. That is, they will all be in one of either Active or Sleep, and their block-side asleep outputs will match this.</p><p>Here, the master is considered to be idle when REQn is not asserted and DENY is deasserted.</p><h3 id="PMAFormalTestPlan:-P-Channel.1">P-Channel</h3><p>When the master is in Idle, all slaves will have consistent, stable state. That is, they will all be in one of either Active or Sleep, and their block-side asleep outputs will match this.</p><h1 id="PMAFormalTestPlan:-ConfigurationSpace">Configuration Space</h1><p>All testbenches will require all configuration details pertaining to the module they test.</p>