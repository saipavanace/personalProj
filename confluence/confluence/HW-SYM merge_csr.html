<p>This is a script written in JS. The purpose of this script is to gather CSRs of individual blocks to create a single CSR with unique baseAddresses for each of the spaceBlocks in the generated or merged CSR. The function uses the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16158174/HW-SYM+mergeCsr" data-linked-resource-id="16158174" data-linked-resource-version="2" data-linked-resource-type="page">HW-SYM mergeCsr</a> function internally.</p><p>To run the script:<br/>$WORK_TOP/../../hw-lib/js/merge_csr.js -r <em>RTL_DIR </em>-o <em>OUTPUT </em>-a <em>ADDR_MAP_JSON</em></p><p><em>-RTL_DIR</em> is the path for the directory where all the RTL is generated. All *.attr files and instanceMap.json are expected to be in this directory, for the script to read from.</p><p><em>-OUTPUT</em> is the file and path of the CSR file to be created.</p><p>-<em>ADDR_MAP_JSON</em> is the JSON file and path that provides information about which blocks are mapped to which baseAddresses in the full config address space. The following three values are expected in this JSON:</p><p><span>{</span><br/><span>  addressWidth : A positive integer that specifies the width of address bits required to access any register in the full config address space,</span><br/><span>  blockIds : An array of positive integers or zero that specifies the IDs of blocks with registers in the config space,</span><br/><span>  baseAddresses : An array of Verilog constant literal strings that specify base addresses for blocks in the same order as their block-IDs in the blockIds array,<br/>  baseMasks (Optional): An array of Verilog constant literal strings that specify base masks for each block in the same order as their block-IDs in the blockIds array,<br/>  sizes (Optional): An array of positive integers that specify the sizes of address-regions that the blocks occupy in powers of two.<br/></span><span>}</span></p><p><br/></p><p>Example command:<br/>$WORK_TOP/../../hw-lib/js/merge_csr.js -r $WORK_TOP/debug/top_axi_axi/axi_axi_pmon_1/rtl -a axi_1x1_addr_map.json -o axi_1x1_top.csr</p><p>where the contents of the axi_1x1_addr_map.json look like this:<br/>{<br/> &quot;addressWidth&quot; : 15,<br/> &quot;blockIds&quot; : [ 3, 4, 1, 2 ],<br/> &quot;baseAddresses&quot; : [ 0, 8192, 12288, 28672 ]   // OR [ &quot;15'h0&quot;, &quot;15'h2000&quot;, &quot;15'h3000&quot;, &quot;15'h7000&quot; ],<br/> &quot;sizes&quot;: [ 12, 12, 12, 12 ]  // Size of each block is 4K (12 bits) <br/>}</p><p><br/></p>