<h2 id="HW-SYM2018-02-21MeetingnotesforPowerandClockdomainadaptersmicroarchitecturereview-Date">Date</h2><p><time datetime="2018-02-21" class="date-past">21 Feb 2018</time></p><h2 id="HW-SYM2018-02-21MeetingnotesforPowerandClockdomainadaptersmicroarchitecturereview-Attendees">Attendees</h2><ul><li><p><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a></p></li><li><p><a class="confluence-userlink user-mention" data-account-id="624b37fc258562006fa692fa" href="https://arterisip.atlassian.net/wiki/people/624b37fc258562006fa692fa?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">John Coddington (Deactivated)</a></p></li><li><a class="confluence-userlink user-mention" data-account-id="624b3704f813eb00692cb18c" href="https://arterisip.atlassian.net/wiki/people/624b3704f813eb00692cb18c?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Shailendra Aulakh (Deactivated)</a></li><li><a class="confluence-userlink user-mention" data-account-id="624b373df6a26900695fd0fc" href="https://arterisip.atlassian.net/wiki/people/624b373df6a26900695fd0fc?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Syed Shah (Deactivated)</a></li></ul><h2 id="HW-SYM2018-02-21MeetingnotesforPowerandClockdomainadaptersmicroarchitecturereview-Goals">Goals</h2><ul><li>To review and provide feedback for the initial version (0.3) of Clock and power domain adapters microarchitecture. </li></ul><h2 id="HW-SYM2018-02-21MeetingnotesforPowerandClockdomainadaptersmicroarchitecturereview-Discussionitems">Discussion items</h2><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Time</th><th class="confluenceTh">Item</th><th class="confluenceTh">Who</th><th class="confluenceTh">Notes</th></tr><tr><td class="confluenceTd">60 min</td><td class="confluenceTd">Microarchitecture discussion</td><td class="confluenceTd"><a class="confluence-userlink user-mention" data-account-id="624b3704f813eb00692cb18c" href="https://arterisip.atlassian.net/wiki/people/624b3704f813eb00692cb18c?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Shailendra Aulakh (Deactivated)</a>, <a class="confluence-userlink user-mention" data-account-id="624b37fc258562006fa692fa" href="https://arterisip.atlassian.net/wiki/people/624b37fc258562006fa692fa?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">John Coddington (Deactivated)</a>, <a class="confluence-userlink user-mention" data-account-id="624b373df6a26900695fd0fc" href="https://arterisip.atlassian.net/wiki/people/624b373df6a26900695fd0fc?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Syed Shah (Deactivated)</a></td><td class="confluenceTd"><ul><li>The 'Gen Err Resp' block needs more details:</li></ul><ol><li>It should include an LUT function to determine the route field for the generated error response.</li><li>It might also have to calculate protection bits or ECC. This might mean updating fields in Header or NDP. <em>TBD.</em></li></ol><ul><li><span>There needs to be an output (<em>busy</em>) going out of the power domain adapter to communicate with the PMU to indicate any outstanding requests (that haven't received responses yet). This just implies a counter that counts the outgoing requests and decrements on the last response for each request. No need to store and match the request IDs to response IDs. When the counter gets full (max. no. of outstanding requests <em>TBD</em>), then request link can be back-pressured.</span></li><li><span>Response link only carries response packets and request links only request packets. Hence a single power domain adapter design could be used for 'Request-Response' pair from PD2 to PD1 as well as for a 'Request-Response' pair from PD1 to PD2. </span></li><li><span>Async or Sync FIFO pushes, if any, in the Power domain adapter should be qualified by the '<em>pwr</em>' input.</span></li><li>An option/parameter must be provided to either optimize away all registers on the 'error response' path or to insert a register/FIFO (HDR+NDP FIFO) to break the timing path.</li><li>Clock domain crossing boundary includes the possibility of the clock in one clock domain being able to be turned off independently of the clock in the other domain.</li><li>This would imply that the clock domain adapter needs to listen to a status signal from the PMU (<em>clk2_En</em>) and send an error response back on <em>clk1 domain </em>if <em>clk2</em> is off. <em>PD2</em> switching on does not imply clocks in <em>PD2</em> is enabled. Hence need to listen to <em>clk2_En</em>.</li><li>Design separate Verilog logic primitives for FIFOs in which memory is implemented as register-array and FIFOs in which memory is implemented as RAM, external to the FIFO module, with <em>mem_ecc</em> bits. The FIFO could be built hierarchically so as to separate the memory from the control logic, so as to allow replication of control logic and memory independently of each other.</li></ul></td></tr><tr><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><p><br/></p></td></tr></tbody></table></div><h2 id="HW-SYM2018-02-21MeetingnotesforPowerandClockdomainadaptersmicroarchitecturereview-Actionitems">Action items</h2><ul class="inline-task-list" data-inline-tasks-content-id="16168640"><li data-inline-task-id="1"><a class="confluence-userlink user-mention" data-account-id="624b373df6a26900695fd0fc" href="https://arterisip.atlassian.net/wiki/people/624b373df6a26900695fd0fc?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Syed Shah (Deactivated)</a> - To be decided, if protection bits to be added as part of the NDP, so as to match the error response from NCore. So that the power adapter can generate the same error response, when a power domain is off. </li><li class="checked" data-inline-task-id="2"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a> - A counter that counts the number of outstanding requests and counts down the 'last' responses to be included in the power as well as clock adapter design. And an output <em>busy</em> to be sent out to communicate with the PMU when the counter is non-zero.</li><li class="checked" data-inline-task-id="3"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a> - Clock domain adapter needs to include logic to send error response back when clock is cut off in the domain to which the requests are going. This implies the addition of an input to the clock and power domain adapters, <em>clk2_en</em>. </li><li data-inline-task-id="4"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a> - Include an option in TACHL code to optimize away the 'HDR+NDP' FIFO completely or to have a register or minimum depth FIFO to break the timing path. </li><li data-inline-task-id="5"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a> - Qualify FIFO pushes in power domain adapter with both '<em>pwr' </em>(indicates if PD2 is off) as well as with <em>clk2_en</em> (indicates if CLK2 domain is off). </li><li class="checked" data-inline-task-id="6"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a> - Define 'GEN ERR RESP' block. Include an LUT function to determine the route field for the generated error response. Also must calculate protection bits the same way as the target. </li><li data-inline-task-id="7"><a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a> - When writing TACHL code, generate separate Verilog logic modules for FIFO in which memory is implemented as register array and FIFO in which memory is implemented externally (RAM). Ensure FIFO is built hierarchically, so that replication of control logic and memory can be done independently of each other. </li></ul>