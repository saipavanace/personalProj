<p><style>[data-colorid=cdyq0v2zwq]{color:#333333} html[data-color-mode=dark] [data-colorid=cdyq0v2zwq]{color:#cccccc}[data-colorid=dx6nkiqapd]{color:#333333} html[data-color-mode=dark] [data-colorid=dx6nkiqapd]{color:#cccccc}</style><strong>RTL :</strong></p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16156660/firewall%20RTL.png?api=v2" /></span></p><p><strong>TB :</strong></p><p><strong><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16156660/Firewall%20TB.png?api=v2" /></span></strong></p><p>&nbsp;</p><p><strong>UVM Verification Architecture Description:</strong></p><p><strong>Sequences:&nbsp; </strong>Following basic&nbsp;sequences are there :</p><ol><li style="text-align: left;">&nbsp;APB sequence:&nbsp; &nbsp;Randomly enables or disables the firewall by driving values in the firewall RTL enable-register via APB agent.</li><li>&nbsp;GEN sequence:&nbsp; &nbsp;Randomly sets the value of gen_in to be used by UDV for comparison and drives values via Generic IO agent.</li><li>&nbsp;ATP sequence:&nbsp; Randomly generates a sequence of different ATP packets(valid, invalid, poisoned) and drives packets via ATP master agent.</li></ol><p>&nbsp; &nbsp; &nbsp; The firewall virtual sequence drives the above basic sequences in parallel.</p><p><strong>Agents:</strong>&nbsp; &nbsp;The agents drive/monitor a particular sequence-item to corresponding RTL interface signals. All the agents send the driven/monitored packet to scoreboard via analysis ports.&nbsp;</p><p><strong>ATP reactive slave agent:</strong>&nbsp; Responds to ATP packet sent out by the RTL ATP master. Collects the packet and sends to the scoreboard.</p><p><strong>Scoreboard:&nbsp;</strong>&nbsp; Collects the driven and received sequence-items from all the agents via analysis ports.</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Implements the checkers listed in the testplan. Also does the end of check test.</p><p>&nbsp;</p><p><strong>Plan :</strong></p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="numberingColumn confluenceTh">&nbsp;</th><th class="confluenceTh">Feature</th><th colspan="1" class="confluenceTh">Priority</th><th class="confluenceTh">Parameter with ranges</th><th class="confluenceTh">Stimulus</th><th class="confluenceTh">Checking</th><th colspan="1" class="confluenceTh">Timeline</th><th colspan="1" class="confluenceTh">Status</th></tr><tr><td class="numberingColumn confluenceTd">1</td><td class="confluenceTd">Interrupt generation for erroneous packet with input H_poison field=0</td><td colspan="1" class="confluenceTd">&nbsp;</td><td class="confluenceTd">H_pri, H_poison</td><td class="confluenceTd"><p>Directed test<br />Constrained random stimulus generated with H_pr=7, H_poison=0</p></td><td class="confluenceTd"><p>Interrupt generated.<br />RTL flips H_poison from 0 to 1 for invalid input packets</p></td><td colspan="1" class="confluenceTd"><p>done</p></td><td colspan="1" class="confluenceTd">Tested counts of erroneous packets and interrupts. Observed it is equal. Test passing</td></tr><tr><td class="numberingColumn confluenceTd">2</td><td class="confluenceTd">Interrupt generation for erroneous&nbsp; packet with input H_poison field=1</td><td colspan="1" class="confluenceTd">&nbsp;</td><td class="confluenceTd"><span>H_pri, H_poison</span></td><td class="confluenceTd"><p>Directed test<br />Constrained random stimulus generated with H_pr=7, H_poison=1</p></td><td class="confluenceTd"><p>Interrupt generated for invalid input packets.<br />H_poison is preserved 1 for all packets</p></td><td colspan="1" class="confluenceTd"><span>done </span></td><td colspan="1" class="confluenceTd">Tested counts of erroneous packets and interrupts. Observed it is equal. Test passing</td></tr><tr><td class="numberingColumn confluenceTd">3</td><td class="confluenceTd">Interrupt generation for random packets</td><td colspan="1" class="confluenceTd">&nbsp;</td><td class="confluenceTd">H_pri, H_poison</td><td class="confluenceTd"><p>Random stimulus generated</p></td><td class="confluenceTd">Interrupt generated only for erroneous packets.&nbsp; H_poison preserved for poison input packets</td><td colspan="1" class="confluenceTd"><span>done </span></td><td colspan="1" class="confluenceTd"><p>Interrupt generated for all invalid input packets.&nbsp; &nbsp; (Bug : SYM-1185 solved by designer)</p></td></tr><tr><td class="numberingColumn confluenceTd">4</td><td colspan="1" class="confluenceTd">Disable firewall</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd"><p>APB, H_pri, H_poison</p></td><td colspan="1" class="confluenceTd"><p>Enable and disable firewall register via APB configuration,</p><p>Invalid packets generated</p></td><td colspan="1" class="confluenceTd">If the 1-bit register is enabled the firewall should check for the violation, inject and report error otherwise the packet should be transferred across as it is</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd">Test passed. Incase firewall is disabled, the input packet is passed to output as it is.</td></tr><tr><td class="numberingColumn confluenceTd">5</td><td colspan="1" class="confluenceTd">RAL Integration</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">APB</td><td colspan="1" class="confluenceTd">Write and read registers inside the firewall via RAL flow</td><td colspan="1" class="confluenceTd">Check that the enable register is accessible through RAL flow</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd"><p>Bug <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1701" rel="nofollow" style="text-decoration: none;">SYM-1701</a>,</p><p>Bug <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1682" rel="nofollow" style="text-decoration: none;">SYM-1682</a>,</p><p>Task : <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1472" rel="nofollow" style="text-decoration: none;">SYM-1472</a></p></td></tr><tr><td class="numberingColumn confluenceTd">6</td><td colspan="1" class="confluenceTd">Generic IO interface</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">H_pri, H_poison</td><td colspan="1" class="confluenceTd"><p>Give input to the generic IO interface which is to be compared against the UDV field values,</p><p>Normal and invalid ATP packets generated</p></td><td colspan="1" class="confluenceTd">The output of the generic IO interface should be the same as the input to the generic IO interface. If the comparison between the input to the generic IO interface and the UDV fields fail then an interrupt should be generated, the error status should be reflected in the corresponding output ATP packet</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd">Test passed.</td></tr><tr><td class="numberingColumn confluenceTd">7</td><td colspan="1" class="confluenceTd">Reset recovery</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">All valid parameters</td><td colspan="1" class="confluenceTd">Give on the fly reset when the firewall is actively processing ATP packets</td><td colspan="1" class="confluenceTd">After the firewall goes into reset the internal registers should be set to default values, the previous ATP transfers should be aborted and after-reset ATP transfers should happen as in normal case</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd">Test passed.</td></tr><tr><td class="numberingColumn confluenceTd">8</td><td colspan="1" class="confluenceTd">Backpressure</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd"><p>addStage,</p><p>udvLatency</p></td><td colspan="1" class="confluenceTd">Drive the out_ready signal low for a large duration of time and then release it</td><td colspan="1" class="confluenceTd">Once the out_ready is driven low, after some time the in_ready should also become low and the firewall should not accept more input ATP packets. After the out_ready is released the firewall should function in a normal way</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd"><p>Test passed</p><p>Bug <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1761" rel="nofollow" style="text-decoration: none;">SYM-1761</a> fixed by designer</p><p>Task : <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1468" rel="nofollow" style="text-decoration: none;">SYM-1468</a></p></td></tr><tr><td class="numberingColumn confluenceTd">9</td><td colspan="1" class="confluenceTd">UDV latency</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">udvLatency</td><td colspan="1" class="confluenceTd">Set different values for udv latency and send random ATP packets</td><td colspan="1" class="confluenceTd">Check that the output ATP packet comes after a certain time range starting from when the input ATP packet is given. The time range should be based on the udvLatency configured.</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd"><p>Test passed</p><p>Bug <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1757" rel="nofollow" style="text-decoration: none;">SYM-1757</a> fixed by designer</p><p>Env changes as per <a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-2002" rel="nofollow" style="text-decoration: none;">SYM-2002</a></p></td></tr><tr><td class="numberingColumn confluenceTd">10</td><td colspan="1" class="confluenceTd"><span>Protection mechanism </span></td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">Not a P0 feature for release 1</td></tr><tr><td class="numberingColumn confluenceTd">11</td><td colspan="1" class="confluenceTd">Back to back transfers</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd"><span>All valid parameters</span></td><td colspan="1" class="confluenceTd">Generate random stimulus with minimum inter transfer gap</td><td colspan="1" class="confluenceTd">All valid checks corresponding to the stimulus generated.</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd">Test passed</td></tr><tr><td class="numberingColumn confluenceTd">12</td><td colspan="1" class="confluenceTd"><span>Fully random stimulus</span></td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd"><span>All valid parameters</span></td><td colspan="1" class="confluenceTd">Generate fully random stimulus covering all the features, mixed packets, random interpacket delay, random input signaling</td><td colspan="1" class="confluenceTd"><span>All valid checks corresponding to the stimulus generated.</span></td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd">Test passed</td></tr><tr><td class="numberingColumn confluenceTd">13</td><td colspan="1" class="confluenceTd">Performance</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd"><span>All valid parameters</span></td><td colspan="1" class="confluenceTd"><span>Random stimulus generated</span></td><td colspan="1" class="confluenceTd">Ensure that the overall firewall transfers do not take unreasonable time based on theoretical estimations. The firewall should not be a bottleneck in the system</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd"><p>Test passed</p></td></tr><tr><td class="numberingColumn confluenceTd">14</td><td colspan="1" class="confluenceTd">more than one virtual channel</td><td colspan="1" class="confluenceTd">&nbsp;</td><td colspan="1" class="confluenceTd">nVc &gt; 1</td><td colspan="1" class="confluenceTd"><span data-colorid="cdyq0v2zwq" style="text-decoration: none;">Random stimulus generated</span></td><td colspan="1" class="confluenceTd">Ensure firewall functionality for all the virtual channels</td><td colspan="1" class="confluenceTd">done</td><td colspan="1" class="confluenceTd"><p>Test passed</p><ol style="text-decoration: none;text-align: left;margin-left: 0.0px;" class="aui-nav aui-nav-breadcrumbs"><li style="list-style-type: none;"><a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-1929" rel="nofollow" style="text-decoration: none;">SYM-1929</a> fixed</li></ol></td></tr></tbody></table></div><p>Note: Currently some glitches are seen on the interrupt interface. As suggested by John, currently ignoring the glitches in verification. (SYM-1452)</p><h1 id="FirewallAdapterTestPlan(TransportLevel):-Helicopterview:">Helicopter view:</h1><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="highlight-grey confluenceTh" data-highlight-colour="grey">Main feature</th><th class="confluenceTh">Sub features</th><th class="confluenceTh">Parameters</th><th class="confluenceTh">Stimulus</th><th class="confluenceTh">Checkers</th></tr><tr><td class="confluenceTd">signaling</td><td class="confluenceTd"><p>random input signaling with constraints</p><p>Interrupt generation</p><p>Continuous signaling</p></td><td rowspan="5" class="confluenceTd"><p>packet field combinations for UDV (H_)</p><p>random link width</p><p>pkt style (serial, parallel or fixed)</p><p>simplePipe (true,false)</p><p>addStage (true,false)</p><p>fire packet width parameters (wH)</p><p>protection interface parameters</p><p>clk interface parameters</p><p>udvlatency</p><p>nVc (virtual channel)</p><br /><br /><br /></td><td rowspan="5" class="confluenceTd"><p>random packet generation</p><p>signal randomization (valid signals)</p><p>random beats (PHITs)</p><p>poison packets</p><p>invalid packets</p><p>on the fly reset (multiple)</p><p>ready signal handling</p><p>interpacket gap</p><p>intersignal gap</p><p>back to back packets</p><p>mixed packets</p><p>continuous signaling</p><p>parallel stimulus with constraints</p><p>directed stimulus</p><p>clk variation (gating)</p><p>large delays</p><p>large no. of transactions</p><p>random sequence of packets</p></td><td rowspan="5" class="confluenceTd"><p>ATP protocol compliance</p><p>data integrity in all cases for unprocessed fields including poison input pkt</p><p>error injection in output packet in case of invalid input</p><p>interrupt generation (count, pulse width) in case of invalid input</p><p>ensure latency requirements (data, interrupt)</p><p>reset recovery</p><p>internal state checking</p><p>protection mechanism validation (updated ECC, parity in case of error pkt)</p><p>end of check test (match counters, all transactions completed, timeouts)</p><p>ordering requirements (first in, first out)</p><br /><br /><br /><br /><br /></td></tr><tr><td class="confluenceTd">buffering</td><td class="confluenceTd"><p>back pressure</p><p>outstanding packets</p></td></tr><tr><td class="confluenceTd">latency</td><td class="confluenceTd"><p>normal ATP to ATP link latency</p><p>udvlatency for error injection</p><p>total latency</p></td></tr><tr><td class="confluenceTd">data integrity</td><td class="confluenceTd"><p>poisoned input packet</p><p>output packet header protection</p><p>output packet error injection</p><p>invalid input packets</p><p>mixed input packets</p></td></tr><tr><td class="confluenceTd">reset recovery</td><td class="confluenceTd">on the fly reset (can be multiple)</td></tr></tbody></table></div><h1 id="FirewallAdapterTestPlan(TransportLevel):-250"><a href="/wiki/spaces/ENGR/pages/16156660/Firewall+Adapter+Test+Plan+Transport+Level?preview=%2F16156660%2F16234872%2Fsymphony+firewall+flow_R2.docx"><span style="background: url('/wiki/s/-672721829/6452/d621ad2a33e27b90ca05c475b216bfab745e08a2/1000.0.0-d621ad2a33e2/_/download/resources/com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-resources/images/placeholder-medium-doc.png'); width: 177px; height: 95px; display: inline-block; padding-top: 155px; margin: 2px; border: 1px solid #ddd; text-align: center; vertical-align: text-bottom; text-decoration: none; font-size: 12px; color: #000;">symphony firewall flow_R&hellip;</span></a></h1><h1 id="FirewallAdapterTestPlan(TransportLevel):-ACTIONITEMS/NOTES:(fromreviewson8/28/2019)">ACTION ITEMS / NOTES: (from reviews on 8/28/2019)&nbsp;</h1><ol><li>Need to add a test case for UDV Latency &gt; 0. --&gt;&nbsp;<a class="confluence-userlink user-mention" data-account-id="624b38174fe01d006ba96e74" href="https://arterisip.atlassian.net/wiki/people/624b38174fe01d006ba96e74?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kushal Choksi (Deactivated)</a> &nbsp; &nbsp; (done)</li><li>Added test to enable multiple resets in any of the testplan testcases. --&gt;&nbsp;<a class="confluence-userlink user-mention" data-account-id="624b38174fe01d006ba96e74" href="https://arterisip.atlassian.net/wiki/people/624b38174fe01d006ba96e74?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kushal Choksi (Deactivated)</a> &nbsp;&nbsp; (done)</li><li>H_addr to firewall in FIXED_SERIAL header mode --&gt;&nbsp;<a class="confluence-userlink user-mention" data-account-id="624b38174fe01d006ba96e74" href="https://arterisip.atlassian.net/wiki/people/624b38174fe01d006ba96e74?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kushal Choksi (Deactivated)</a> (done)</li><li>Run simulations with zero delay from Slave side. (done)</li><li>Verify firewall with bubbles within the packets.(done)</li><li>Verify firewall with,<ol><li>Header-Parallel (with and without VCs). (done)</li><li>Header-Serial (with and without VCs) (done)</li></ol><ol><li>Fixed-Serial (with and without VCs). (done)</li></ol></li></ol><h1 id="FirewallAdapterTestPlan(TransportLevel):-ACTIONITEM/NOTES:(fromreviewon1/17/2020)">ACTION ITEM /NOTES: (from review on 1/17/2020)</h1><ol><li>Use counter variable added by John to count the interrupts in case of VC &gt; 1. (done)</li><li>Configure <span data-colorid="dx6nkiqapd" style="text-decoration: none;">Interrupt mask register</span> from sequence through RAL&nbsp; in case of VC &gt; 1.&nbsp; :- &nbsp; can be done after SYM-1929 is solved. (done)</li><li>Update block diagram to connect interrupt handler to the scoreboard. (done)</li><li>Update flow document and testplan with details of the configurations verified.&nbsp; Add verification for configurations missed. (done)</li><li>Specify the CSR generation details in the document. (not required, as now autogenerated by runsim)</li><li>Add H_addr for FIXED_SERIAL header across more than 1 clk cycle. The code needs to be manual and gets activated via a switch.<br />Not a priority but maybe useful in future at top level.</li><li>Work with dv-infrastructure to see that firewall json generated get cleaned if specified during simulation :&nbsp; less priority</li><li>Run tests with minimum : 1 beat&nbsp; ATP packet&nbsp; and maximum 4K ATP data beats</li></ol><p>. &nbsp;&nbsp;</p><p>&nbsp; &nbsp; &nbsp;</p><p>&nbsp;</p>