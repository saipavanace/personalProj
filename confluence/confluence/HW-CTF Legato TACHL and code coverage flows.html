<h1 id="HW-CTFLegatoTACHLandcodecoverageflows-Linkstoothercoveragepages"><strong>Links to other coverage pages</strong></h1><p style="margin-left: 30.0px;"><strong><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168351/Formal+CoverCheck+exclusions+generation+script+-+runCoverCheck.js" data-linked-resource-id="16168351" data-linked-resource-version="2" data-linked-resource-type="page">Formal CoverCheck exclusions generation script - runCoverCheck.js</a></strong></p><p style="margin-left: 30.0px;"><strong><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16159774/Legato+Ncore_cfg_network+DV+Closure+Regressions+PARAMs+TACHL+and+CODE+Coverage" data-linked-resource-id="16159774" data-linked-resource-version="305" data-linked-resource-type="page">Legato &amp; Ncore_cfg_network DV Closure (Regressions, PARAMs, TACHL and CODE Coverage):</a></strong></p><p style="margin-left: 30.0px;"><strong><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16159692/Questa+Code+Coverage+Tutorial" data-linked-resource-id="16159692" data-linked-resource-version="5" data-linked-resource-type="page">Questa Code Coverage Tutorial</a></strong></p><p><br/></p><h1 id="HW-CTFLegatoTACHLandcodecoverageflows-LegatoSMIandCSRNetworkCoverage"><strong>Legato SMI and CSR Network Coverage </strong></h1><p>To get TACHL coverage for legato run the following command in a new area (The command must be run in the top directory, where SOURCEME is located)</p><p style="margin-left: 30.0px;">runsim -l legato -g -exe 231 -tcpc -ij $WORK_TOP/scripts/ignore_legato.json</p><p>Use a browser in linux to browse the simulation results in the dv/regressions/_date_time_of_regression_/regresssion_report_*.html</p><p>To clean up an area for another run remove the databases from the top directory:</p><p style="margin-left: 30.0px;">rm -rf summary_tachl_coverage.txt preped_top_* report_top_* *.log commonLayer.csr.cpr envList.json hw-sym/dv/regression</p><p><br/></p><h1 id="HW-CTFLegatoTACHLandcodecoverageflows-LegatoCSRNetworkCoverage"><strong>Legato CSR Network Coverage </strong></h1><p>To get TACHL coverage for legato CSR network run the following command in a new area:</p><p>     runsim -e top_axi_apb -c hw_cfg_30_csr -t axi4_single_beat_wr -i 0 -exe 200 -tcpc -ij $WORK_TOP/scripts/ignore_legato.json</p><p>Use a browser in linux to browse the simulation results in the dv/regressions/_date_time_of_regression_/regresssion_report_*.html</p><p><br/></p><p><strong>Available Tags: </strong></p><ul><li>symphony: something that will always be waived in the symphony use case.</li><li>symphonyR1: something that will only be waived for symphony release 1. </li><li>legato: something that will be waived for the Ncore use case. </li></ul><p><br/></p><h1 id="HW-CTFLegatoTACHLandcodecoverageflows-Coveragefilteristanbulexamples:"><strong>Coverage filter istanbul examples:</strong></h1><p>/* istanbul ignore if */ -&gt; Always stays in<br/>/* istanbul ignore if env symphony */ -&gt; Stays in for runs that apply the symphony tag<br/>/* Istanbul ignore if env symphony, legato */ -&gt; Stays in for runs that apply either the symphony tag, the legato tag or both.</p><p>/* istanbul ignore next env symphony */ -&gt; Stays in for runs that apply the symphony tag and used for statement, branch, function filtering. </p><p style="margin-left: 30.0px;">var size = (wDataB == 1) ? /* istanbul ignore next env symphony */ 1 :log2ceil(wDataB);  →branch condition where the condition of the ternary expression (wDataB==1) is always FALSE. </p><p>Any Istanbul syntax is now supported. To make it conditional, you follow it with a &quot;env tag0,tag1” where you can have any number of comma separated tags.</p><p>Quick article about ignoring/filtering code for coverage: <a class="external-link" href="https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.md" rel="nofollow">https://github.com/gotwarlost/istanbul/blob/master/ignoring-code-for-coverage.m</a></p><p><br/></p><p><strong>Current workaround for issues seen:</strong></p><p>Sometimes the html viewer does not visually show what line a missing branch condition is reporting. You can peek at the following report file that will give you the exact line(s) that is missing. However if you have many other issues, you cannot see a full list. </p><p>dv/debug/tachl_coverage/tc_merged_envs_table.txt</p><p><br/></p><h1 id="HW-CTFLegatoTACHLandcodecoverageflows-HelperScripts">Helper Scripts</h1><p><a class="external-link" href="http://gitlab.arteris.com/hardware/hw-lib/blob/master/js/find_pat.js" rel="nofollow">http://gitlab.arteris.com/hardware/hw-lib/blob/master/js/find_pat.js</a></p><p>For usage type command with out any options:</p><pre>[jcodd@pomerol jcodd]$ $WORK_TOP/../../hw-lib/js/find_pat.js<br/>ERROR - /scratch/jcodd/regress/hw-lib/js/find_pat.js: Missing required options.<br/>/scratch/jcodd/regress/hw-lib/js/find_pat.js Usage -i indir_path -p pat_file -o outfile_path &lt;-tb top_block -tp top_path -d debug_file -hf hier_file -h&gt;<br/>    indir_path: Required. Path to input verilog directory.<br/>    pat_file: Required. Path to input pattern file.<br/>    outfile_path: Required. Path to output exclusion file.<br/>    top_block: Optional. Default value is tb_wrapper<br/>    top_path: Optional. Default value is /tb_top<br/>    hier_file: Optional. Side file to use instead parsing verilog<br/>    debug_file: Optional. Path to debug file which contains instance to module map.<br/>    -h: Optional. Prints out this message</pre><p>The pattern file as the following format:</p><p style="margin-left: 30.0px;">[<br/>  {&quot;file_pat&quot; : &quot;sym_switch.*&quot;,<br/>   &quot;line_pat&quot; : &quot;= lck_egress1_ingress1_vc0 \\&amp; ~\\(i1_valid \\&amp; i1_ready \\&amp; i1_last\\);&quot;,<br/>   &quot;exclusion&quot; : &quot;coverage exclude -src %file% -line %line%&quot;,<br/>   &quot;comment&quot; : &quot;X-Y routing doesn't use this path.&quot;<br/>  },<br/>  {&quot;file_pat&quot; : &quot;sym_switch.*&quot;,<br/>   &quot;instances&quot; : [<br/>     &quot;/tb_top/m_top_wrapper/U_meshATP/U_sw0_3/U_switch&quot;,<br/>     &quot;/tb_top/m_top_wrapper/U_meshATP/U_sw1_2/U_switch&quot;,<br/>     &quot;/tb_top/m_top_wrapper/U_meshATP/U_sw2_2/U_switch&quot;<br/>   ],<br/>   &quot;line_pat&quot; : &quot;= lck_egress1_ingress1_vc0 \\&amp; ~\\(i1_valid \\&amp; i1_ready \\&amp; i1_last\\);&quot;,<br/>   &quot;line_offset&quot;: 3, <br/>   &quot;line_range&quot;: 4,<br/>   &quot;exclusion&quot; : &quot;coverage exclude -src {%instance%} -line %line%&quot;,<br/>   &quot;comment&quot; : &quot;X-Y routing doesn't use this path.&quot;<br/>  }<br/>]</p><p><br/></p><p>The following substitutions are supported in exclusion:</p><p style="margin-left: 30.0px;">%instance% gets replaced by the instance found</p><p style="margin-left: 30.0px;">%file% gets replaced by the absolute file name found</p><p style="margin-left: 30.0px;">%line% gets replaced by the line number where the pattern was found.</p><p style="margin-left: 30.0px;">%to_line% gets replaced by the line number where the pattern was found plus line_range-1.</p><p>&quot;line_offset&quot; is the offset added to line number found with &quot;line_pat&quot; when replacing %line% and %to_line%. It can be negative.</p><p>So if the pattern was found on line 127 and line_offset = 3, then %line% will get replaced with 130.</p><p><br/></p><p><strong>Todo List:</strong></p><ul class="inline-task-list" data-inline-tasks-content-id="16157051"><li class="checked" data-inline-task-id="2"><span class="placeholder-inline-tasks">add pipes to the config network with various depths and various pipeForwards and pipeBackwards</span></li><li class="checked" data-inline-task-id="4"><span class="placeholder-inline-tasks">Do we ever use simplePipe in ATUs for Ncore config network? - No</span></li><li class="checked" data-inline-task-id="6"><span class="placeholder-inline-tasks">Do we port prune switches in Ncore 3.0?</span></li><li class="checked" data-inline-task-id="8"><span class="placeholder-inline-tasks">We need a configuration with clk gating enabled for the csr network. - hw_cfg_20_csr</span></li></ul>