<h1 id="NcoreFabricGenerator-Createaregressarea:">Create a regress area:</h1><p>(Need to try this in an Ncore area to see what happens)</p><h2 id="NcoreFabricGenerator-SymphonyInstructions:">Symphony Instructions:</h2><p style="margin-left: 30.0px;"><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16169445/One+for+All+Simulation+-+Regression+Tool+-+runsim" data-linked-resource-id="16169445" data-linked-resource-version="9" data-linked-resource-type="page">One for All Simulation - Regression Tool - &quot;runsim&quot;</a></p><p>Create and environmental variable that points at the top of the symphony pulled repository</p><p style="margin-left: 30.0px;">setenv SYM_TOP $WORK_TOP/..</p><p>Goto the Ncore_fabric area:</p><p style="margin-left: 30.0px;">cd $SYM_TOP/dv/tb/top/Ncore_fabric</p><h2 id="NcoreFabricGenerator-NcoreInstructions:">Ncore Instructions:</h2><p style="margin-left: 30.0px;">(Khaleel insert instructions here)</p><h2 id="NcoreFabricGenerator-CommonInstructions:">Common Instructions:</h2><p>Run the script called create_fabric.js. If there's a error in it's command line options it gives directions:</p><pre>[jcodd@mondavi Ncore_fabric]$ ./create_fabric.js <br/>ERROR - /home/jcodd/work/regress/hw/dv/tb/top/Ncore_fabric/create_fabric.js: Missing required options.<br/>/home/jcodd/work/regress/hw/dv/tb/top/Ncore_fabric/create_fabric.js Usage -smi smiFile_path -id idFile_path -cs cacheSize -wd wData -p pktStyle -n name &lt;-h&gt;<br/>     smiFile_path: Required. Path to InterfaceSMI JSON parameters file.<br/>     idFile_path:  Required. Path to IDs array JSON parameters file.<br/>     cacheSize:    Required. Cache size in bytes.<br/>     wData:        Required. Data width in bytes.<br/>     pktStyle:     Required. Packet Style of ATP link: parallel, serial or fixed.<br/>     name:         Required. Name to prefix on all created stuff<br/>     -h:           Optional. Prints out this message<br/> <br/>     IDs array JSON format:<br/>         {<br/>           &quot;idWidth&quot;:    int // width of ID in bits<br/>           &quot;idSubWidth&quot;: int // width of ID subchannel in bits<br/>           &quot;idArray&quot;: [array of ints]  // Array of IDs to be used<br/>         }</pre><div><span><br/></span></div><div><span>There are example files for both </span>smiFile_path and idFile_path:</div><div style="margin-left: 30.0px;">example_smi.json<br/>example_id.json</div><p> </p><div>So a full run with all the bells and whistles:</div><p>[jcodd@mondavi Ncore_fabric]$ ./create_fabric.js -smi example_smi.json -id example_id.json -cs 64 -wd 16 -p parallel -n yellow <br/>Bus width:               358<br/>max_beats:               4<br/>header_width:            205<br/>max_header_field_width:  136<br/>data_beat_multiplier:    8<br/>data_beat_width:         153<br/>min_data_beat_width_F:   19<br/>min_data_beat_width_C:   1<br/>min_data_width:          16<br/>number_data_beats:       4<br/>null bits to total bits: 0.42946927374301674<br/>data bits to beat bits:  0.4273743016759777</p><p>This creates a bunch of JSON files all prepended with yellow_ and it creates a link packet def whose object name is yellow and sticks that in director cpr:</p><pre>[jcodd@mondavi Ncore_fabric]$ ls yellow_*<br/>yellow_0_0_smipkt.json  yellow_0_3_smipkt.json  yellow_1_2_smipkt.json  yellow_2_1_smipkt.json  yellow_atp.json      yellow_smidepkt.json<br/>yellow_0_1_smipkt.json  yellow_1_0_smipkt.json  yellow_1_3_smipkt.json  yellow_2_2_smipkt.json  yellow_basePkt.json  yellow_smi.json<br/>yellow_0_2_smipkt.json  yellow_1_1_smipkt.json  yellow_2_0_smipkt.json  yellow_2_3_smipkt.json  yellow_fabric.json   yellow_sw.json<br/>[jcodd@mondavi Ncore_fabric]$ ls cpr<br/>yellow.packet.cpr</pre><p>There's a sh script called run_fabric.sh that will do a TACHL compile:</p><pre>./run_fabric $1 $2 $3<br/>  $1 = JSON file to build<br/>  $2 = top TACHL file for $1<br/>  $3 = output directory to dump verilog into</pre><p> </p><pre>[jcodd@mondavi yellow]$ ./run_fabric yellow_fabric.json gen_wrapper.tachl yellow</pre><p><span>Go into the yellow directory and run verilator on it to make sure things are good to try:</span></p><pre>[jcodd@mondavi yellow]$ cd yellow<br/>[jcodd@mondavi yellow]$ ln -s $SYM_TOP/node_modules/@arteris/hw-lib/verilog/dffre.v . &lt;-- Not really a common instruction<br/>[jcodd@mondavi yellow]$ verilator --lint-only gen_wrapper.v -I. --error-limit 0 -Wall -Wno-UNUSED -Werror-UNDRIVEN</pre>