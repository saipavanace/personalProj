<p>The <code>environment-modules</code> package provides a tool to handle your Linux environment depending on your software needs.</p><h1 id="Environmentmodules-Modulecommands">Module commands</h1><h2 id="Environmentmodules-Listavailablemodules">List available modules </h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module available</pre>
</div></div><h2 id="Environmentmodules-Information">Information </h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module help
$ module help cdns
$ module whatis
$ module whatis cdns
$ module apropos</pre>
</div></div><h2 id="Environmentmodules-Loadamodule"> Load a module </h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module load snps
$ module load snps/fn
$ module add snps</pre>
</div></div><h2 id="Environmentmodules-Listloadedmodules">List loaded modules </h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module list</pre>
</div></div><h2 id="Environmentmodules-Unloadaloadedmodule">Unload a loaded module </h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module unload snps
$ module rm snps/fn</pre>
</div></div><h2 id="Environmentmodules-Replaceacurrentlyloadedmodule">Replace a currently loaded module </h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module load cdns/ae
$ module switch cdns/eng     # switch ae for eng</pre>
</div></div><h1 id="Environmentmodules-Shellaliases">Shell aliases</h1><p>Here are suggestions of aliases:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ alias mav=&quot;module available&quot;
$ alias mlo=&quot;module load&quot;
$ alias mli=&quot;module list&quot;
$ alias mul=&quot;module unload&quot;
$ alias msh=&#39;module show&#39;
$ alias msw=&#39;module switch&#39; </pre>
</div></div><h1 id="Environmentmodules-Modulefiles">Module files</h1><h2 id="Environmentmodules-Principles">Principles</h2><p>The <code>module available</code> command should give you the path(s) where the module files are located. At this time, they are in <code>/engr/dev/tools/modules</code>. They are written in Tcl so they are usable by any interpreter supported by the module command (bash  csh  ksh  perl  python  ruby  sh  tcsh  zsh). </p><p>The <code>.version</code> file in each directory is used to define the default version of a module. For instance, if <code>set ModulesVersion 4.7.5</code> is put in the <code>fc/.version</code> file, executing <code>module load fc</code> will actually load <code>fc/4.7.4</code>, saving you from typing the whole version number. The <code>.version</code> file usually contains the last production version of a module and typically has to be changed every time a production module version is published.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ cat fc/.version 
#%Module######################################################################
#
# Default version of the FlexNoC module
#

set ModulesVersion 4.7.4</pre>
</div></div><h2 id="Environmentmodules-Writingconventions">Writing conventions</h2><p>Module files are not scripts, and thus should not be written as such. The Tcl language use does not mean you should write them programmatically, but rather as static (and simple) as possible. This is because they need to be loadable and removable, which implies some constraints.<br/>Don’t source other files, and just avoid conditional expressions generally. This will yield a lot of very similar files; basically, all the files for a product will be virtually identical except for the version parameter. While this convention is tedious duplicate a lot of code, you can circumvent this drawback by writing a template file which will be used to generate a new module file whenever a new product version is released.<br/>Meta-modules (modules that load other modules) are acceptable for quick loading. The drawback is that all their sub-modules have to be unloaded individually.<br/>You can take the meta-module <code>snps/fn</code> and all its sub-modules as an example.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ cat snps/fn 
module load snps/vcs/vR-2020.12
module load snps/vip/vT-2022.09
module load snps/verdi/vR-2020.12
module load snps/syn/vR-2020.09-SP1
module load snps/lc/vR-2020.09-SP5
module load snps/spyglass/vQ-2020.03-SP1-1
module load snps/lic/eng</pre>
</div></div><p>This way, any change to the engineering licences for example will be applied to everyone loading the <code>snps/lic/eng</code> module.</p><p>If this paradigm is unacceptable to you, you should come back to target-specific code, i.e. shell/language, and lose the compatibility feature.</p><h3 id="Environmentmodules-Product-driven">Product-driven</h3><p>Write meta-module for a product, rather than just list a tool’s versions. Users are interested in using a meta-module that is compatible with a product (e.g. I want to run Synopsys tools for FlexNoC or Ncore) rather than a specific tool’s version (I’ll run Synopsys 2023.03 that <strong>should</strong> be compatible with Ncore?).</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module load snps/fn
$ module load snps/ncore</pre>
</div></div><p>If you would like to test new versions of a tool, either switch to a specific submodule</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module load snps/fn
$ module switch snps/vcs/vU-2023.03</pre>
</div></div><p>or write a temporary meta-module that will become the default when it’s validated</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module load snps/fn_2023</pre>
</div></div><h3 id="Environmentmodules-Licenses">Licenses</h3><p>License variables should be set in separate module files so as not to have them duplicated in every product module for a given vendor.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module avail snps/lic
------------- /engr/dev/tools/modules -----------------
snps/lic/ae  snps/lic/eng</pre>
</div></div><h3 id="Environmentmodules-procModulesHelp">proc ModulesHelp</h3><p>Use this procedure to display the message invoked by <code>module help</code></p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">proc ModulesHelp { } {
  puts stderr &quot;This modulefile defines the library and include paths needed to use the Synopsys products for the FlexNoC project.&quot;
}</pre>
</div></div><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">$ module help snps/fn

----------- Module Specific Help for &#39;snps/fn&#39; --------------------

This modulefile defines the library and include paths needed to use the Synopsys products for the FlexNoC project.</pre>
</div></div><h3 id="Environmentmodules-module-whatis">module-whatis</h3><p>Define the message invoked by <code>module whatis</code></p><h3 id="Environmentmodules-conflict">conflict</h3><p>Issue a conflict error when trying to load the given module while the current module is loaded.<br/>When written for itself, prevent to load the same module twice.<br/>When written for another module file, prevents incompatibility between modules (e.g. <code>cdns</code> has <code>conflict snps</code> and <code>snps</code> has <code>conflict cdns</code> because <code>cdns</code> and <code>snps</code> are both setting the <code>UVM_HOME</code> variable.</p><h3 id="Environmentmodules-set">set</h3><p>The set command lets you define a Tcl local variable to be used all throughout your module file. Use them when you use the same content several times in the same file.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">set vcsver   &quot;vR-2020.12&quot;
set snps_dir &quot;/engr/dev/tools/synopsys&quot;
set vcs_home &quot;${snps_dir}/vcs_${vcsver}&quot;</pre>
</div></div><h3 id="Environmentmodules-setenv">setenv</h3><p>Export the given variable.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">setenv VCS_HOME /engr/dev/tools/synopsys/vcs_vR-2020.12-SP1</pre>
</div></div><h3 id="Environmentmodules-prepend-path">prepend-path</h3><p>Add the given location to the beginning of the given path-style (colon-separated) environment variable (usually the system or a licence paths).</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">prepend-path PATH &quot;${vcs_home}/bin&quot;</pre>
</div></div><h3 id="Environmentmodules-append-path">append-path</h3><p>Add the given location to the end of the given path-style (colon-separated) environment variable (usually the system or a licence paths).</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">append-path SNPSLMD_LICENSE_FILE &quot;27001@lic02.arteris.com&quot;</pre>
</div></div><p><br/></p>