<p class="auto-cursor-target"><strong>History:</strong></p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Date</th><th class="confluenceTh">Comments</th><th class="confluenceTh">Editor</th></tr><tr><td class="confluenceTd"><div class="content-wrapper"><p><time datetime="2021-01-21" class="date-past">21 Jan 2021</time> </p></div></td><td class="confluenceTd"><ul><li>Initial Testplan</li></ul></td><td class="confluenceTd">Santosh Ramu</td></tr><tr><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td></tr></tbody></table></div><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><br/></th><th class="confluenceTh">Reference</th><th class="confluenceTh">Comments</th></tr><tr><td class="confluenceTd">1</td><td class="confluenceTd"><p class="with-breadcrumbs"><a class="external-link" href="https://confluence.arteris.com/pages/viewpage.action?pageId=23038784" rel="nofollow" style="text-decoration: none;">Performance Monitoring (PMON)</a></p></td><td class="confluenceTd">Design document</td></tr><tr><td colspan="1" class="confluenceTd">2</td><td colspan="1" class="confluenceTd"><p class="with-breadcrumbs"><a class="external-link" href="https://confluence.arteris.com/display/ENGR/Common+Transaction+Layer+Microarchitecture+Specification" rel="nofollow" style="text-decoration: none;">Common Transaction Layer Microarchitecture Specification</a></p></td><td colspan="1" class="confluenceTd"><p>QoS to Packet Field Mappings documentation</p></td></tr></tbody></table></div><h2 id="NativeLayerPMONTestPlan(PMONintegratedintoATU):-PMONPlanforR1:">PMON Plan for R1:</h2><div class="table-wrap"><table class="wrapped relative-table confluenceTable" style="width: 99.9624%;"><colgroup><col style="width: 1.35542%;"/><col style="width: 24.0964%;"/><col style="width: 4.48795%;"/><col style="width: 2.53012%;"/><col style="width: 26.1747%;"/><col style="width: 18.4036%;"/><col style="width: 2.31928%;"/><col style="width: 4.09639%;"/><col style="width: 16.4157%;"/></colgroup><tbody><tr><th class="confluenceTh"><br/></th><th class="confluenceTh">Feature</th><th class="confluenceTh">Configurations</th><th class="confluenceTh">Testlist</th><th class="confluenceTh">Stimulus</th><th class="confluenceTh">Checking</th><th class="confluenceTh">Status</th><th class="confluenceTh">JIRA</th><th class="confluenceTh">Comments</th></tr><tr><td colspan="1" class="confluenceTd">1</td><td colspan="1" class="confluenceTd">Register bit bash</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">uvm_reg_bit_bash_seq</td><td colspan="1" class="confluenceTd">Automatic</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td></tr><tr><td colspan="1" class="confluenceTd">2</td><td colspan="1" class="confluenceTd">Add bronze, silver, gold related configs with PMON enabled</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Bronze: Able to read/write registers (bit bash)<br/>Silver: Interested to check here in cross with topologies.</td></tr><tr><td class="confluenceTd">3</td><td class="confluenceTd">Bandwidth Measurement</td><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><div class="content-wrapper"><p>After simulation comes out of reset repeat following steps till all ATUs in given configuration have been tested:</p><ol><li>Randomly select 1 among multiple ATUs with rtl.json parameter pmonStatsEn (socket parameter) set to 1.</li><li><p class="auto-cursor-target">Randomly select 1 among multiple &quot;Bandwidth Events&quot; to be measured or create multiple tests for each bandwidth events. <br/>Coverage: Cross of ATUs with pmonStatsEn = 1 and Bandwidth Events.</p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><th class="confluenceTh"><br/></th><th class="confluenceTh">Bandwidth Events</th><th colspan="1" class="confluenceTh">Signals monitored by design</th></tr><tr><td class="confluenceTd">1</td><td class="confluenceTd"><span class="legacy-color-text-blue3">Measures utilization on CTL_REQ channel</span></td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">valid &amp; ready on CTL_REQ channel</span></td></tr><tr><td class="confluenceTd">2</td><td class="confluenceTd"><span class="legacy-color-text-blue3">Measures backpressure on CTL_REQ channel</span></td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">valid &amp; ~ready on CTL_REQ channel</span></td></tr><tr><td class="confluenceTd">3</td><td class="confluenceTd"><span class="legacy-color-text-blue3">Measures utilization on AXI_AW channel</span></td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">valid &amp; ready on AXI_AW channel</span></td></tr><tr><td colspan="1" class="confluenceTd">4</td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">Measures backpressure on AXI_AW channel</span></td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">valid &amp; ~ready on AXI_AW channel</span></td></tr><tr><td colspan="1" class="confluenceTd">5</td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">Measures utilization on AXI_AR channel</span></td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">valid &amp; ready on AXI_AR channel</span></td></tr><tr><td colspan="1" class="confluenceTd">6</td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">Measures backpressure on AXI_AR channel</span></td><td colspan="1" class="confluenceTd"><span class="legacy-color-text-blue3">valid &amp; ~ready on AXI_AR channel</span></td></tr></tbody></table></div></li><li>Using register programming steps provided in <a class="external-link" href="https://confluence.arteris.com/pages/viewpage.action?pageId=23038784" rel="nofollow" style="text-decoration: none;">Performance Monitoring (PMON)</a>, program ATU registers for Bandwidth measurement using RAL flow using CSR.</li><li>Send constrained random regular traffic stimulus. Note: During RAL programming stop the regular traffic on RAL accessible initiator only, rest of the design must continue to send regular traffic.</li><li>Wait for Interrupt routine. </li><li>Jump to step 1 till all ATUs are exhausted.</li><li>Verify start-stop (need to be verified for all timers), limit, mode, reset.</li><li><p class="auto-cursor-target">Enhancement1: Programming multiple ATU PMON registers without waiting for Interrupts. </p></li></ol></div></td><td class="confluenceTd"><ol><li>Verify interrupt generated is from expected ATU PMON.</li><li><span class="legacy-color-text-blue3">If there is outstanding interrupt at end of sim, trigger an error.</span></li><li><span class="legacy-color-text-blue3">Need to decide how accurate checks will be.</span></li><li><span class="legacy-color-text-blue3">Check if bandwidth values read from BW_val register through RAL flow using CSR falls in an acceptable range of predicted value.</span></li><li><span class="legacy-color-text-blue3">No. of PMON programmings performed == No. of interrupts generated.</span></li></ol></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-4783" rel="nofollow" style="text-decoration: none;text-align: left;">SYM-4783</a></td><td class="confluenceTd"><p>Action Items:</p><ol><li>Sync-up with Junie regarding bandwidth measurement numbers generated matches expectations from Architecture.</li><li>What all configurations need to be brought up needs to be defined after sync-up with Junie. Currently we have 4x4 but do we need specialized configurations?</li></ol><p>Is it expected that customers are expected to have PMON enabled in all or none or ATUs? No it's not all or none. Some ATUs will have PMON enabled and so won't</p></td></tr><tr><td class="confluenceTd">4</td><td class="confluenceTd">Latency Binning</td><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><p>After simulation comes out of reset repeat following steps till all ATUs in given configuration have been tested in the test:</p><ol><li>Randomly select 1 among multiple ATUs with parameter pmonStatsEn set to 1.</li><li>Constraint randomly select values for Bin Bound registers.<br/>Constraints.<br/><ol><li>0 &lt; Bin Bound 0 &lt; Bin Bound 1 &lt; Bin Bound 2 &lt;= Max value Bin Bound 2 can have (Do we need to test what happens if we remove this contraint? Will it break design? Darshan: Bin counters will get disabled).</li><li>Constraint Bin Bound register values, free run counter limit and TB slave delay, send 1 transaction to compare Bin_*_val predicted latency value read.</li></ol></li><li>Using register programming steps provided in <a class="external-link" href="https://confluence.arteris.com/pages/viewpage.action?pageId=23038784" rel="nofollow" style="text-decoration: none;">Performance Monitoring (PMON)</a>, program ATU registers for Bandwidth measurement using RAL flow using CSR.</li><li>Send constrained random regular traffic stimulus. Note: During RAL programming stop the regular traffic on RAL accessible initiator only, rest of the design must continue to send regular traffic.</li><li>Wait for Interrupt routine. </li><li>Jump to step 1 till all ATUs are exhausted.</li><li>Verify all timer start-stop, limit, mode, reset.</li></ol></td><td class="confluenceTd"><ol><li>Check interrupt generated is from expected ATU PMON.</li><li><span class="legacy-color-text-blue3">If there is outstanding interrupt at end of sim, trigger an error.</span><span class="legacy-color-text-blue3"><br/></span></li><li><span class="legacy-color-text-blue3">Need to decide how accurate checks will be.</span></li></ol></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-4783" rel="nofollow" style="text-decoration: none;text-align: left;">SYM-4783</a></td><td class="confluenceTd"><p>Action Items:</p><ol><li>What all configurations need to be brought up needs to be defined after sync-up with Junie. Currently we have 4x4 but do we need specialized configurations?</li></ol></td></tr><tr><td class="confluenceTd">5</td><td class="confluenceTd">Pressure event generation</td><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><div class="content-wrapper"><ol><li>We need to test with aggressive random stimulus to make sure that system won't hang due to pressure event generation.</li><li>Present only in ATUI AXI.</li><li>Need better understanding of it, <a class="confluence-userlink user-mention" data-account-id="624b36eb45ece00069cca831" href="https://arterisip.atlassian.net/wiki/people/624b36eb45ece00069cca831?ref=confluence" target="_blank" data-linked-resource-id="786785" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Kavish Shah</a> please work with <a class="confluence-userlink user-mention" data-account-id="624b3798699649006ae98ff8" href="https://arterisip.atlassian.net/wiki/people/624b3798699649006ae98ff8?ref=confluence" target="_blank" data-linked-resource-id="756836" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Darshan Alagud</a>on this. </li></ol></div></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td><td class="confluenceTd"><p><a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-4784" rel="nofollow" style="text-decoration: none;text-align: left;">SYM-4784</a></p><p><a class="external-link" href="https://arterisip.atlassian.net/browse/SYM-4783" rel="nofollow" style="text-decoration: none;text-align: left;">SYM-4783</a></p></td><td class="confluenceTd"><br/></td></tr><tr><td colspan="1" class="confluenceTd">6</td><td colspan="1" class="confluenceTd">Random selection of features</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><p>After simulation comes out of reset repeat following steps till all ATUs in given configuration have been tested in the test:</p><ol><li>Randomly select 1 among the above multiple ATUs with parameter pmonStatsEn set to 1.</li><li>Randomly select 1 among multiple features (Bandwidth measurement, latency binning and Pressure event generation).</li><li>Based on event selected perform set-up steps provided above.</li><li>Cross PMON events with other features like firewall.</li></ol></td><td colspan="1" class="confluenceTd"><ol><li>Check interrupt generated is from expected ATU PMON.</li><li><span class="legacy-color-text-blue3">If there is outstanding interrupt at end of sim, trigger an error.</span><span class="legacy-color-text-blue3"><br/></span></li><li><span class="legacy-color-text-blue3">Need to decide how accurate checks will be.</span></li></ol></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><p>Action Items:</p><ol><li>Define which all features we need to cross with PMON. Eg: Firewall, splitting, striping.</li></ol></td></tr><tr><td colspan="1" class="confluenceTd">7</td><td colspan="1" class="confluenceTd">Configurations with PMON enabled, Interrupt disabled and send transactions with aggressive random stimulus to see if test generates interrupt.</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Modify RAL programming to disable Interrupt generation but enable rest of the above features</td><td colspan="1" class="confluenceTd"><ol><li>Fire error if Interrupt is observed.</li><li><span class="legacy-color-text-blue3">If there is outstanding interrupt at end of sim, trigger an error.</span></li><li><span class="legacy-color-text-blue3">Need to decide how accurate checks will be.</span></li></ol></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td></tr><tr><td colspan="1" class="confluenceTd">8</td><td colspan="1" class="confluenceTd">Programming multiple ATU PMON simultaneously instead of sequentially. </td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">Constraint stimulus to cross ATU selected, feature selected.</td><td colspan="1" class="confluenceTd"><ol><li>Verify interrupt generated is from expected ATU PMON.</li><li><span class="legacy-color-text-blue3">Need to decide how accurate checks will be.</span></li></ol></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td></tr><tr><td colspan="1" class="confluenceTd">9</td><td colspan="1" class="confluenceTd">Timers and counters limit conditions, smallest, largest value including roll-over conditions</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><ol><li>Can we use backdoor access to counters? So that we can set counter values close to edge condition and test rollover conditions.</li><li>This is the only way to fully test large sized Eg: 32 bit counters.</li><li>Global timer is 64 bit register split into 2 32 bit registers for reading and writing purposes.</li></ol></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><p>Action Items:</p><ol><li>There are some R0 registers, in order to test boundary conditions we need to test roll over values for those registers too. <br/>A. RTL providing option to set values close to boundary values, have a mode to be able to write to read only registers.<br/>B. DV able to force/put value into these registers.<br/>C. Consider changing them to RW registers. Junie is ok with this.</li></ol></td></tr><tr><td colspan="1" class="confluenceTd">10</td><td colspan="1" class="confluenceTd">Behavior of PMON registers after coming out of reset?</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><ol><li>PMON registers don't have value retention.</li></ol></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td></tr><tr><td colspan="1" class="confluenceTd">11</td><td colspan="1" class="confluenceTd">In context we have ability to mask events to given target from ATUI.</td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><ol><li>Enable target ID mask (select) for stats in CTL block.</li><li>write in target ID of selected target in CTL block.</li><li>Perform PMON setup in same ATUI that we perform above CTL setup. </li></ol></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd"><br/></td><td colspan="1" class="confluenceTd">should it be verified for R1? Sync-up with Eric and Junie for more details.</td></tr></tbody></table></div>