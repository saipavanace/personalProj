<p> </p><p><strong>Topology:</strong></p><p> </p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16171536/image2020-1-20%2017:20:24.png?api=v2"></span></p><p> </p><h4 id="FirewallAdapterTestplan(Nativelayerlevel)-Designgeneration">Design generation</h4><p>Follow the steps to generate design JSON files and RTL here:</p><p><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171949/AXI+Single-Switch+NXM+configuration+with+Firewall+adapters" data-linked-resource-id="16171949" data-linked-resource-version="3" data-linked-resource-type="page">AXI Single-Switch NXM configuration with Firewall adapters</a></p><p> </p><p><strong>UVM Verification Architecture Description:</strong></p><p><strong>Sequences:  </strong> :</p><ol><li> APB sequence:   Randomly enables or disables the firewall by driving values in the firewall RTL enable-register via APB agent.</li><li> GEN sequence:  Randomly sets the value of gen_in to be used by UDV for comparison and drives values via Generic IO agent.</li><li> AXI sequence:   Randomly generates a sequence of different AXI transactions( valid, invalid, poisoned) and drives packets via AXI master agent.</li></ol><p>      The firewall virtual sequence drives the above basic sequences in parallel.</p><p><strong>Agents:</strong>   The agents drive/monitor a particular sequence-item to corresponding RTL interface signals. All the agents send the driven/monitored packet to scoreboard via analysis ports. </p><p><strong>Scoreboard: </strong>  Collects the driven and received sequence-items from all the agents via analysis ports.</p><p>                        Implements the checkers listed in the testplan. Also does the end of check test.</p><p> </p><p><strong>UDV Description: </strong></p><ol><li>Use a function of AXI address field  to trigger poison.</li><li>Use a function of H-Prot to trigger poison.<br/><br/></li></ol><p><strong>Plan :</strong></p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner"> </div></th><th class="confluenceTh"><div class="tablesorter-header-inner">Feature</div></th><th colspan="1" class="confluenceTh"><div class="tablesorter-header-inner">Priority</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">Parameter with ranges</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">Stimulus</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">Checking</div></th><th colspan="1" class="confluenceTh"><div class="tablesorter-header-inner">Timeline</div></th><th colspan="1" class="confluenceTh"><div class="tablesorter-header-inner">Status</div></th></tr></thead><tbody><tr><td class="confluenceTd">1</td><td class="confluenceTd">Interrupt generation for erroneous packet with input H_poison field=0</td><td colspan="1" class="confluenceTd"> Presto 1.0</td><td class="confluenceTd"><span>UDV ATP packet fields</span>, H_poison</td><td class="confluenceTd"><p>Directed test<br/>Constrained random stimulus generated with H_pr=7, H_poison=0</p></td><td class="confluenceTd"><p>Interrupt generated.<br/>RTL flips H_poison from 0 to 1 for invalid input packets</p></td><td colspan="1" class="confluenceTd"><p> </p></td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">2</td><td class="confluenceTd">Interrupt generation for erroneous  packet with input H_poison field=1</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td class="confluenceTd"><span>UDV ATP packet fields</span>, H_poison</td><td class="confluenceTd"><p>Directed test<br/>Constrained random stimulus generated with H_pr=7, H_poison=1</p></td><td class="confluenceTd"><p>Interrupt generated for invalid input packets.<br/>H_poison is preserved 1 for all packets</p></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">3</td><td class="confluenceTd">Interrupt generation for random packets</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td class="confluenceTd"><span>UDV ATP packet fields</span>,H_poison</td><td class="confluenceTd"><p>Random stimulus generated</p></td><td class="confluenceTd">Interrupt generated only for erroneous packets.  H_poison preserved for poison input packets</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">4</td><td colspan="1" class="confluenceTd">Disable firewall</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd"><p>APB,UDV ATP packet fields, H_poison</p></td><td colspan="1" class="confluenceTd"><p>Enable and disable firewall register via APB configuration,</p><p>Invalid packets generated</p></td><td colspan="1" class="confluenceTd">If the 1-bit register is enabled the firewall should check for the violation, inject and report error otherwise the packet should be transferred across as it is</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">5</td><td colspan="1" class="confluenceTd">RAL Integration</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd">APB</td><td colspan="1" class="confluenceTd">Write and read registers inside the firewall via RAL flow</td><td colspan="1" class="confluenceTd">Check that the enable register is accessible through RAL flow</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">6</td><td colspan="1" class="confluenceTd">Generic IO interface</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><p>Give input to the generic IO interface which is to be compared against the UDV field values,</p><p>Normal and invalid ATP packets generated</p></td><td colspan="1" class="confluenceTd">The output of the generic IO interface should be the same as the input to the generic IO interface. If the comparison between the input to the generic IO interface and the UDV fields fail then an interrupt should be generated, the error status should be reflected in the corresponding output AXI packet</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">7</td><td colspan="1" class="confluenceTd">Reset recovery</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd">All valid parameters</td><td colspan="1" class="confluenceTd">Give on the fly reset when the firewall is actively processing ATP packets</td><td colspan="1" class="confluenceTd">After the firewall goes into reset the internal registers should be set to default values, the previous AXI transfers should be aborted and after-reset AXI transfers should happen as in normal case</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">8</td><td colspan="1" class="confluenceTd">Backpressure</td><td colspan="1" class="confluenceTd"><p><span>After Presto 1.0</span> </p><p> </p></td><td colspan="1" class="confluenceTd"><p>addStage,</p><p>udvLatency</p></td><td colspan="1" class="confluenceTd">Drive the out_ready signal low for a large duration of time and then release it</td><td colspan="1" class="confluenceTd">Once the out_ready is driven low, after some time the in_ready should also become low and the firewall should not accept more input ATP packets. After the out_ready is released the firewall should function in a normal way</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">9</td><td colspan="1" class="confluenceTd">UDV latency</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd">udvLatency</td><td colspan="1" class="confluenceTd">Set different values for udv latency and send random ATP packets</td><td colspan="1" class="confluenceTd">Check that the output AXI packet comes after a certain time range starting from when the input AXI packet is given. The time range should be based on the udvLatency configured.</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">10</td><td colspan="1" class="confluenceTd">Protection mechanism</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">11</td><td colspan="1" class="confluenceTd">Back to back transfers</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd">All valid parameters</td><td colspan="1" class="confluenceTd">Generate random stimulus with minimum inter transfer gap</td><td colspan="1" class="confluenceTd"><p>Ensure that the poisoned packet doesn't reach the intended native layer of the target.</p><p>CTL T gives erroneous response back to the initiator</p></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">12</td><td colspan="1" class="confluenceTd">Fully random stimulus</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd">All valid parameters</td><td colspan="1" class="confluenceTd">Generate fully random stimulus covering all the features, mixed packets, random interpacket delay, random input signaling</td><td colspan="1" class="confluenceTd"><p>Ensure that the poisoned packet doesn't reach the intended native layer of the target.</p><p>CTL T gives erroneous response back to the initiator</p></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">13</td><td colspan="1" class="confluenceTd">Performance</td><td colspan="1" class="confluenceTd"> <span>Presto 1.0</span></td><td colspan="1" class="confluenceTd">All valid parameters</td><td colspan="1" class="confluenceTd">Random stimulus generated</td><td colspan="1" class="confluenceTd">Ensure that the overall firewall transfers do not take unreasonable time based on theoretical estimations. The firewall should not be a bottleneck in the system</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">14</td><td colspan="1" class="confluenceTd">more than one virtual channel</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span> </td><td colspan="1" class="confluenceTd">nVc &gt; 1</td><td colspan="1" class="confluenceTd">Random stimulus generated</td><td colspan="1" class="confluenceTd">Ensure firewall functionality for all the virtual channels</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">15</td><td colspan="1" class="confluenceTd">Firewall with striping enabled</td><td colspan="1" class="confluenceTd"><span>Presto 1.0</span><span> </span></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">Generate random stimulus with striping enabled</td><td colspan="1" class="confluenceTd"><p>Ensure all expected packets are poisoned.</p><p>Ensure that the poisoned packet doesn't reach the intended native layer of the target.</p><p>CTL T gives erroneous response back to the initiator</p></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">15</td><td colspan="1" class="confluenceTd">Firewall with spliting enabled</td><td colspan="1" class="confluenceTd">Presto 1.0 </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">Generate random stimulus with splitting enabled</td><td colspan="1" class="confluenceTd"><p>Ensure all expected packets are poisoned.</p><p>Ensure that the poisoned packet doesn't reach the intended native layer of the target.</p><p>CTL T gives erroneous response back to the initiator</p></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">16</td><td colspan="1" class="confluenceTd">Firewall with multicast adapter</td><td colspan="1" class="confluenceTd">Presto 1.0 </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"><span>Random stimulus generated</span></td><td colspan="1" class="confluenceTd"><p>Ensure all expected packets are poisoned.</p><p>Ensure that the poisoned packet doesn't reach the intended native layer of the target.</p><p>CTL T gives erroneous response back to the initiator</p></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr><tr><td colspan="1" class="confluenceTd">17</td><td colspan="1" class="confluenceTd">All different error responses</td><td colspan="1" class="confluenceTd"><span>Presto 1.0 </span></td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd">Create stimulus for generating all possible types of error responses from CTL T</td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td><td colspan="1" class="confluenceTd"> </td></tr></tbody></table></div>