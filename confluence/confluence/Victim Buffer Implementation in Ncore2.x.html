<p> </p><p> </p><p><strong>From:</strong> Abhinav Nippuleti &lt;<a class="external-link" href="mailto:abhinav.nippuleti@arteris.com" rel="nofollow">abhinav.nippuleti@arteris.com</a>&gt; <br/> <strong>Sent:</strong> Saturday, June 8, 2019 7:41 PM<br/> <strong>To:</strong> Robin Sik &lt;<a class="external-link" href="mailto:Robin.Sik@arteris.com" rel="nofollow">Robin.Sik@arteris.com</a>&gt;; Mohammed Khaleeluddin &lt;<a class="external-link" href="mailto:mohammed.khaleeluddin@arteris.com" rel="nofollow">mohammed.khaleeluddin@arteris.com</a>&gt;; Boon Chuan &lt;<a class="external-link" href="mailto:boon.chuan@arteris.com" rel="nofollow">boon.chuan@arteris.com</a>&gt;; Satya Prakash &lt;<a class="external-link" href="mailto:satya.prakash@arteris.com" rel="nofollow">satya.prakash@arteris.com</a>&gt;; David Clarino &lt;<a class="external-link" href="mailto:david.clarino@arteris.com" rel="nofollow">david.clarino@arteris.com</a>&gt;; Khaled Labib &lt;<a class="external-link" href="mailto:Khaled.Labib@arteris.com" rel="nofollow">Khaled.Labib@arteris.com</a>&gt;<br/> <strong>Subject:</strong> RE: Victim buffer Implementation in Ncore2.x</p><p> </p><p>Hi Robin,</p><p>Below are the 4 different interesting scenarios with Victim buffer.</p><p>Along with coverage results below are the time stamps when the scenarios are hit.</p><p> </p><p>Scenario 1: Update Invalidate hitting tag filter</p><ul><li>If it is a hit in tag filter and the agent that issued the request is the only agent that has the cache line in Owned or shared state, then that set/way is invalidated and if a matching set index exists in victim buffer, the oldest entry is picked and moved to tag filter (to same way). Scenario for VB compression happens.</li><li>Happens at 354280 ns, entry in victim buffer[4] is compressed addr: 0x64880d240 is moved to set index: 0x80d way: 2.</li><li>/scratch3/anippuleti/ws/nan1_v2.6/hw/debug/dce/config2/run/dce_unit_test</li></ul><p> </p><p>Scenario 2: Update Invalidate hitting victim buffer</p><ul><li>If it is a hit in victim buffer and the agent that issued the request is the only agent that has the cache line in Owned or shared state. Scenario for VB compression.</li><li>Happens at 346010 ns, entry in victim buffer[2] address: 0x711bb240 is compressed on updated request from cacheID: 2 agentID: 7</li><li>/scratch3/anippuleti/ws/nan1_v2.6/hw/debug/dce/config2/run/dce_unit_test_1_197_undefined</li></ul><p> </p><p>Scenario 3: Any other command excluding Update invalidate hitting in victim buffer</p><ul><li>If it is a hit in victim buffer, then an entry that is not busy in ATT is picked (random entry) to swap with victim buffer entry.</li></ul><ul><li>Happens at 356380 ns, entry in victim buffer[2] addr: 0x6a080d7c0 is swapped with addr: 0x7080d2c0 set index: 0x80d way: 20. Scenario for Swap between VB and Tag Filter.</li><li>/scratch3/anippuleti/ws/nan1_v2.6/hw/debug/dce/config2/run/dce_unit_test</li></ul><p> </p><p>Scenario 4: Any tag filter allocating miss command that causes push and pop of victim buffer on same cycle.</p><ul><li>If it is a miss in tag filter and victim buffer and all ways are valid in TF and VB is full, then a random entry that is not active in ATT is pushed to bottom of VB and top most entry of victim buffer is recalled on same cycle.</li><li>Happens at 335810 ns, TF entry set index: 0x3fc6 way: 11 address: 0x43fc6f40 is pushed to VB and address: 0x44bfc6400 is recalled.</li><li>/scratch3/anippuleti/ws/nan1_v2.6/hw/debug/dce/config2/run/dce_unit_test</li></ul><p> </p><p>Thank you,</p><p>Abhinav</p>