<p>The top uses a template named ringSMI_Nring.json.template. It maps the I/O ports in ringATP_Nring.json.template has follows</p><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner">in SMI</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">in ATP</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">out SMI</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">out ATP</div></th></tr></thead><tbody><tr><td class="confluenceTd">smi_I0_</td><td class="confluenceTd">p0_i_</td><td class="confluenceTd">smi_Z0_</td><td class="confluenceTd"><span>p0_o_</span></td></tr><tr><td class="confluenceTd">smi_I1_</td><td class="confluenceTd"><span>p1_i_</span></td><td class="confluenceTd">smi_Z1_</td><td class="confluenceTd"><span>p1_o_</span></td></tr><tr><td class="confluenceTd">smi_I2_</td><td class="confluenceTd"><span>p2_i_</span></td><td class="confluenceTd">smi_Z2_</td><td class="confluenceTd"><span>p2_o_</span></td></tr><tr><td class="confluenceTd">smi_I3_</td><td class="confluenceTd"><span>p3_i_</span></td><td class="confluenceTd">smi_Z3_</td><td class="confluenceTd"><span>p3_o_</span></td></tr><tr><td class="confluenceTd">smi_I4_</td><td class="confluenceTd"><span>p4_i_</span></td><td class="confluenceTd">smi_Z4_</td><td class="confluenceTd"><span>p4_o_</span></td></tr><tr><td class="confluenceTd">smi_I5_</td><td class="confluenceTd"><span>p5_i_</span></td><td class="confluenceTd">smi_Z5_</td><td class="confluenceTd"><span>p5_o_</span></td></tr><tr><td class="confluenceTd">smi_I6_</td><td class="confluenceTd"><span>p6_i_</span></td><td class="confluenceTd">smi_Z6_</td><td class="confluenceTd"><span>p6_o_</span></td></tr><tr><td class="confluenceTd">smi_I7_</td><td class="confluenceTd"><span>p7_i_</span></td><td class="confluenceTd">smi_Z7_</td><td class="confluenceTd"><span>p7_o_</span></td></tr><tr><td class="confluenceTd">smi_I8_</td><td class="confluenceTd"><span>p8_i_</span></td><td class="confluenceTd">smi_Z8_</td><td class="confluenceTd"><span>p8_o_</span></td></tr><tr><td class="confluenceTd">smi_I9_</td><td class="confluenceTd"><span>p9_i_</span></td><td class="confluenceTd">smi_Z9_</td><td class="confluenceTd"><span>p9_o_</span></td></tr><tr><td class="confluenceTd">smi_I10_</td><td class="confluenceTd"><span>p10_i_</span></td><td class="confluenceTd">smi_Z10_</td><td class="confluenceTd"><span>p10_o_</span></td></tr><tr><td class="confluenceTd">smi_I11_</td><td class="confluenceTd"><span>p11_i_</span></td><td class="confluenceTd">smi_Z11_</td><td class="confluenceTd"><span>p11_o_</span></td></tr><tr><td class="confluenceTd">smi_I12_</td><td class="confluenceTd"><span>p12_i_</span></td><td class="confluenceTd">smi_Z12_</td><td class="confluenceTd"><span>p12_o_</span></td></tr><tr><td class="confluenceTd">smi_I13_</td><td class="confluenceTd"><span>p13_i_</span></td><td class="confluenceTd">smi_Z13_</td><td class="confluenceTd"><span>p13_o_</span></td></tr><tr><td class="confluenceTd">smi_I14_</td><td class="confluenceTd"><span>p14_i_</span></td><td class="confluenceTd">smi_Z14_</td><td class="confluenceTd"><span>p14_o_</span></td></tr><tr><td colspan="1" class="confluenceTd">smi_I15_</td><td colspan="1" class="confluenceTd"><span>p15_i_</span></td><td colspan="1" class="confluenceTd">smi_Z15_</td><td colspan="1" class="confluenceTd"><span>p15_o_</span></td></tr></tbody></table></div><p>The following figure shows the topology implemented in ringATP_Nring.json.template.</p><h1 id="SymphonyNring(16)-Theringhasthefollowingtopology">The ring has the following topology</h1><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="https://arterisip.atlassian.net/wiki/download/attachments/16158885/veriph_Nring.svg?api=v2"></span></p><p>The ports have the following meaning</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd">p</td><td class="confluenceTd">Local ATP ports of Node</td></tr><tr><td class="confluenceTd">pl</td><td class="confluenceTd">Primary Link Left</td></tr><tr><td class="confluenceTd">pr</td><td class="confluenceTd">Primary Link Right</td></tr><tr><td class="confluenceTd">sl</td><td class="confluenceTd">Secondary Link Left</td></tr><tr><td class="confluenceTd">sr</td><td class="confluenceTd">Secondary Link Right</td></tr></tbody></table></div><p>Each Node (N0 - N15) have the following topology</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16158885/veriph_Nring_node.svg?api=v2"></span></p><h1 id="SymphonyNring(16)-IDtoPortMapping">ID to Port Mapping</h1><div class="table-wrap"><table class="confluenceTable"><thead><tr><th class="confluenceTh"><div class="tablesorter-header-inner">Port</div></th><th class="confluenceTh"><div class="tablesorter-header-inner">ID</div></th></tr></thead><tbody><tr><td class="confluenceTd"><p>0</p></td><td class="confluenceTd"><pre>10'd0</pre></td></tr><tr><td class="confluenceTd"><p>1</p></td><td class="confluenceTd"><pre>10'd1</pre></td></tr><tr><td class="confluenceTd"><p>2</p></td><td class="confluenceTd"><pre>10'd2</pre></td></tr><tr><td class="confluenceTd"><p>3</p></td><td class="confluenceTd"><pre>10'd3</pre></td></tr><tr><td class="confluenceTd"><p>4</p></td><td class="confluenceTd"><pre>10'd4</pre></td></tr><tr><td class="confluenceTd"><p>5</p></td><td class="confluenceTd"><pre>10'd5</pre></td></tr><tr><td class="confluenceTd"><p>6</p></td><td class="confluenceTd"><pre>10'd6</pre></td></tr><tr><td class="confluenceTd"><p>7</p></td><td class="confluenceTd"><pre>10'd7</pre></td></tr><tr><td class="confluenceTd"><p>8</p></td><td class="confluenceTd"><pre>10'd8</pre></td></tr><tr><td class="confluenceTd"><p>9</p></td><td class="confluenceTd"><pre>10'd9</pre></td></tr><tr><td class="confluenceTd"><p>10</p></td><td class="confluenceTd"><pre>10'd10</pre></td></tr><tr><td class="confluenceTd"><p>11</p></td><td class="confluenceTd"><pre>10'd11</pre></td></tr><tr><td class="confluenceTd"><p>12</p></td><td class="confluenceTd"><pre>10'd12</pre></td></tr><tr><td class="confluenceTd"><p>13</p></td><td class="confluenceTd"><pre>10'd13</pre></td></tr><tr><td class="confluenceTd"><p>14</p></td><td class="confluenceTd"><pre>10'd14</pre></td></tr><tr><td class="confluenceTd"><p>15</p></td><td class="confluenceTd"><pre>10'd15</pre></td></tr></tbody></table></div><h1 id="SymphonyNring(16)-TogenerateaNodering,Createaregressionarea.">To generate a Node ring, Create a regression area.</h1><pre>mkdir {fill_in_directory_name_here}<br/>cd {directory_name}<br/>/engr/dev/tools/script/setup_sym -d master<br/>source SOURCEME.tcsh <br/>(for bash: source SOURCEME.bash)</pre><h1 id="SymphonyNring(16)-CDtoNmesharea">CD to Nmesh area</h1><p>cd $WORK_TOP/tb/top/Nring</p><h1 id="SymphonyNring(16)-CreateanJSONfilethat&#39;sconfiguredforthenetworkyouaretryingtocreate.">Create an JSON file that's configured for the network you are trying to create.</h1><p>An example exist in the directory called BasePketParamsExpl.json</p><p>The route width must be 30</p><p>The width of H_pri must be 3.</p><p>The width of steer in SMI must be 3. The width of H_steer must be 0.</p><p>The IDs are hardcoded to width of 10 This first 5 are the Y in the mesh and the last 5 are the X in the mesh. The instanced name is u_swY_X in above figures. </p><p>Number of VCs must be 1 ($4 of create_Nring.sh)</p><h1 id="SymphonyNring(16)-Runcreate_Nring.shscripttogenerateyournetwork">Run create_Nring.sh script to generate your network</h1><p>The script includes usage:</p><pre>[jcodd@mondavi Nring]$ ./create_Nring.sh<br/>ERROR: ./create_Nring.sh Not enough arguments<br/>USAGE: ./create_Nring.sh $1 $2 $3 $4 $5<br/> $1 = JSON file to base backet parameters<br/> $2 = target data width<br/> $3 = packet type (parallel, serial or fixed)<br/> $4 = number of VCs<br/> $5 = arbType for all switch arbs<br/> $6 = name to give mesh</pre><pre>Base packet parameters JSON file format:<br/> { &quot;params&quot; {base packet parameters}}</pre><pre>[jcodd@mondavi Nring]$ ./create_Nring.sh BasePketParamsExpl.json 128 parallel 1 arb_pri_rr1 req <br/>Bus width: 384<br/>max_beats: 4<br/>header_width: 231<br/>max_header_field_width: 136<br/>data_beat_multiplier: 8<br/>data_beat_width: 153<br/>min_data_beat_width_F: 19<br/>min_data_beat_width_C: 1<br/>min_data_width: 16<br/>number_data_beats: 4<br/>null bits to total bits: 0.451171875<br/>data bits to beat bits: 0.3984375</pre><pre><span>The above command creates a top level JSON file named req_meshATP_Nmesh.json, where &quot;req&quot; is the name passed in for $1. All the sub files are uniquified with the $1 string, including the packet car, which is put in the cpr directory.</span></pre><h1 id="SymphonyNring(16)-RunthefollowingcommandtogeneratetheveriloginaDirectorycalledNmesh:">Run the following command to generate the verilog in a Directory called Nmesh:</h1><p>./run_Nring req_ringSMI_Nring.json gen_wrapper.tachl Nring</p><h1 id="SymphonyNring(16)-Thepieces">The pieces</h1><p><span>calc_ring_route.js : JavaScript to generate routes (16, one per smi_depkt) in the ring based on number of nodes in ring.</span></p><p><span>create_intSMI.js: JavaScript to convert Base Packet Def to a SMI Interface that supports it.</span></p><p><span>create_Nring.sh: Sh script that generates a ring and usage is above.</span></p><p><span>depkt_Nring.json.template: A template used to generate the smi_depkt JSON file used in the ring.</span></p><p><span>node_Nring.json.template: A template used to </span>generate the gen_wrapper JSON files used in the ring.</p><p><span>Nring: Contains some simple duts to do some verilog debug on after verilog generation.</span></p><p><span>pkt_Nring.json.template: A template used to generate the s</span>mi_pkt JSON files (16 of them.) </p><p><span>ringATP_Nring.json.template: A template used to generate gen_wrapper JSON file for the ATP level mesh.</span></p><p><span>ringSMI_Nring.json.template: A template used to generate gen_wrapper JSON file that instantiates smi_pkt blocks, s</span>mi_depkt blocks and ATP mesh.</p><p><span>run_Nring: A sh script to run TACHL to generate verilog and usage is above.</span></p><p><span>sym_pipe_Nring.json.template: A template used to generate the sym_pipe_adapter JSON file used in the ring.</span></p><div><span><br/></span></div>