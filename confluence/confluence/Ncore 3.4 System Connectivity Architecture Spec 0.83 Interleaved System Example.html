<p><span class="legacy-color-text-blue3">Some walk-through description for the association of caching agent AIUs to snoop filters, using the example interleaved system shown in today’s Connectivity spec review meeting.</span></p><p><span class="legacy-color-text-blue3"> </span></p><p><span class="legacy-color-text-blue3">The pictures are from the System Connectivity architecture spec 0.83, unmodified:</span></p><p><span class="legacy-color-text-blue3"> </span></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="250" src="https://arterisip.atlassian.net/wiki/download/attachments/16169956/ConnectivityInterleavedAIUs.png?api=v2"></span></p><p><br/></p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16169956/ConnectivitySnoopFilters.png?api=v2"></span></p><p><span class="legacy-color-text-blue3"> </span></p><p><span class="legacy-color-text-blue3"> </span></p><p>The address interleaving bit for the first interleaving group of AIUs, comprising AIU0 and AIU1, is address bit 7.</p><p>The address interleaving bits for the second interleaving group of AIUs, comprising AIU2, AIU3, AIU4, and AIU5, are address bits 7 and 8.</p><p>The address interleaving bits for the interleaving group of DCEs, comprising DCE0, DCE1, DCE2, and DCE3, are address bits 7 and 8.</p><p><br/></p><p>As a results:</p><p><br/></p><p>DCE0 is reachable from AIU0, AIU2.</p><p>DCE1 is reachable from AIU0, AIU3.</p><p>DCE2 is reachable from AIU1, AIU4.</p><p>DCE3 is reachable from AIU1, AIU5.</p><p><br/></p><p>Given the rule in the arch spec: “Interleaved AIUs within a group must be assigned to the same Snoop Filter”:</p><p><br/></p><p>If each group of interleaved AIUs has its own Snoop Filter, then:</p><p>=&gt;Group 0 [AIU0, AIU1] is assigned to Snoop Filter 0 (SF0)</p><p>=&gt;Group 1 [AIU2, AIU3, AIU4, AIU5] is assigned to Snoop Filter 1 (SF1)</p><p><br/></p><p>The SnoopFilterInfo parameter object for DCE contains an array of Snoop Filters:</p><p><br/></p><p>SnoopFilterInfo[0] = SF0</p><p>SnoopFilterInfo[1] = SF1</p><p><br/></p><p>SnoopFilterInfo[0].SnoopFilterAssignment = [0, 1]              //Caching Agents: CA0, CA1</p><p>SnoopFilterInfo[0].SnoopFilterNUnitIdAssignment = [0, 1] //AIUs: AIU0, AIU1</p><p><br/></p><p>SnoopFilterInfo[1].SnoopFilterAssignment = [2, 3, 4, 5]              //Caching Agents: CA2, CA3, CA4, CA5</p><p>SnoopFilterInfo[1].SnoopFilterNUnitIdAssignment = [2, 3, 4, 5] //AIUs: AIU2, AIU3, AIU4, AIU5</p><p><br/></p><p>SF0 of DCE0 tracks AIU0.</p><p>SF1 of DCE0 tracks AIU2.</p><p>SF0 of DCE1 tracks AIU0.</p><p>SF1 of DCE1 tracks AIU3.</p><p>SF0 of DCE2 tracks AIU1.</p><p>SF1 of DCE2 tracks AIU4.</p><p>SF0 of DCE3 tracks AIU1.</p><p>SF1 of DCE3 tracks AIU5.</p><p><br/></p><p>So each Snoop Filter only tracks one caching agent.</p><p>This means we can optimize the system connectivity, if we want to, by removing unreachable Caching Agents from each Snoop Filter.</p><p><br/></p><p>-Boon</p><p><br/></p><p>P/S:</p><p><br/></p><p>If we only want one Snoop Filter for all caching agent AIUs, then:</p><p><br/></p><p>The SnoopFilterInfo parameter object for a DCE contains an array of Snoop Filters.</p><p>SnoopFilterInfo[0] = SF0</p><p><br/></p><p>SnoopFilterInfo[0].SnoopFilterAssignment = [0, 1, 2, 3, 4, 5] //Caching Agents: CA0, CA1, CA2, CA3, CA4, CA5</p><p>SnoopFilterInfo[0].SnoopFilterNUnitIdAssignment = [0, 1, 2, 3, 4, 5] //AIUs: AIU0, AIU1, AIU2, AIU3, AIU4, AIU5</p><p><br/></p><p>SF0 of DCE0 tracks AIU0, AIU2.</p><p>SF0 of DCE1 tracks AIU0, AIU3.</p><p>SF0 of DCE2 tracks AIU1, AIU4.</p><p>SF0 of DCE3 tracks AIU1, AIU5.</p><p><br/></p><p>So each Snoop Filter tracks two caching agents.</p><p>This means we can optimize the system connectivity, if we want to, by removing unreachable Caching Agents from each Snoop Filter.</p><p><br/></p><p><span class="legacy-color-text-blue3"> </span></p><p><span class="legacy-color-text-blue3"> </span></p><p><br/></p>