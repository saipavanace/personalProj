<div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 437.818px;"><colgroup><col/><col style="width: 0.0px;"/><col/><col style="width: 0.0px;"/></colgroup><thead><tr><th colspan="1" class="confluenceTh">Version</th><th style="text-align: left;" class="confluenceTh"><p>Date</p></th><th colspan="1" class="confluenceTh">Author</th><th style="text-align: left;" class="confluenceTh"><p>Review Meeting</p></th></tr></thead><tbody><tr><td colspan="1" class="confluenceTd">0.1</td><td style="text-align: left;" class="confluenceTd">07/14</td><td colspan="1" class="confluenceTd"><a class="confluence-userlink user-mention" data-account-id="624b37e9258562006fa692ea" href="https://arterisip.atlassian.net/wiki/people/624b37e9258562006fa692ea?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Hardy Prosper (Deactivated)</a></td><td style="text-align: left;" class="confluenceTd">Initial version</td></tr><tr><td colspan="1" class="confluenceTd">0.2</td><td colspan="1" class="confluenceTd">07/15</td><td colspan="1" class="confluenceTd"><div class="content-wrapper"><p> <a class="confluence-userlink user-mention" data-account-id="624b37e9258562006fa692ea" href="https://arterisip.atlassian.net/wiki/people/624b37e9258562006fa692ea?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Hardy Prosper (Deactivated)</a></p></div></td><td colspan="1" class="confluenceTd"><br/></td></tr></tbody></table></div><p><br/></p><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 56.6206%;"><colgroup><col style="width: 5.13719%;"/><col style="width: 33.0025%;"/><col style="width: 61.8019%;"/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><br/></th><th style="text-align: left;" class="confluenceTh"><p>Reference</p></th><th style="text-align: left;" class="confluenceTh"><p>Comments</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd"><p>1</p></td><td style="text-align: left;" class="confluenceTd"><p><strong><a class="external-link" href="https://confluence.arteris.com/display/ENGR/Arch+Ncore+3.2+Docs?preview=/30507376/30509371/Ncore%20Trace%20and%20Debug%20Specification.pdf" rel="nofollow">Trace and Debug Arch Spe</a>c</strong></p></td><td style="text-align: left;" class="confluenceTd"><p>NCORE 3.0 Trace and Debug Architecture Spec</p></td></tr><tr><td colspan="1" style="text-align: left;" class="confluenceTd">2</td><td colspan="1" style="text-align: left;" class="confluenceTd"><strong><a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16159955/Ncore+3.2+Trace+and+Debug+Micro+Architecture+Specification" data-linked-resource-id="16159955" data-linked-resource-version="2" data-linked-resource-type="page">Trace and Debug Micro Arch Spec</a></strong></td><td colspan="1" style="text-align: left;" class="confluenceTd"><p>NCORE 3.0 Trace and Debug <strong>Micro</strong>-architecture Spec</p></td></tr></tbody></table></div><p><br/></p><p><span class="legacy-color-text-blue4">Questions that came up during the review::</span></p><ul><li>Is the DMI scoreboard checking from SMI to AXI including UserBits?</li></ul><p><span class="legacy-color-text-orange2">Answers collected from questions above:</span></p><ul><li>According to Krishna, the DMI scoreboard is doing that.</li></ul><p><br/></p><p>The following phases need to be completed, in order for this testplan to be considered fully implemented:</p><h3 id="TCAPinitialtestplanNcore3.2Beta2-Phase0">Phase 0</h3><ul><li><strong><span class="legacy-color-text-orange1">NCORE initiated trace</span></strong>::</li><li>This section is mostly intended for BringUp.</li><li>Following registers would be configured for each defined test: xTCTRLR, xTBALR-xTBAHR, xTOPCR, xTUBR, xTUBMR and the control xCCTRLR</li><li>Through visual inspection, make sure the following  </li></ul><p>             -   Test defined in <strong>Table I</strong> will be kept very short to only capture a minimun number of DTWs, 2 at most, for BringUp<br/>             -   Make sure the Timestamp is correct for each entry of the DTW.<br/>             -   Make sure the DTW gets sent out to the SMI port after being built.<br/>             -   Verify that DVE has successfully received the DTW(s).</p><h3 id="TCAPinitialtestplanNcore3.2Beta2-Table1:">Table 1:</h3><div class="table-wrap"><table class="relative-table wrapped confluenceTable" style="width: 69.0627%;"><colgroup><col style="width: 4.16009%;"/><col style="width: 19.389%;"/><col style="width: 6.38871%;"/><col style="width: 7.35444%;"/><col style="width: 6.31442%;"/><col style="width: 8.32018%;"/><col style="width: 5.12582%;"/><col style="width: 6.38871%;"/><col style="width: 4.82867%;"/><col style="width: 9.50878%;"/><col style="width: 5.05154%;"/></colgroup><tbody><tr><th class="confluenceTh">No</th><th class="confluenceTh">Testcase Name</th><th class="confluenceTh">Addr Range</th><th class="confluenceTh">Opcode</th><th class="confluenceTh">Trace Signal</th><th class="confluenceTh">Mem Attribute</th><th class="confluenceTh">User Bits</th><th colspan="1" class="confluenceTh"><p>Target type</p></th><th colspan="1" class="confluenceTh"><br/></th><th colspan="1" class="confluenceTh">Completed</th><th class="confluenceTh">Pass</th></tr><tr><td style="text-align: center;" class="confluenceTd">1</td><td class="confluenceTd">TnD_addr_range_capture</td><td style="text-align: center;" class="confluenceTd"><strong>Yes</strong></td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><br/></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">-</td></tr><tr><td style="text-align: center;" class="confluenceTd">2</td><td class="confluenceTd">TnD_opcode_capture</td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd"><strong>Yes</strong></td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><br/></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">-</td></tr><tr><td style="text-align: center;" class="confluenceTd">3</td><td class="confluenceTd">TnD_signal_capture</td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd"><strong>Yes</strong></td><td style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><br/></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td style="text-align: center;" class="confluenceTd">-</td></tr><tr><td colspan="1" style="text-align: center;" class="confluenceTd">4</td><td colspan="1" class="confluenceTd">TnD_memA_capture</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><strong>Yes</strong></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><br/></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">-</td></tr><tr><td colspan="1" style="text-align: center;" class="confluenceTd">5</td><td colspan="1" class="confluenceTd">TnD_userbit_capture</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><strong>Yes</strong></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><br/></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">-</td></tr><tr><td colspan="1" style="text-align: center;" class="confluenceTd">6</td><td colspan="1" class="confluenceTd"><p>TnD_targType_capture</p><p>TCTRLR{n}_hut_out=<strong>0   </strong>(DMI)<br/>TCTRLR{n}_hut_out=<strong>1   </strong>(DII)</p></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd"><strong>Yes</strong></td><td colspan="1" style="text-align: center;" class="confluenceTd"><br/></td><td colspan="1" style="text-align: center;" class="confluenceTd">No</td><td colspan="1" style="text-align: center;" class="confluenceTd">-</td></tr></tbody></table></div><h3 class="auto-cursor-target" id="TCAPinitialtestplanNcore3.2Beta2-Phase1"><strong>Phase 1</strong></h3><p class="auto-cursor-target"><strong style="letter-spacing: 0.0px;">DTWs Dropped</strong><span style="letter-spacing: 0.0px;">::</span></p><p class="auto-cursor-target">How to verify DTW Dropped?<br/>The current architecture only required to set a bit in the xCCTRLR register to indicate that DTW(s)<br/>has/have been dropped. Software will be responsible to clear it up. <br/>Because RTL is not providing a counter that indicates the number of DTW(s) dropped, DV would have to used this<br/>particular bit and the TimeStamp to determine which DTW to start matching against. As soon as we (DV) find a <br/>match, DV will reset the sticky bit. At this point, it is guaranteed that DTW(s) of the RTL are synced up.</p><ol><li class="auto-cursor-target">To fully test this scenario,  we need to use some parameters that will cause responses to be delayed from DMI and DII.</li><li class="auto-cursor-target">Those test currently exist in the full_sys regression list. We need to configure the trace and debug registers to verify the dropping mechanism.</li><li class="auto-cursor-target">The parameter for  the &quot;delay_max&quot; can be set higher if necessary..  (Kevin's suggestion)</li><li class="auto-cursor-target">We might have to define more test, if those 2 JSONs files don't provide the expected result.</li></ol><p class="auto-cursor-target">Notes:<br/>         DV implements only one algorithm, as described above, to verify the &quot;DTW Dropped&quot;, regardless<br/>         of the buffer type used by the RTL -- whether it is <span class="legacy-color-text-red1">Circular </span>or <span class="legacy-color-text-red1">Fifo</span>.</p><p>         Circular buffer     →    CCTRLR[<strong>8</strong>]=1<br/>         FIFO buffer          →    CCTRLR[<strong>8</strong>]=0</p><h3 class="auto-cursor-target" id="TCAPinitialtestplanNcore3.2Beta2-TableI:">Table I:</h3><ul><li>Set of parameters that will be used to exercise &quot;DTWs dropped&quot;</li></ul><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/></colgroup><tbody><tr><th class="confluenceTh"><br/></th><th class="confluenceTh">Delay Parameters</th></tr><tr><td class="confluenceTd"><br/></td><td class="confluenceTd"><p>&quot;+k_ace_slave_read_data_reorder_size&quot;: &quot;1&quot;,<br/>&quot;+k_ace_slave_read_addr_chnl_burst_pct&quot;: &quot;100&quot;,<br/>&quot;+k_ace_slave_read_data_chnl_burst_pct&quot;: &quot;100&quot;,<br/>&quot;+k_ace_slave_write_addr_chnl_burst_pct&quot;: &quot;100&quot;,<br/>&quot;+k_ace_slave_write_data_chnl_burst_pct&quot;: &quot;100&quot;,<br/>&quot;+k_ace_slave_write_resp_chnl_burst_pct&quot;: &quot;100&quot;,<br/>&quot;+k_ace_slave_read_data_interbeatdly_dis&quot;: &quot;1&quot;,<br/>&quot;+k_ace_slave_random_dly_dis&quot;: &quot;1&quot;,<br/>&quot;+k_ace_slave_read_data_chnl_delay_max&quot;: &quot;<span class="legacy-color-text-orange1"><strong>780</strong></span>&quot;, <br/>&quot;+k_ace_slave_write_resp_chnl_delay_max&quot;: &quot;<span class="legacy-color-text-orange1"><strong>780</strong></span>&quot;,</p></td></tr><tr><td class="confluenceTd"><br/></td><td class="confluenceTd"><br/></td></tr></tbody></table></div><p><br/></p><p><strong>Ncore Initiated Trace Test::</strong></p><p>Type of scenarios to run when the basic issues are resolved?</p><ol><li>Randomize<strong> nTraceRegisters</strong> parameter for better coverage. This parameter designates the number<br/>of sets of these trigger registers exist per AIU. In this current version of the Trace and Debug, the<br/>maximum number of sets for AIU is <strong>4</strong>. As the Micro-Arch stated.</li><li>Randomize the following registers:: <strong>xTCTRLR, xTBALR-xTBAHR, xTOPCR, xTUBR </strong>and<strong>  xTUBMR</strong></li></ol><p>Notes:<br/>       This is simply a reminder of what needs to be done, not necessarily a test that belongs to this testplan.</p><h3 class="auto-cursor-target" id="TCAPinitialtestplanNcore3.2Beta2-Testbenchstructure::">Testbench structure::</h3><p><br/></p><p><span class="confluence-embedded-file-wrapper"><img class="confluence-embedded-image" src="https://arterisip.atlassian.net/wiki/download/attachments/16160590/TraceDebug_file.png?api=v2"></span></p><p>At a glance, the DV environment to fully verify the Trace Capture Logic, support will be<br/>added to the existing Monitor and Scoreboard to each of the block where Trace Capture has<br/>been implemented. such as::<br/>      - Trace Capture Block in the CHI-CAIU<br/>      - Trace Capture Block in the ACE-CAIU<br/>      - Trace Capture Block in the NCAIU<br/>      - Trace Capture Block in the DMI<br/>      - Trace Capture Block in the DII</p><p>Each of those scoreboards will capture messages that have the concerto <strong>TraceTag</strong> field set,<br/>then build a DTW and store it and store it an a designated Queue that will be later used<br/>to compare to the DTW sent by the RTL in the <strong>SMI interface</strong>. They will be expected to match,<br/>otherwise the scoreboard will flag and error and simulation will be terminated.</p><p>Note::  Trace and Capture scoreboard is checking from SMI to SMI even the ones from DMI and DII.</p><p><br/></p><p><strong>Questions::</strong><br/>      - Given the actual state of the CDTI block, where it might be considered very solid by<br/>        now, what is the possibility for the DTW to get corrupted in the CDTI.. <br/>      - Does CDTI interleaves DTWs from the save source?</p><p><strong><span class="legacy-color-text-red1">Answers::</span></strong><br/>     - John has answered the question that was poised regarding the possibility of a DTW message <br/>       to be modifyed by CDTI... The answer is <strong><span class="legacy-color-text-default">NO</span></strong>, CDTI will not modify the DTW bundle.<br/>     - Also, John has clarified the second question that had to do with CDTI interleaving DTWs<br/>       from a given source. - The answer is also <strong>NO</strong>...</p><p><br/></p><p>From AIUs::</p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" width="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16160590/image2021-7-16_13-8-35.png?api=v2"></span></p><p><br/></p><p><strong>Step</strong> 1::</p><ul><li>Trace and Debug message detected by the SMI monitor, as shown above</li><li>Scoreboard buffers the messages to create a 64-bytes DTW.</li><li>Push the DTW to the queue</li></ul><p><strong>Step</strong> 2::</p><ul><li>Trace and Debug <strong>DTW</strong> detected by the SMI monitor, as shown above</li><li>PoP DTW from the queue and compare against the DTW detected on the SMI</li><li>Flag an error if mismatched.</li></ul><p><strong>Step</strong> 3:: </p><ul><li>If the DTW will never be modified by the CDTI, the check made in STEP 2 is sufficient to<br/>guarantee that the DTW arriving at the DVE was not corrupted.<br/><strong>But</strong>, if the DTW can be corrupted by the CDTI, STEP 2 will be done at the DVE interface.</li></ul><p>         </p><p>From DMI and DII:: </p><p><span class="confluence-embedded-file-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image" width="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16160590/image2021-7-16_13-47-5.png?api=v2"></span>   </p><p><br/></p><p><br/></p><p><br/></p><p>   </p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>