<p><br/></p><p>NXP's v11 cfg has 5 IOAIUs, 1CHIAIU, 2 DIIs, 1 SYSDII, 1 DMI &amp; 1 DVE.</p><p><br/></p><p>We can achieve the flop reduction by removing duplication and reducing sizes of these buffers.</p><p><br/></p><p>Savings in capture block:</p><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/></colgroup><tbody><tr><th class="confluenceTh">Block</th><th colspan="1" class="confluenceTh">Flop count without duplication</th><th colspan="1" class="confluenceTh">Flop count with duplication</th></tr><tr><td colspan="1" class="confluenceTd">DMI_A</td><td colspan="1" class="confluenceTd">11,448</td><td colspan="1" class="confluenceTd">22,896</td></tr><tr><td class="confluenceTd">IOAIU_A</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td colspan="1" class="confluenceTd">IOAIU_A[2nd instance]</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td class="confluenceTd">IOAIU_B</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td class="confluenceTd">IOAIU_C</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td class="confluenceTd">IOAIU_D</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td class="confluenceTd">DII_A</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td class="confluenceTd">DII_B</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td class="confluenceTd">SYS_DII</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td colspan="1" class="confluenceTd">CHIAIU_A</td><td colspan="1" class="confluenceTd">9,736</td><td colspan="1" class="confluenceTd">19,472</td></tr><tr><td colspan="1" class="confluenceTd"><strong>Total Flop Count</strong></td><td colspan="1" class="confluenceTd"><strong>99,072</strong></td><td colspan="1" class="confluenceTd"><strong>198,144</strong></td></tr></tbody></table></div><p><br/></p><h1 id="Debug/Traceflopcount-Impactofremovingduplication:"><strong>Impact of removing duplication:</strong></h1><p><strong>Capture block: </strong></p><p style="margin-left: 30.0px;">Capture block across all instances [default depth of SMI FIFO is 4]:</p><ul><li>DMI SMI FIFO has 4 TX and 4 RX instances: <strong>1,454</strong> flops x 4[fifo depth] = <strong>5,816 flops</strong></li><li>All other SMI FIFO's have 3 TX and 3 RX instances: 1,026 x 9 = <strong>9,234</strong> flops x 4[fifo depth] = <strong>36,936 flops</strong></li></ul><p style="margin-left: 30.0px;">So combined SMI FIFO size across NXP's v11 CFG: <strong>42,752 flops</strong></p><p style="margin-left: 30.0px;"><br/>Each CAPTURE ACCUMULATOR: 512x3 = <strong>1,536</strong> flops<br/>So combined CAPTURE ACCUMULATOR size across NXP's v11 CFG: <strong>15,360</strong> <strong>flops</strong></p><p style="margin-left: 30.0px;"><br/>Each CAPTURE BUFFER: 512x8= <strong>4,096</strong> flops<br/>So combined CAPTURE BUFFER size across NXP's v11 CFG: <strong>40,960 flops</strong></p><p style="margin-left: 30.0px;"><br/>So a combined total of <strong>99,072 flop</strong>s for all capture blocks combined.</p><p>Duplicated over 10 units it would be <strong>198,144 flops</strong></p><p>Overall savings getting rid of duplication saves <strong>99,072 flops</strong> [approximate count since we might have add flops if we decide not duplicate these blocks for check logic to work].</p><p><br/></p><p><strong>DVE block:</strong></p><p style="margin-left: 30.0px;">SRAM's don't get duplicated. So converting the DVE trace accumulator to SRAM saves duplication of 41,472 flops.</p><p style="margin-left: 30.0px;">Also the remaining 41,472 flops gets converted to SRAMS [2 macros of size 72x64 &amp; 72x512].</p><p style="margin-left: 30.0px;"><br/>So, in total we reduce the flop count by<strong> 82,944 flops</strong> by going with SRAM for trace accumulator.</p><p style="margin-left: 30.0px;"><br/></p><p style="margin-left: 30.0px;"><br/></p><h1 id="Debug/Traceflopcount-Reducingstructuresizes/defaults[basedondiscussionwithKhaleel]:"><strong>Reducing structure sizes/defaults [</strong><em>based on discussion with Khaleel</em><strong>]:</strong></h1><p><br/></p><p>Assuming approximate SMI FIFO size of 130 bits on average. We cannot change the size of trace capture block</p><p><br/></p><p>Maybe we can save following </p><p>SMI FIFO reduced by 1:</p><p>Assuming approximate SMI FIFO size of 130 bits on average</p><p>Other than DMI all other ncore unit has 6 of these so 6*130 =780 * 2(duplication) = 1560 flops reduced per unit</p><p><br/></p><p>Capture FIFO can be reduced from 8 to 6</p><p>Each entry is 512 bits so 1024 *2(duplication) = 2048 flops reduced</p><p><br/></p><p>DMI reduction – ((130*8)*1+(512*2))*2 = 4128  &lt;((SMI fifo)*1 + (capture fifo)*2)*duplication&gt;</p><p>AIU and DII reduction – ((130*6)*1+(512*2))*2 = 3608</p><p><br/></p><p>6 AIUs and 2 DIIs = 3608* 8 = 28864 flops</p><p>1 DMI = 4128 * 1 = 4128</p><p>Total savings = 32992 (about 32K flops) Number is probably an overestimate as the response network is smaller.</p><p><br/></p><p>Another more aggressive option will be</p><p>SMI FIFO reduced by 2</p><p>Capture FIFO reduced by 4</p><p><br/></p><p>DMI reduction – ((130*8)*2+(512*4))*2 = 8256</p><p>AIU and DII reduction – ((130*6)*2+(512*4))*2 = 7216</p><p><br/></p><p>6 AIUs and 2 DIIs = 7216* 8 = 57728 flops</p><p>1 DMI = 8256 * 1 = 8256</p><p>Total savings =  65984 (about 65K flops)</p><p><br/></p><h2 id="Debug/Traceflopcount-ComparisonofDVEtraceaccumulator’simplementationwithSRAMVsflop-basedimplementation."><strong>Comparison of DVE trace accumulator’s implementation with SRAM Vs flop-based implementation.</strong></h2><p><br/></p><p>This is data from a NXP v11 CFG run using DC_NXT.</p><p><br/></p><div class="table-wrap"><table class="wrapped confluenceTable"><tbody><tr><td class="confluenceTd"><p><strong> </strong></p></td><td class="confluenceTd"><p><strong>SRAM implementation</strong></p></td><td class="confluenceTd"><p><strong>Flop implementation</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>Cell count</strong></p></td><td class="confluenceTd"><p>40966</p></td><td class="confluenceTd"><p>83783</p></td></tr><tr><td class="confluenceTd"><p><strong>Combinational Area [in um^2]</strong></p></td><td class="confluenceTd"><p>2912</p></td><td class="confluenceTd"><p>5403</p></td></tr><tr><td class="confluenceTd"><p><strong>Buffer/Invertor Area [in um^2]</strong></p></td><td class="confluenceTd"><p>387</p></td><td class="confluenceTd"><p>574</p></td></tr><tr><td class="confluenceTd"><p><strong>Non-combinational Area [in um^2]</strong></p></td><td class="confluenceTd"><p>3411</p></td><td class="confluenceTd"><p>10894</p></td></tr><tr><td class="confluenceTd"><p><strong>Macro area [in um^2]</strong></p></td><td class="confluenceTd"><p>2520</p></td><td class="confluenceTd"><p>0</p></td></tr><tr><td class="confluenceTd"><p><strong>Total cell area [in um^2]</strong></p></td><td class="confluenceTd"><p>8845</p></td><td class="confluenceTd"><p>16297</p></td></tr></tbody></table></div><p><br/></p><h2 id="Debug/Traceflopcount-Additionalinformationusefulforcalculatingflopcount:"><strong>Additional information useful for calculating flop count:</strong></h2><p>NXP's v11 CFG instance mapping:</p><p style="margin-left: 30.0px;"><em>&quot;caiu0&quot;: &quot;aiu_top_a&quot;,</em><br/><em>&quot;dii0&quot;: &quot;dii_top_a&quot;,</em><br/><em>&quot;dii1&quot;: &quot;dii_top_b&quot;,</em><br/><em>&quot;dmi0&quot;: &quot;dmi_a&quot;,</em><br/><em>&quot;ncaiu0&quot;: &quot;ioaiu_top_a&quot;,</em><br/><em>&quot;ncaiu2&quot;: &quot;ioaiu_top_a&quot;,</em><br/><em>&quot;ncaiu1&quot;: &quot;ioaiu_top_b&quot;,</em><br/><em>&quot;ncaiu3&quot;: &quot;ioaiu_top_c&quot;,</em><br/><em>&quot;ncaiu4&quot;: &quot;ioaiu_top_d&quot;,</em><br/><em>&quot;sys_dii&quot;: &quot;config_dii_a&quot;,</em></p><p><br/></p><p>Each SMI FIFO instance has the following fields. Flop count varies based on these fields depending on the configuration. Timestamp is fixed to be 32 bits.</p><p style="margin-left: 30.0px;">smi_t/rx*_valid_qual<br/>smi_t/rx*_ndp_msg_ready_fifo<br/>smi_t/rx*_ndp_targ_id<br/>smi_t/rx*_ndp_src_id<br/>smi_t/rx*_ndp_ndp_len<br/>smi_t/rx*_ndp_ndp<br/>smi_t/rx*_ndp_msg_user<br/>smi_t/rx*_ndp_msg_type<br/>smi_t/rx*_ndp_msg_pri<br/>smi_t/rx*_ndp_msg_id<br/>smi_t/rx*_ndp_dp_present<br/>smi_t/rx*_timestamp</p><p><br/></p><p>Based off this and looking at the *.v files generated based of NXP's v11 CFG here is the flop count per instance of SMI FIFO within each block:</p><p><strong>//DMI_A</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:214</em><br/><em>SMI_TX3:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:214</em><br/><em>SMI_RX3:160</em></p><p><strong>1,454 flops</strong></p><p><strong>//IOAIU_A</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong><br/>Since we have 2 instance of this we have a total of <strong>2052 flops</strong></p><p><strong>//IOAIU_B</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong></p><p><strong>//IOAIU_C</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong></p><p><strong>//IOAIU_D</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong></p><p><strong>//DII_A</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1026 flops</strong></p><p><strong>//DII_B</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong></p><p><strong>//SYS_DII</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong></p><p><strong>//CHIAIU_A</strong><br/><em>SMI_TX0:237</em><br/><em>SMI_TX1:116</em><br/><em>SMI_TX2:160</em><br/><em>SMI_RX0:237</em><br/><em>SMI_RX1:116</em><br/><em>SMI_RX2:160</em></p><p><strong>1,026 flops</strong></p><p><br/><strong>9234 + 1454 = 10,688 flops</strong></p><p><br/></p><p><br/></p><p style="margin-left: 30.0px;"><br/></p><p style="margin-left: 30.0px;"><br/></p><p style="margin-left: 30.0px;"><br/></p><p><br/></p>