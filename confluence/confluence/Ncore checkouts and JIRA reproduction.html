<p /><style type='text/css'>/*<![CDATA[*/
div.rbtoc1759724752474 {padding: 0px;}
div.rbtoc1759724752474 ul {list-style: disc;margin-left: 0px;}
div.rbtoc1759724752474 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class='toc-macro rbtoc1759724752474'>
<ul class='toc-indentation'>
<li><a href='#NcorecheckoutsandJIRAreproduction-Problemstatement:'>Problem statement:</a></li>
<li><a href='#NcorecheckoutsandJIRAreproduction-Proposedsolution:'>Proposed solution:</a></li>
<li><a href='#NcorecheckoutsandJIRAreproduction-Tasks:'>Tasks:</a></li>
<li><a href='#NcorecheckoutsandJIRAreproduction-ContainerRepositoryOperationsAnalysis'>Container Repository Operations Analysis</a>
<ul class='toc-indentation'>
<li><a href='#NcorecheckoutsandJIRAreproduction-DesignAssumptions'>Design Assumptions</a></li>
<li><a href='#NcorecheckoutsandJIRAreproduction-Design'>Design</a></li>
<li><a href='#NcorecheckoutsandJIRAreproduction-ExpectedWorkflow'>Expected Workflow</a></li>
</ul>
</li>
<li><a href='#NcorecheckoutsandJIRAreproduction-MeetingNotes:'>Meeting Notes:</a></li>
</ul>
</div><h2 id="NcorecheckoutsandJIRAreproduction-Problemstatement:">Problem statement:</h2><p>Currently, it is difficult and error-prone to reproduce a <span class="inline-comment-marker" data-ref="ab5d198b-7d66-4014-8586-7159092a0b33">failure</span>. The current behavior is that engineers will just try to rerun any Jira or regression failure on the latest and hope it still fails.<br/>This is counter-productive and causes important bugs to be lost which then either at best show up later or worse are present in customer releases. This is unacceptable.</p><h2 id="NcorecheckoutsandJIRAreproduction-Proposedsolution:">Proposed solution:</h2><p>Build a Git “container repository” (Mike’s term for a Git repository that contains <a class="external-link" href="https://git-scm.com/book/en/v2/Git-Tools-Submodules" rel="nofollow">submodules</a>) for Ncore. The container repository will refer to at least hw-ncr and hw-test-projects as Git submodules. (What about hw-ccp, hw-lib, hw-scripts, hw-sym, as well as misc file rs_testlist.sh, SOURCEME, and SORCEME.csh?)</p><p>Then branch the container repository when you want to allow someone to reproduce a failure later. For example, the Jenkins nightly regression might create a branch of the container repository called ncore_3p4_20220628_fsys_nightly_regr. We won’t need to branch the submodules manually.</p><p>Create a checkout command that allows you to either checkout a branch of the Ncore container repository, or just checkout HEAD of Ncore container and switch to the branch. It must be really easy.</p><p>Create a solution in the container repository to allow it to point to a version of Maestro. The container repository will not check out the Maestro source code.</p><p>Create a solution to preserve old Maestro binaries. Michel recommends we use Artifactory. </p><hr/><h2 id="NcorecheckoutsandJIRAreproduction-Tasks:">Tasks:</h2><div class="table-wrap"><table data-layout="default" data-local-id="dc80b3e7-c309-4bf7-a799-9f4e52f7b625" class="confluenceTable"><colgroup><col style="width: 326.0px;"/><col style="width: 181.0px;"/><col style="width: 253.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Task</strong></p></th><th class="confluenceTh"><p><strong>Owner/Responsible</strong></p></th><th class="confluenceTh"><p><strong>Jira Issue ID</strong></p></th></tr><tr><td class="confluenceTd"><ol><li><p>Define “container repository” operations analysis prior to implementation of first article container repository</p></li><li><p>Decide on repository name (taking into account there may be multiple of these in the future)</p></li><li><p>Review and approve above</p></li></ol></td><td class="confluenceTd"><ol><li><p><a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a> </p></li><li><p>Team</p></li><li><p>Team</p></li></ol></td><td class="confluenceTd"><p>None</p><ol><li><p>Done</p></li><li><p>open</p></li><li><p>open</p></li></ol></td></tr><tr><td class="confluenceTd"><p>Define the initial content of the first-article Git container repository</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="624b36e92e101c006a9105b6" href="https://arterisip.atlassian.net/wiki/people/624b36e92e101c006a9105b6?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kjeld Svendsen (Deactivated)</a> </p></td><td class="confluenceTd"><p>

    

            



<style>
    .jira-issue {
        padding: 0 0 0 2px;
        line-height: 20px;
    }

    .jira-issue img {
        padding-right: 5px;
    }
    .jira-issue .aui-lozenge {
        line-height: 18px;
        vertical-align: top;
    }

    .jira-issue .icon {
        background-position: left center;
        background-repeat: no-repeat;
        display: inline-block;
        font-size: 0;
        max-height: 16px;
        text-align: left;
        text-indent: -9999em;
        vertical-align: text-bottom;
    }
</style>

    <span class="confluence-jim-macro jira-issue" data-jira-key="ENGINFRA-358"  data-client-id="SINGLE_bfb5209b-5e34-3655-9c0b-93d8d0d4bec5_24313948_624b3807a629c30068a79f50" >
                <a href="https://arterisip.atlassian.net/browse/ENGINFRA-358" class="jira-issue-key"><span class="aui-icon aui-icon-wait issue-placeholder"></span>ENGINFRA-358</a>
                    -
            <span class="summary">Getting issue details...</span>
                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-default issue-placeholder">STATUS</span>
            </span>
</p></td></tr><tr><td class="confluenceTd"><p>Create initial Ncore container repository</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a>  </p></td><td class="confluenceTd"><p>

    

            



<style>
    .jira-issue {
        padding: 0 0 0 2px;
        line-height: 20px;
    }

    .jira-issue img {
        padding-right: 5px;
    }
    .jira-issue .aui-lozenge {
        line-height: 18px;
        vertical-align: top;
    }

    .jira-issue .icon {
        background-position: left center;
        background-repeat: no-repeat;
        display: inline-block;
        font-size: 0;
        max-height: 16px;
        text-align: left;
        text-indent: -9999em;
        vertical-align: text-bottom;
    }
</style>

    <span class="confluence-jim-macro jira-issue" data-jira-key="ENGINFRA-357"  data-client-id="SINGLE_bfb5209b-5e34-3655-9c0b-93d8d0d4bec5_24313948_624b3807a629c30068a79f50" >
                <a href="https://arterisip.atlassian.net/browse/ENGINFRA-357" class="jira-issue-key"><span class="aui-icon aui-icon-wait issue-placeholder"></span>ENGINFRA-357</a>
                    -
            <span class="summary">Getting issue details...</span>
                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-default issue-placeholder">STATUS</span>
            </span>
</p></td></tr><tr><td class="confluenceTd"><p>Decide first Ncore version that will use Ncore container.</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="624b36e92e101c006a9105b6" href="https://arterisip.atlassian.net/wiki/people/624b36e92e101c006a9105b6?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kjeld Svendsen (Deactivated)</a></p></td><td class="confluenceTd"><p>None</p></td></tr><tr><td class="confluenceTd"><p>Develop scheme for capturing the “version” of Maestro used to create the initial test environment to be reproduced</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a></p></td><td class="confluenceTd"><p>TBD</p></td></tr><tr><td class="confluenceTd"><p>Develop script that creates test environment from the contents of a commit in the container repository</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a> (with help from Balaji)</p></td><td class="confluenceTd"><p>TBD</p></td></tr><tr><td class="confluenceTd"><p>Test the script that creates test environment from commit in container repository</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="624b36e92e101c006a9105b6" href="https://arterisip.atlassian.net/wiki/people/624b36e92e101c006a9105b6?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kjeld Svendsen (Deactivated)</a></p></td><td class="confluenceTd"><p>TBD</p></td></tr><tr><td class="confluenceTd"><p>Setup Artifactory for Maestro</p></td><td class="confluenceTd"><p><a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a></p></td><td class="confluenceTd"><p>Story: 

    

            



<style>
    .jira-issue {
        padding: 0 0 0 2px;
        line-height: 20px;
    }

    .jira-issue img {
        padding-right: 5px;
    }
    .jira-issue .aui-lozenge {
        line-height: 18px;
        vertical-align: top;
    }

    .jira-issue .icon {
        background-position: left center;
        background-repeat: no-repeat;
        display: inline-block;
        font-size: 0;
        max-height: 16px;
        text-align: left;
        text-indent: -9999em;
        vertical-align: text-bottom;
    }
</style>

    <span class="confluence-jim-macro jira-issue" data-jira-key="ENGINFRA-89"  data-client-id="SINGLE_bfb5209b-5e34-3655-9c0b-93d8d0d4bec5_24313948_624b3807a629c30068a79f50" >
                <a href="https://arterisip.atlassian.net/browse/ENGINFRA-89" class="jira-issue-key"><span class="aui-icon aui-icon-wait issue-placeholder"></span>ENGINFRA-89</a>
                    -
            <span class="summary">Getting issue details...</span>
                                    <span class="aui-lozenge aui-lozenge-subtle aui-lozenge-default issue-placeholder">STATUS</span>
            </span>
 </p></td></tr></tbody></table></div><hr/><h2 id="NcorecheckoutsandJIRAreproduction-ContainerRepositoryOperationsAnalysis">Container Repository Operations Analysis</h2><h3 id="NcorecheckoutsandJIRAreproduction-DesignAssumptions">Design Assumptions</h3><p>These are some assumptions and/or requirements built in to the below defined workflow</p><ol><li><p>Branches within the container repository created per type of tests that are regularly run. Let’s call these “A-type” branches. These branches are pre-configured for all future runs.</p></li><li><p>Each test run is a branch off the above branch. Let’s call these a “B-type” branch</p></li><li><p>After test runs and ensuing debug operations are completed, the B-type branch is merged back into the A-type branch in preparation for any following runs. This assumes that some change has happened on the B-type branch and needs to be captured on the A-type branch.</p></li><li><p>Every A-type branch has a fixed definition of submodule repositories and tracking branches for each</p></li><li><p>“Versions” of Maestro software are available from a well-known location and identified by a unique version ID and accessible on a file system path from any build/test server</p></li></ol><h3 id="NcorecheckoutsandJIRAreproduction-Design">Design</h3><p>Elements of this design include:</p><ol><li><p>A Git container repository in GitLab populated with the necessary dependent Git submodule repositories</p></li><li><p>A script checked into the container repository on the master branch (then available to all branches) that can populate a test/debug environment from the data in a commit on a branch</p></li><li><p>A file (or other storage mechanism) that contains reproducibility data from a test run written into the file by the above script or consumed by the above script to create a debug environment</p></li></ol><h3 id="NcorecheckoutsandJIRAreproduction-ExpectedWorkflow">Expected Workflow</h3><p>This represents a typical set of steps involved in running and then later debugging</p><ol><li><p>A test project is defined</p><ol><li><p>test goals</p></li><li><p>test software (scripts, etc.) requiring preparation if any</p></li><li><p>Git repositories and branch names containing the above</p></li><li><p>etc.</p></li></ol></li><li><p>Get the latest environment for a branch (for Bill)</p><ol><li><p>If not already done, clone the “container” repository; cd into the repository</p></li><li><p>Checkout the branch containing the environment you want</p></li><li><p>optionally, checkout a earlier from that branch</p></li></ol></li><li><p>Running the tests</p><ol><li><p>If not already done, clone the “container” repository <code>git clone --recursive git@gitlab.arteris.com:maestro/Ncore-dv/ncore-dv.git</code></p></li><li><p>or if you forget recursive; cd into repo <code>git submodule init</code>; <code>git submodule update</code></p></li><li><p>cd into the repository</p></li><li><p>Checkout the appropriate A-type branch</p></li><li><p>Create a new B-type branch <code>git checkout -b &lt;B-type-branch-name&gt;</code></p></li><li><p>Update any/all submodules to latest on tracking branch</p><ol><li><p>All: <code>git submodule update --remote</code></p></li><li><p>One: <code>git submodule update --remote &lt;path to the submodule&gt;</code> </p></li><li><p>Specific commit</p></li></ol></li><li><p>Use (TBD) script to create your test environment</p><ol><li><p>This script will get the “stable” version of Maestro client and server from the branch specified (how to specify this?).</p></li><li><p>The path to the stable version will be recorded by the script for later reproducibility.</p></li></ol></li><li><p>Run tests</p></li><li><p>To create a reproducible setup, check-in your workspace into the current B-type branch and push to remote repository</p><ol><li><p><code>git commit -m &quot;my commit message&quot;</code></p></li><li><p><code>git push origin &lt;B-type-branch-name&gt;</code></p></li><li><p>NOTE: this captures the changes you’ve made in the submodule repositories, if any</p></li></ol></li></ol></li><li><p>Debugging the tests</p><ol><li><p>On test failure</p><ol><li><p>A Jira bug issue is opened</p></li><li><p>The bug is described</p></li><li><p>The test environment is described including the name of the branch in the Git container repository on which the failing test was performed</p></li></ol></li><li><p>Recreate the test environment for debug</p><ol><li><p>If not already done, clone the “container” repository; cd into the repository</p></li><li><p>Checkout the branch specified in the Jira</p></li><li><p>Run the scripts that creates your debug environment</p></li></ol></li><li><p>Enjoy!</p></li></ol></li></ol><hr/><h2 id="NcorecheckoutsandJIRAreproduction-MeetingNotes:">Meeting Notes:</h2><p>7/5/2022:</p><p>6/28/2022: <a class="confluence-userlink user-mention" data-account-id="624b36e92e101c006a9105b6" href="https://arterisip.atlassian.net/wiki/people/624b36e92e101c006a9105b6?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Kjeld Svendsen (Deactivated)</a> <a class="confluence-userlink user-mention" data-account-id="6148b72ccee20b0069c8027b" href="https://arterisip.atlassian.net/wiki/people/6148b72ccee20b0069c8027b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Michel Klein (Deactivated)</a> <a class="confluence-userlink user-mention" data-account-id="624b3741ed4d6b0070161f12" href="https://arterisip.atlassian.net/wiki/people/624b3741ed4d6b0070161f12?ref=confluence" target="_blank" data-linked-resource-id="788105" data-linked-resource-version="1" data-linked-resource-type="userinfo" data-base-url="https://arterisip.atlassian.net/wiki">Balaji Krishnaswamy</a> <a class="confluence-userlink user-mention" data-account-id="624b38261da0e100713c9b4b" href="https://arterisip.atlassian.net/wiki/people/624b38261da0e100713c9b4b?ref=confluence" target="_blank" data-base-url="https://arterisip.atlassian.net/wiki">Bill Chandler (Deactivated)</a> </p><p>  Kjeld’s notes.</p><p> 1. We discussed requirements and options.</p><p>The 'wished-for' requirement is that an environment (all files, tools revisions, etc) can be checked out by one command, e.g., 'getrepositorys revision'</p><p>and the bug test rerun with the original bug reproduced without further ado.</p><p> The 'revision' should be documented in the Jira for bugs, but other uses are also possible.</p><p>Various options were outlined to meet the requirement. Michael and Balaji will work together to determine how to best do this.</p><p>A short-term solution should be straight forward to build and productize. </p><p>Longer-term the main trouble is that multiple databases need to come together, RTL, DV, Maestro, linux rev. and env, tool revisions, etc.</p><p>A script should be able to handle this 'under the hood, so newbies and git illiterates needn't deal with this.</p><p>Maestro is a unique issue since the rev is a binary and not in a revision system as such, and Maestro revs are turned over on a 3-4 week basis, which is too short. A Git repository for bins (Artifactory) should solve this.</p><p> 2. We agree to go with a 'Container repository' approach. </p><p>We agreed to get this in place ASAP, and start using it when ready, disregarding project rev. We will not make it work for prior bugs, etc. </p><p> 3. Bill will start a confluence page and Kjeld will populate it with info, as will all others, to keep track of progress.</p><p>Bill notes:</p><p>When do we want to start using the container repository? 3.4 and later? 3.3 and later?</p><p>Mike replies:</p><p>Any and all product versions that are being tested. The cost for each additional product after the first is very small.</p><p>  </p><p /><p />