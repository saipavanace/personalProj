<p>There are a set of javascript programs that allow you to manipulate module hierarchy of a JSON file that's been generated by Maestro to modify the hierarchy. These scripts are located at:</p><p style="margin-left: 30.0px;">hw-lib/js</p><p>They are:</p><ul><li>flatten_hierarchy.js: reads in a JSON with a given module hierarchy and flattens the hierarchy to one level</li><li>split_async_blocks.js: reads in a JSON with one level of module hierarchy and splits the sym_async_adapters into two.</li><li>create_module_hierarchy.js: reads in a JSON with one level of  module hierarchy and using properties on the blocks, builds a new hierarchy.</li></ul><p>There are two programs that are used to create and manipulate a sets file that add properties to the design that are used to manipulate the hierarchy. These can be run on any JSON file with any module hierarchy, but they must be run on the same JSON file (actually the files must have the same module hierarchy.)</p><ul><li>get_sets.js: reads in a JSON file and spits out a sets file to edit that lets you change the hierarchy. You can use get_sets.js after you set_sets.js to validate your sets file.</li><li>set_sets.js: reads in a JSON file and sets file and spits out the JSON file with the sets property added to the blocks. Does not actually manipulate the hierarchy.</li></ul><p>A potential flow:</p><ol><li>flatten_hierarchy.js -i orig.json -o flattened.json</li><li>get_sets.js -i flattened.json -o sets.json</li><li>Edit the sets.json file to create the hierarchy you want.</li><li>set_sets.js -i flattened.json -s sets.json -o flattened.withsets.json</li><li>split_async_blocks.js -i flattened.withsets.json -o split.json</li><li>create_module_hierarchy.js -I split.json -o new.json </li></ol><p>You then run tachl.js on the new.json file to generate the new code. Once you have generated the new code, you should run some form of LEC between it and the original RTL generated by maestro.</p><h1 id="JSONmodulehierarchymanipulation-TheSetsFileStructure:">The Sets File Structure:</h1><p>The structure of the sets file is:</p><pre>{<br/>  &quot;sets&quot;: [<br/>      {&quot;name&quot;: &quot;a&quot;, &quot;members&quot;: [&quot;b&quot;,&quot;c&quot;]},<br/>      {&quot;name&quot;: &quot;b&quot;, &quot;members&quot;: []},<br/>      {&quot;name&quot;: &quot;c&quot;, &quot;members&quot;: []}<br/>  ],<br/>  &quot;wildcards&quot; :[<br/>      {&quot;pattern&quot;: &quot;atuI_&quot;, &quot;memberOf&quot; : &quot;a&quot;},<br/>      {&quot;pattern&quot;: &quot;atuT_&quot;, &quot;memberOf&quot; : &quot;a&quot;},<br/>      {&quot;pattern&quot;: &quot;csr_request_&quot;, &quot;memberOf&quot; : &quot;b&quot;},<br/>      {&quot;pattern&quot;: &quot;csr_response_&quot;, &quot;memberOf&quot; : &quot;c&quot;}<br/>  ],<br/>  &quot;blocks&quot;: {<br/>    &quot;csr_request_nw__req_aa&quot;: {<br/>      &quot;module&quot;: &quot;sym_async_adapter&quot;,<br/>      &quot;memberOf&quot;: &quot;b,c&quot;<br/>    },<br/>    &quot;csr_response_nw__rsp_ra&quot;: {<br/>      &quot;module&quot;: &quot;sym_rate_adapter&quot;,<br/>      &quot;memberOf&quot;: &quot;c,b&quot;<br/>    }<br/>  }<br/>}</pre><p>In this you are creating three modules: a, b and c. Modules b and c are instanced inside of module a.</p><p>Wildcards allow you to use regular expressions to assign a group of instances into one of your created modules. The wild cards are applied in order, so the later the wildcard the higher the priority. </p><p>Blocks are assigned last and override wildcards. They are applied to specific blocks. When the blocks is sym_async_adapter, it can be a member of two groups. The first group is for the in side and the second group is for the out side. If you have not split the block, it will be put in the first group.</p><h1 id="JSONmodulehierarchymanipulation-OriginalPresentationgiventoSoftware(implementationisslightlydifferent)">Original Presentation given to Software (implementation is slightly different)</h1><p><a href="/wiki/spaces/ENGR/pages/16165359/JSON+module+hierarchy+manipulation?preview=%2F16165359%2F16175979%2FAddingHierarchy.pptx"><span style="background: url('/wiki/s/-672721829/6452/d621ad2a33e27b90ca05c475b216bfab745e08a2/1000.0.0-d621ad2a33e2/_/download/resources/com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-resources/images/placeholder-medium-presentation.png'); width: 333px; height: 95px; display: inline-block; padding-top: 155px; margin: 2px; border: 1px solid #ddd; text-align: center; vertical-align: text-bottom; text-decoration: none; font-size: 12px; color: #000;">AddingHierarchy.pptx</span></a></p><p><br/></p>