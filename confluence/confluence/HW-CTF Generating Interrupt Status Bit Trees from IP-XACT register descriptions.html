<p>This page describes how to extract information about how interrupt status bits are related to each other in a Symphony network, from register descriptions in the generated <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16169519/IP-XACT+-+IEEE+1685-2014" data-linked-resource-id="16169519" data-linked-resource-version="1" data-linked-resource-type="page">IP-XACT - IEEE 1685-2014</a> XML for the same network. The relationships between interrupt status bits are generated as a single JSON object and data-structure, called &quot;<em>interruptBitTrees</em>&quot;, by running a script that parses the IP-XACT XML. The <em>interruptBitTrees</em> data-structure is expressed as a tree since a given status bit can be set due to an interrupt generated by one or more other such bits residing in either the same block or in different blocks. Each of those different blocks might in turn have an interrupt hierarchy tree within their blocks and sub-blocks.</p><h2 id="HW-CTFGeneratingInterruptStatusBitTreesfromIP-XACTregisterdescriptions-Purpose">Purpose</h2><p>The goal is to provide verification with enough information to help them automate some tasks related to verification of interrupts, and to allow reusability of such code across different Symphony network configurations. Examples of such tasks that can be automated with this information include:</p><ol><li>Interrupt routines in TB that run when interrupts are set and clear all interrupt status bits in the hierarchy that caused the interrupt to fire. The interrupts are expected to cleared from the bottom of the tree, starting at the leaf-level bits to the head of the tree.</li><li>Initialization sequences that will help unmask all interrupt bits.</li></ol><p>Extracting the interrupt status bit tree information from the IP-XACT XML, rather than from other sources, also verifies that the interrupt structure in the design matches what is described in the IP-XACT XML.</p><h2 id="HW-CTFGeneratingInterruptStatusBitTreesfromIP-XACTregisterdescriptions-Requirements">Requirements</h2><p>To be able to extract information about interrupt hierarchies from the IP-XACT XML, the every design block that has interrupt registers is expected to include an &quot;<em>InterruptMap</em>&quot; string as part of register descriptions. The specifications for this is described here: <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16329987/HW-CTF+Symphony+Block+Common+Characteristics" data-linked-resource-id="16329987" data-linked-resource-version="1" data-linked-resource-type="page">HW-CTF Symphony Block Common Characteristics</a> (See under section: Interrupt Bit description). The same register descriptions are copied over to the generated IP-XACT XML.</p><h2 id="HW-CTFGeneratingInterruptStatusBitTreesfromIP-XACTregisterdescriptions-Runningthescript">Running the script</h2><p>The script is located in this path:<br/>hw-lib/js/ipxact2InterruptBitTrees.js</p><p>The command to run the script:<br/>$WORK_TOP/../../hw-lib/js/ipxact2InterruptBitTrees.js -i ipxact_xml -o output_json</p><h3 id="HW-CTFGeneratingInterruptStatusBitTreesfromIP-XACTregisterdescriptions-Example:">Example:</h3><ul><li>Build and run a test on a Symphony network with interrupts: runsim -t axi_axi_pmon_2x3_interrupt -c axi_pmon_2x3 -s 12345</li><li>The above command generates also generates an IP-XACT XML here: $WORK_TOP/debug/top_axi_axi/axi_pmon_2x3/rtl/axi_pmon_2x3_top.csr_2014.xml. Run the script to extract <em>InterruptBitTrees</em>: ./ipxact2InterruptBitTrees.js -i $WORK_TOP/debug/top_axi_axi/axi_pmon_2x3/rtl/axi_pmon_2x3_top.csr_2014.xml -o interruptBitTrees.json</li><li>The above command should run without errors or warnings if it was able to successfully able to extract interrupt-related information from registers description strings.</li></ul><p><br/></p><h2 id="HW-CTFGeneratingInterruptStatusBitTreesfromIP-XACTregisterdescriptions-StructureofinterruptBitTreesJSONobject">Structure of <em>interruptBitTrees </em>JSON object</h2><p>&quot;<em>interruptBitTrees</em>&quot;: Array object. Each entry in the array corresponds to one of the interrupt registers at the top-most level in the hierarchy. </p><p>[</p><p>     {</p><p>          <em>tree</em>: A string that tells which interrupt tree this belongs to. Legal values: &quot;ERROR&quot;, &quot;INFO&quot;.</p><p>          <em>statusRegister</em>:  A string that is the name of the register with interrupt status bits.</p><p>          <em>addrBlockName</em>: A string that is the name of the address block in which this register resides.</p><p>          <em>blockID</em>: A string that is the ID of the block or sub-block in which this <em>statusRegister</em> resides.</p><p>          <em>statusBits</em>: This is an object that maps status bit-offsets (keys) to mask-bit and interrupt-source information.</p><p>          {</p><p>             statusBit_i: </p><p>             {</p><p>                <em>maskBit</em>: A number that is the bit-offset of the mask bit in the <em>maskRegister</em>.</p><p>                <em>maskRegister</em>: A string that is the name of the register in which the mask bit for the associated status bit is found. The <em>addrBlockName</em> for this register is same as the <em>addrBlockName</em> of the <em>statusRegister</em>.</p><p>                <em>sources</em>: Optional. An array of type &quot;<em>interruptBitTrees</em>&quot; (Recursive structure), but without the <em>tree</em> field. Each entry now corresponds to one of the sources (interrupt status register) from which the interrupt that sets this bit is generated.</p><p>             }</p><p>          } </p><p>     }</p><p>]</p><p><br/></p><p><br/></p>