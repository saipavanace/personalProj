<h1 id="OBSOLETE-DELETEHW-SYMctl_axi_resp-module_name">module_name</h1><p>ctl_axi_resp</p><h2 id="OBSOLETE-DELETEHW-SYMctl_axi_resp-JavaScriptparameters">JavaScript parameters</h2><p><em>axiRdEn</em>: This is to be set when read-response sub-interface of AXI Interface exists.</p><p><em>axiWrEn</em>: This is to be set when write-response sub-interface of AXI interface exists.</p><h2 id="OBSOLETE-DELETEHW-SYMctl_axi_resp-Interfaces">Interfaces</h2><p><em>clkInterface</em>: A slave interface of type <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfaceCLK" rel="nofollow">InterfaceCLK</a>.</p><p><em>axiRInterface</em>: A slave interface that is the read-response sub-interface of InterfaceAXI.</p><p><em>axiBInterface</em>: A slave interface that is the write-response sub-interface of InterfaceAXI.</p><p><em>ctlRespInterface</em>: A master interface that is the <em><strong>InterfaceCTLResp</strong>  (NDP) </em>sub-interface (ctl_req_) of <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfaceCTL" rel="nofollow">InterfaceCTL</a>.</p><p><em>ctlRespDpInterface</em>: A master interface that is the <em><strong>InterfaceCTLResp</strong> (DP) </em>sub-interface (ctl_req_) of <a class="external-link" href="https://confluence.arteris.com/display/ENGR/InterfaceCTL" rel="nofollow">InterfaceCTL</a>.</p><h2 id="OBSOLETE-DELETEHW-SYMctl_axi_resp-BlockDiagram">Block Diagram</h2><p><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" height="400" src="https://arterisip.atlassian.net/wiki/download/attachments/16172127/image2020-4-17%2016:50:47.png?api=v2"></span></p><p><br/></p><h2 id="OBSOLETE-DELETEHW-SYMctl_axi_resp-Description">Description</h2><p>This component translates responses on the CTL response sub-interfaces to responses on the read-response and write-response channels of AXI interface.</p><p>The AXI B write response is generated entirely from CTL RESP (NDP) sub-interface, since there is no data-payload associated with write-responses for AXI.</p><p>Generating the AXI R response however requires both the NDP and the DP sub-interfaces of CTL RESP. This is because creating the per-beat response on AXI R channel requires reading response on the NDP as well as the DP channels of the CTL interface.</p><p>According to the CTL protocol, the CTL RESP NDP channel is expected to send a new command</p><ol><li>For every data-beat that follows a data-beat with <em>ctl_resp_dp_last</em> asserted.</li><li>For every data-beat with a new ID (different from the last one) on the DP channel (read-interleaving ID change).</li></ol><p>Because generating a read-response on AXI R channel (axi_r_resp) requires data from both the NDP (<em>ctl_resp_err</em>) and DP (<em>ctl_resp_dp_resp</em>) channels of CTL RESP, there is a need to either</p><ol><li>Hold the command on the NDP channel (de-assert ready) till the last of the read-response beats arrives or till there is an id change  OR</li><li>Save the <em>ctl_resp_err</em> from the NDP and update whenever there is an id change or when a new command is received (right after a <em>ctl_resp_dp_last</em>).</li></ol><p>The latter strategy of saving the response from the command on NDP channel of CTL is favored since it avoids a bubble when the read-response id changes before <em>ctl_resp_dp_last</em>  arrives (read-interleaving). This can be implemented with a 2-state state-machine, the diagram for which is given below:</p><p><br/></p><p><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" height="250" src="https://arterisip.atlassian.net/wiki/download/attachments/16172127/image2020-4-19%202:12:36.png?api=v2"></span></p><p><br/></p><p>The states and their purpose are described below:</p><ol><li><strong>RD_CMD_AWAIT</strong>: This is the initial state or state on reset. In this state, the 'Saved-Response' has either stale or invalid response. Hence it is necessary to wait for a command on the CTL RESP NDP channel before any data (if available on DP channel) can be sent unless both command and data are available in the same clock.</li><li><strong>RD_CMD_SAVED</strong>: When the state-machine is in this state, the 'Saved-Response' has a valid response stored that can be used to construct the per-beat response for the same ID on the AXI R channel. However if the data-beat that arrived on DP channel has a different ID (read-interleaving), then the 'Saved-Response' is updated with the command for the new ID, hence avoiding a bubble. If the command for the new ID isn't available on the CTL RESP NDP channel, then a bubble is unavoidable, and the state-machine moves to the RD_CMD_AWAIT state.</li></ol><p><br/></p>