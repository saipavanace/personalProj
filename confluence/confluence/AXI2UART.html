<p>This is another UART that can be used, but has a different programming model.</p><h1 id="AXI2UART-Code">Code</h1><p>The following is a link to the *.v files:</p><p style="margin-left: 30.0px;"><a href="https://arterisip.atlassian.net/wiki/download/attachments/16160060/uart_wrapper_2.tar?version=4&amp;modificationDate=1623948715078&amp;cacheVersion=1&amp;api=v2" data-linked-resource-id="16185988" data-linked-resource-version="4" data-linked-resource-type="attachment" data-linked-resource-default-alias="uart_wrapper_2.tar" data-linked-resource-content-type="application/x-tar" data-linked-resource-container-id="16160060" data-linked-resource-container-version="10">uart_wrapper_2.tar</a></p><h1 id="AXI2UART-PortDescription">Port Description</h1><pre>module axi2uart<br/>  #(<br/>    localparam C_AXI_ID_WIDTH      = 11,<br/>    localparam C_AXI_DATA_WIDTH    = 64,<br/>    localparam C_AXI_ADDR_WIDTH    = 44<br/>    )<br/>   (<br/>    input wire                          S_AXI_ACLK, // System clock<br/>    input wire                          S_AXI_ARESETN,<br/><br/> // AXI write address channel signals<br/> // {{{<br/>    input wire                          S_AXI_AWVALID,<br/>    output wire                         S_AXI_AWREADY,<br/>    input wire [C_AXI_ID_WIDTH-1:0]     S_AXI_AWID,<br/>    input wire [C_AXI_ADDR_WIDTH-1:0]   S_AXI_AWADDR,<br/>    input wire [7:0]                    S_AXI_AWLEN,<br/>    input wire [2:0]                    S_AXI_AWSIZE,<br/>    input wire [1:0]                    S_AXI_AWBURST,<br/>    input wire [0:0]                    S_AXI_AWLOCK,<br/>    input wire [3:0]                    S_AXI_AWCACHE,<br/>    input wire [2:0]                    S_AXI_AWPROT,<br/>    input wire [3:0]                    S_AXI_AWQOS,<br/> // }}}<br/> // AXI write data channel signals<br/> // {{{<br/>    input wire                          S_AXI_WVALID,<br/>    output wire                         S_AXI_WREADY,<br/>    input wire [C_AXI_DATA_WIDTH-1:0]   S_AXI_WDATA,<br/>    input wire [C_AXI_DATA_WIDTH/8-1:0] S_AXI_WSTRB,<br/>    input wire                          S_AXI_WLAST,<br/> // }}}<br/> // AXI write response channel signals<br/> // {{{<br/>    output wire                         S_AXI_BVALID,<br/>    input wire                          S_AXI_BREADY,<br/>    output wire [C_AXI_ID_WIDTH-1:0]    S_AXI_BID,<br/>    output wire [1:0]                   S_AXI_BRESP,<br/> // }}}<br/> // AXI read address channel signals<br/> // {{{<br/>    input wire                          S_AXI_ARVALID,<br/>    output wire                         S_AXI_ARREADY,<br/>    input wire [C_AXI_ID_WIDTH-1:0]     S_AXI_ARID,<br/>    input wire [C_AXI_ADDR_WIDTH-1:0]   S_AXI_ARADDR,<br/>    input wire [7:0]                    S_AXI_ARLEN,<br/>    input wire [2:0]                    S_AXI_ARSIZE,<br/>    input wire [1:0]                    S_AXI_ARBURST,<br/>    input wire [0:0]                    S_AXI_ARLOCK,<br/>    input wire [3:0]                    S_AXI_ARCACHE,<br/>    input wire [2:0]                    S_AXI_ARPROT,<br/>    input wire [3:0]                    S_AXI_ARQOS,<br/> // }}}<br/> // AXI read data channel signals<br/> // {{{<br/>    output wire                         S_AXI_RVALID, // Rd rslt valid<br/>    input wire                          S_AXI_RREADY, // Rd rslt ready<br/>    output wire [C_AXI_ID_WIDTH-1:0]    S_AXI_RID, // Response ID<br/>    output wire [C_AXI_DATA_WIDTH-1:0]  S_AXI_RDATA,// Read data<br/>    output wire                         S_AXI_RLAST, // Read last<br/>    output wire [1:0]                   S_AXI_RRESP, // Read response<br/>                // UART signals<br/>    output wire                         int_o,<br/>    input wire                          rx,<br/>    output wire                         tx);<br/><br/></pre><h1 id="AXI2UART-RegisterDescription">Register Description</h1><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Name</p></th><th style="text-align: left;" class="confluenceTh"><p>AXI Address[8:6]</p></th><th style="text-align: left;" class="confluenceTh"><p>Width</p></th><th style="text-align: left;" class="confluenceTh"><p>Access</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd">Receiving Buffer</td><td style="text-align: left;" class="confluenceTd">3'd0</td><td style="text-align: left;" class="confluenceTd">64</td><td style="text-align: left;" class="confluenceTd">R</td><td style="text-align: left;" class="confluenceTd">Receiver FIFO output</td></tr><tr><td style="text-align: left;" class="confluenceTd">Transmit Buffer</td><td style="text-align: left;" class="confluenceTd">3'd1</td><td style="text-align: left;" class="confluenceTd">64</td><td style="text-align: left;" class="confluenceTd">W</td><td style="text-align: left;" class="confluenceTd">Transmit FIFO input</td></tr><tr><td style="text-align: left;" class="confluenceTd">Interrupt Status Reg</td><td style="text-align: left;" class="confluenceTd">3'd2</td><td style="text-align: left;" class="confluenceTd">64</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">Enable/Mask interrupts generated by UART</td></tr><tr><td style="text-align: left;" class="confluenceTd">Interrupt Mask Reg</td><td style="text-align: left;" class="confluenceTd">3'd3</td><td style="text-align: left;" class="confluenceTd">64</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd"><p>Get interrupt information</p></td></tr><tr><td style="text-align: left;" class="confluenceTd">Counter Reg</td><td style="text-align: left;" class="confluenceTd">3'd4</td><td style="text-align: left;" class="confluenceTd">64</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">Control FIFO options</td></tr><tr><td style="text-align: left;" class="confluenceTd">Trigger Reg</td><td style="text-align: left;" class="confluenceTd">3'd5</td><td style="text-align: left;" class="confluenceTd">64</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">Control connection</td></tr></tbody></table></div><p class="auto-cursor-target">The AXI address bits [43:9] and [5:0] are ignored by the logic, and so these registers are repeated across the entire AXI address space.</p><h1 class="auto-cursor-target" id="AXI2UART-ReceivingBuffer">Receiving Buffer</h1><p class="auto-cursor-target">You can do an INCR burst read to this address up to 64 bytes in length. There are two 64 byte FIFOs (left and right) that are written by the incoming UART rx pin. When you read the Interrupt Status Reg the FIFO being used is changed to the other one. The code starts with using the &quot;right&quot; FIFO. Even if the FIFO isn't full, the code will return the number of bytes requested in the read, with the extra bytes just filled with random data. There is an interrupt that is generated from the selecting incoming FIFO when either the number of bytes equals the values in the Trigger Reg, or there are when the Timer counts the number of clocks indicated in Counter Reg.</p><p class="auto-cursor-target">The FIFO being read from the AXI flips upon completion of the AXI read, so all the data needs to be read from the FIFO or the incoming data will become corrupted.</p><h1 class="auto-cursor-target" id="AXI2UART-TransmitBuffer">Transmit Buffer</h1><p class="auto-cursor-target">You can do an INCR burst write to this address up to 64 bytes in length. The FIFO is filled based on the Data Strobes that come with the data. This data is pushed onto a transmitting FIFO that is connect to pin tx that is 64 bytes in depth. An interrupt is generated when the FIFO transitions from not empty to empty.</p><h1 class="auto-cursor-target" id="AXI2UART-InterruptStatusReg">Interrupt Status Reg</h1><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Name</p></th><th style="text-align: left;" class="confluenceTh"><p>Bits</p></th><th style="text-align: left;" class="confluenceTh"><p>default</p></th><th style="text-align: left;" class="confluenceTh"><p>Access</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd">receiving interrupt</td><td style="text-align: left;" class="confluenceTd">63</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates a receiving FIFO has reached trigger</td></tr><tr><td style="text-align: left;" class="confluenceTd">transmitting interrupt</td><td style="text-align: left;" class="confluenceTd">62</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates the sending FIFO has drained</td></tr><tr><td style="text-align: left;" class="confluenceTd">timer interrupt</td><td style="text-align: left;" class="confluenceTd">61</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates the timer has fired</td></tr><tr><td style="text-align: left;" class="confluenceTd">UART error interrupt</td><td style="text-align: left;" class="confluenceTd">60</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd"><p>1 indicates an error happened on the incoming UART data</p></td></tr><tr><td style="text-align: left;" class="confluenceTd">Overflow interrupt</td><td style="text-align: left;" class="confluenceTd">59</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates a receiving FIFO has overflowed and data was lost</td></tr><tr><td style="text-align: left;" class="confluenceTd">receiving FIFO byte count</td><td style="text-align: left;" class="confluenceTd">6:0</td><td style="text-align: left;" class="confluenceTd">N/A</td><td style="text-align: left;" class="confluenceTd">R</td><td style="text-align: left;" class="confluenceTd">The number of bytes in the selected receiving FIFO</td></tr></tbody></table></div><p class="auto-cursor-target">The interrupts bits in this register are ORed together and presented on output port int_o.</p><p class="auto-cursor-target">When reading data from the input FIFO, always use the number of bytes indicated in this register as the bytes you should read, because extra bytes may have accumulated in the FIFO between the time the interrupt fired because of the trigger when you read this register.</p><p class="auto-cursor-target">The interrupts are cleared when the register is read. </p><p class="auto-cursor-target">You can generated an interrupt  by writing the register.</p><h1 class="auto-cursor-target" id="AXI2UART-InterruptMaskReg">Interrupt Mask Reg</h1><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Name</p></th><th style="text-align: left;" class="confluenceTh"><p>Bits</p></th><th style="text-align: left;" class="confluenceTh"><p>default</p></th><th style="text-align: left;" class="confluenceTh"><p>Access</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd">receiving interrupt mask</td><td style="text-align: left;" class="confluenceTd">63</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates receiving interrupt is masked from int_o</td></tr><tr><td style="text-align: left;" class="confluenceTd">transmitting interrupt mask</td><td style="text-align: left;" class="confluenceTd">62</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates transmitting interrupt is masked from int_o</td></tr><tr><td style="text-align: left;" class="confluenceTd">timer interrupt mask</td><td style="text-align: left;" class="confluenceTd">61</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates timer interrupt is masked from int_o</td></tr><tr><td style="text-align: left;" class="confluenceTd">UART error interrupt mask</td><td style="text-align: left;" class="confluenceTd">60</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd"><p>1 indicates UART error interrupt is masked from int_o</p></td></tr><tr><td style="text-align: left;" class="confluenceTd">Overflow interrupt mask</td><td style="text-align: left;" class="confluenceTd">59</td><td style="text-align: left;" class="confluenceTd">1'b0</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">1 indicates Overflow interrupt is masked from int_o</td></tr></tbody></table></div><h1 class="auto-cursor-target" id="AXI2UART-CounterReg">Counter Reg</h1><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Name</p></th><th style="text-align: left;" class="confluenceTh"><p>Bits</p></th><th style="text-align: left;" class="confluenceTh"><p>default</p></th><th style="text-align: left;" class="confluenceTh"><p>Access</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd">receiving interrupt mask</td><td style="text-align: left;" class="confluenceTd">23:0</td><td style="text-align: left;" class="confluenceTd">24'd1000000</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">The number of clocks to count from the last interrupt Reg read</td></tr></tbody></table></div><h1 class="auto-cursor-target" id="AXI2UART-TriggerReg">Trigger Reg</h1><div class="table-wrap"><table class="wrapped confluenceTable"><colgroup><col/><col/><col/><col/><col/></colgroup><thead><tr><th style="text-align: left;" class="confluenceTh"><p>Name</p></th><th style="text-align: left;" class="confluenceTh"><p>Bits</p></th><th style="text-align: left;" class="confluenceTh"><p>default</p></th><th style="text-align: left;" class="confluenceTh"><p>Access</p></th><th style="text-align: left;" class="confluenceTh"><p>Description</p></th></tr></thead><tbody><tr><td style="text-align: left;" class="confluenceTd">Trigger</td><td style="text-align: left;" class="confluenceTd">6:0</td><td style="text-align: left;" class="confluenceTd">7'd8</td><td style="text-align: left;" class="confluenceTd">RW</td><td style="text-align: left;" class="confluenceTd">The number of bytes in selected read FIFO to cause a receiving interrupt</td></tr></tbody></table></div>