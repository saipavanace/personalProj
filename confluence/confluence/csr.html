<h2 id="csr-Purpose">Purpose</h2><p>A CSR specification is typically in the form of a JSON object that provides enough information to translate it into an <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16169519/IP-XACT+-+IEEE+1685-2014" data-linked-resource-id="16169519" data-linked-resource-version="1" data-linked-resource-type="page">IP-XACT - IEEE 1685-2014</a> specification for registers. It is meant for Arteris internal-use only and has the following purposes:</p><ol><li>To generate register read-write logic by TACHL components such as <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a>. </li><li>To generate register, field, address space, definitions in a TACHL component based on design parameters and communicate it to other TACHL components.</li><li>There are Arteris tools (Ex: Stitcher, Maestro) that can translate the CSR specification into an IP-XACT specification (XML) for registers. And once translated, the translated IP-XACT can be consumed by third party tools such as Ralgen.</li></ol><h2 id="csr-Description">Description</h2><p>The CSR specification provides descriptions for a set of control status registers and fields that are to be accessed by software (via an interface such as <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168579/InterfaceAPB" data-linked-resource-id="16168579" data-linked-resource-version="2" data-linked-resource-type="page">InterfaceAPB</a>). A TACHL component that implements such registers based on the CSR specification for access by software via <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16168579/InterfaceAPB" data-linked-resource-id="16168579" data-linked-resource-version="2" data-linked-resource-type="page">InterfaceAPB</a> is the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a>.</p><p>When the CSR specification is passed to TACHL components that must include registers, it is passed as a JSON object called &quot;<em>csr</em>&quot;.</p><h2 id="csr-Structure">Structure</h2><p>The structure of the CSR specification is hierarchical. It's JSON structure is described below:</p><h3 id="csr-csr:">csr:</h3><p>{</p><p style="margin-left: 30.0px;"><em>addressWidth</em>: Integer. A positive integral power of 2 equal to the full-size ( as a power of 2) of the address-space within which all the registers exist. This is <strong>not the same as the address-bus (paddr) width</strong> and must always be lesser than or equal to the address bus width or paddr width.</p><p style="margin-left: 30.0px;"><em>width</em>: Integer. A positive integral power of 2 equal to the width of each register in bits. Typically 32 bits.</p><p style="margin-left: 30.0px;"><em>spaceBlock</em>: Array object. This is an array of space-blocks, each of which includes descriptions for a set of registers. Registers in different space-blocks may have identical descriptions (including identical names), but are distinguished by different baseAddresses. They correspond roughly to an addressBlock in <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16169519/IP-XACT+-+IEEE+1685-2014" data-linked-resource-id="16169519" data-linked-resource-version="1" data-linked-resource-type="page">IP-XACT - IEEE 1685-2014</a> register specification. The structure is as follows:</p><p style="margin-left: 30.0px;">  [<br/>  {</p><p style="margin-left: 60.0px;"><em>baseAddress</em>: Integer. The address offset for the space-block of registers. A register address is the sum of the <em>baseAddress</em> + <em>addressOffset</em> of the register.</p><p style="margin-left: 60.0px;"><em>registers</em>: Array object. This is an array of register descriptions, the structure of which is described below.</p><p style="margin-left: 60.0px;">  [<br/>  {</p><p style="margin-left: 90.0px;"><em>name</em>: String. A string that describes the name of the register.</p><p style="margin-left: 90.0px;"><em>description</em>: String. A string that describes what the register is for.</p><p style="margin-left: 90.0px;"><em>csrDescription</em>: String. A string that describes what the register is for and makes its way to description strings in IP-XACT. In addition to details about the register and it's bits, this can be used to include information to identify which block the register belongs to such as followed in Symphony</p><p style="margin-left: 90.0px;"><em>addressOffset</em>: Integer. A positive integral power of 2 equal to the byte address offset at which the register exists within the spaceBlock. The actual address of the register is the sum of the <em>baseAddress + </em><em>addressOffset</em> of the register.</p><p style="margin-left: 90.0px;"><em>specialImplementation</em>: Boolean. True or false.</p><p style="margin-left: 90.0px;"><em>regOpEn</em>: Boolean. True or false. If this is true, the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> block generates additional ports (*_wr_en, and *_rd_en) that can be used to enable or disable access to registers from outside the block. The field can also be used by tools to exclude registers from the generated IP-XACT XML.</p><p style="margin-left: 90.0px;"><em>tzMode</em>: String. A string that can take one of three values: &quot;secure&quot;, &quot;nonSecure&quot;, &quot;programmable&quot;. Default value when unspecified: 'secure'. The apb_csr creates *_tz input ports on a per-register basis and for only those registers for which this parameter is set to &quot;programmable&quot;. For &quot;secure&quot;, the corresponding tz bit for that register is assumed to be tied off low, and for &quot;nonSecure&quot;, tied-off high.</p><p style="margin-left: 90.0px;"><em>protectedAccess</em>: Boolean. True or false. If this is true, then the read-write transactions to the register maybe blocked by a block that filters read-write transactions to the register. This parameter is expected to be set by the customer, ignored by <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a>, but expected to be used by tools that generate <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16169519/IP-XACT+-+IEEE+1685-2014" data-linked-resource-id="16169519" data-linked-resource-version="1" data-linked-resource-type="page">IP-XACT</a> to either organize registers into memory maps or to create multiple IP-xACT XMLs.</p><p style="margin-left: 90.0px;"><em>fields</em>: Array object. An array of field descriptions in the register, the structure of which is described below:</p><p style="margin-left: 90.0px;">  [<br/>  {</p><p style="margin-left: 120.0px;"><em>name</em>: String. A string that describes the name of the field.</p><p style="margin-left: 120.0px;"><em>bitOffset</em>: Integer. A positive integer that is equal to the offset of the bit from the LSB.</p><p style="margin-left: 120.0px;"><em>bitWidth</em>: Integer. A positive integer that is equal to the width of the field in bits.</p><p style="margin-left: 120.0px;">description: String. A string that describes the what the field is for.</p><p style="margin-left: 120.0px;"><em>reset</em>: Integer. A integer that lies in the range 0 to 2<sup><em>bitWidth</em></sup>- 1. This is the value that the register is expected to take at reset.</p><p style="margin-left: 120.0px;"><em>access</em>: String. A string that specifies the read-write accessibility of the register-field from the software-side. The values it can take is described in the RW accessibility sections. This is the field that is copied to &quot;<em>access</em>&quot; field in IP-XACT schema for register bit fields.</p><p style="margin-left: 120.0px;"><em>hardware</em>: String. A string that specifies the read-write accessibility of the register-field from the hardware-side or by hardware-logic. The values it can take is described in the RW accessibility sections.</p><p style="margin-left: 120.0px;"><em>linkOp</em>: String. Unsupported by <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> at the moment.</p><p style="margin-left: 120.0px;"><em>opOrder</em>: String. A string that can take the following values: &quot;HW&quot;, &quot;SW&quot;. When simultaneous (same clock-cycle) updates from both software and hardware are attempted, &quot;SW&quot; specifies hardware has higher priority, and software has higher priority otherwise.</p><p style="margin-left: 120.0px;"><em>volatile</em>: Boolean. True indicates that hardware can potentially update this field during register read-write bit-bash tests. Otherwise false. Expected to be copied to '<em>volatile</em>' element in IP-XACT register field schema.</p><p style="margin-left: 90.0px;">}<br/>]</p><p style="margin-left: 60.0px;">}<br/>]</p><p style="margin-left: 30.0px;">}<br/>]</p><p>}</p><h2 id="csr-Read-writeaccessibility">Read-write accessibility</h2><p>There are fields in the field descriptions that specify whether that field can be written/updated to and read by software (<em>access</em> field)<em> </em>and hardware logic (<em>hardware</em> field). Below are the description of values that these fields can take:</p><p><em>RW</em>: Read-write. The given field is both readable and write-able. When <em>hardware</em> is set to <em>RW</em> this means that, *_in, *_wr ports, as well as *_out ports are generated for the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> component so that external logic can both read and update the bits.</p><p><em>RO</em>: Read-only. The given field cannot be written to or updated. When <em>hardware</em> is set to <em>RO</em> this means that, *_in, *_wr ports input ports will not be generated for the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> component.</p><p><em>W1C</em>: Write-one-to-clear. Used only for access (software-side only). In this case, the <em>hardware</em> (hardware-side) is expected to be set to RW which means that it is some sort of a status bit or interrupt bit that is set by hardware to indicate something happened. And software is expected to clear the bit by writing a 1 to it.</p><p><em>WO</em>: Write-only. The given field can only be written to. On the hardware side this would mean that no *_out ports are generated for the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> component.</p><p><br/></p><p>In addition to these legal values, the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> supports only certain legal combinations of values for <em>access</em> and <em>hardware</em> fields. Refer the <a href="https://arterisip.atlassian.net/wiki/spaces/ENGR/pages/16171929/apb_csr" data-linked-resource-id="16171929" data-linked-resource-version="3" data-linked-resource-type="page">apb_csr</a> component for this information.</p><p><br/></p><p><br/></p><p><br/></p>