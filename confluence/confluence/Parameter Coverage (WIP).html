<p>UPDATED: 2024-07-11, param_cov.js version 0.1.7</p><p>Location: $WORK_TOP/dv/scripts/param_cov (note: Ncore 3.7 and above)</p><p>This script is intended to perform coverage analysis of the generated configuration parameters from Maestro.  It generally expects the format of the top.level.dv.json file but it works with other formats (e.g. interim format from Maestro for allowed values).</p><p>(you will need to <code>npm install xlsx</code> manually until Balaji makes it part of the 3.7 environment)</p><h2 id="ParameterCoverage(WIP)-Filesandsubdirectories">Files and subdirectories</h2><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="23d1ed11-fabb-4c57-bd86-0eb9bee26a80" class="confluenceTable"><colgroup><col style="width: 284.0px;"/><col style="width: 474.0px;"/></colgroup><tbody><tr><th class="confluenceTh"><p><strong>Name</strong></p></th><th class="confluenceTh"><p><strong>Description</strong></p></th></tr><tr><td class="confluenceTd"><p>param_cov.js</p></td><td class="confluenceTd"><p>the main script, see below</p></td></tr><tr><td class="confluenceTd"><p>README.md</p></td><td class="confluenceTd"><p>this file</p></td></tr><tr><td class="confluenceTd"><p>utils/</p></td><td class="confluenceTd"><p>directory of additional files</p></td></tr><tr><td class="confluenceTd"><p>utils/reference_parameters.json</p></td><td class="confluenceTd"><p>all allowed parameter values</p></td></tr><tr><td class="confluenceTd"><p>utils/template.html</p></td><td class="confluenceTd"><p>template for html output</p></td></tr><tr><td class="confluenceTd"><p>tests/</p></td><td class="confluenceTd"><p>local dir for test inputs (not in gitlab)</p></td></tr><tr><td class="confluenceTd"><p>old/</p></td><td class="confluenceTd"><p>temporary dir for pre 3.7 verion</p></td></tr></tbody></table></div><h2 id="ParameterCoverage(WIP)-Usage">Usage</h2><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">./param_cov.js -h

  Usage: param_cov [options]

  Options:

    -V, --version                    output the version number
    -b, --json_file &lt;string&gt;         specify a base filename with configuration data, default is top.level.dv.json
    -c, --csv                        create a csv output file, default name coverage_results.csv
    -d, --debug                      specify this to print helpful debug information
    -f, --params_list_file &lt;string&gt;  file containing a list of Json files
    -j, --json                       create a Json output file named coverage_results.json
    -l, --params_list &lt;items&gt;        comma separated string of Json files
    -m, --merge &lt;string&gt;             merge new results into existing results, provide the file to merge into (WIP)
    -p, --params_path &lt;string&gt;       path to look for ALL Json files (be careful, use -b if needed)
    -o, --out_file_name &lt;string&gt;     override the output file name, default is coverage_results
    -r, --ref_file_name &lt;string&gt;     specify a reference Json file, default is $WORK_TOP/dv/scripts/param_cov/utils/reference_parameters.json
    -t, --todo                       list remaining work to do
    -w, --web                        create an html output file (and Json), default name coverage_results.html
    -x, --xlsx                       create an Excel file, default name is coverage_results.xlsx
    -h, --help                       output usage information</pre>
</div></div><p><strong>NOTE:</strong> the <code>reference_parameters.json</code> file contains the data expected to be covered.  You can change this as needed.  For example, if a range like [ &quot;0:8192&quot; ] is too large, you can break it up as in<br/>[ &quot;0:12&quot;, &quot;8180:8192&quot; ].  This would make sure that all values between 0 through 12 and 8180 through 8192 (26 total values) are covered.  The trade-off is that (valid) values outside these ranges would be listed as invalid.</p><h2 id="ParameterCoverage(WIP)-Examples">Examples</h2><p>(all assume running from <code>$WORK_TOP/dv/scripts/param_cov</code>)</p><h3 id="ParameterCoverage(WIP)-Example1">Example 1</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">./param_cov.js -l tests/top.level.dv.json -w -o test_output</pre>
</div></div><p>This will read the configuration data in <code>tests/top.level.dv.json</code>, score it against the allowable values in <code>utils/reference_parameters.json</code> and create <code>test_output.html</code> and <code>test_output.json</code> files.  The <code>test_output.html</code> file can be used to view and interact with the data.  These two files can be moved anywhere convenient, but they must be in the same directory and that directory must be accessible to the web server.</p><h3 id="ParameterCoverage(WIP)-Example2">Example 2</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">./param_cov.js -f tests/my_random_json.lst -w -o many_configs</pre>
</div></div><p>This will read the configuration data from the list of files specified in <code>tests/my_random_json.list</code> and create <code>many_configs.html</code> and <code>many_configs.json</code> files.  As above, these two files can be moved.</p><h3 id="ParameterCoverage(WIP)-Example3">Example 3</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">./param_cov.js -p /scratch/spavan/randomizer_config_database -b dv*.json -x -o dir_excel</pre>
</div></div><p>This will read the configuration data from any Json file named <code>dv*.json</code> that appears in <code>/scratch/spavan/randomizer_config_database</code> or below and creates an Excel file named <code>dir_excel.xls</code> with the aggregate results.  This is particularly useful for use with the parameter randomizer as those config files are named <code>dv_${seed}.json</code></p><p><em><strong>Note</strong></em>: using -p without -b will cause the script to use ANY Json file it finds in that tree.  Thus, it is wise to use -b since it is highly likely that there will be other Json files that are not formatted as expected.  In the example for instance, the tree provided with -p includes files named <code>params_${seed}.json</code> that have a completely different format.  Including them may cause erroneous results.</p><h3 id="ParameterCoverage(WIP)-Example4">Example 4</h3><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">./param_cov.js -l tests/top.level.dv.json -d</pre>
</div></div><p>This will print a few informative messages and then print the coverage structure to the console.  This is not useful in most cases.</p><h2 id="ParameterCoverage(WIP)-ToDo">To Do</h2><p>This is available using the script:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: bash; gutter: false; theme: Confluence" data-theme="Confluence">./param_cov.js -t</pre>
</div></div><p>This will print the to-do list and exit.  Other options are ignored.  Current output is below:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: text; gutter: false; theme: Confluence" data-theme="Confluence">- populate proper reference values
- (WIP) add merging new raw Json data into exisiting coverage Json
- add merging two existing coverage Jsons
- add cross-coverage
- discuss exclusions, implement -- esp invalid values that aren&#39;t really invalid
- consider counting number of times a value is seen
- discuss need for per-instance coverage</pre>
</div></div><p />