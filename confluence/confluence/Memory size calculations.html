<p><strong><u>Cache size Calculation</u></strong></p><p>Assume cache line = 64Bytes (wCacheLineOffset = 6)</p><p><strong>Total cache size == nSets x nWays x 64Bytes + (optionally ECC bits for each line)</strong></p><p><strong>Cache lines = nSets * nWays</strong></p><p /><p>For example:   DMI config10_lite has 2048 sets &amp; 16 ways</p><p style="margin-left: 60.0px;">          = 2048 * 16 * 64 == ~2MBytes</p><p> </p><p>Ncore ranges:</p><p>nSets: (2-8192)</p><p>nWays: (2-16)</p><p>Thus, Ncore 3.4/3.6 has ranges: min to max è 256Byte to ~8MByte</p><p> </p><p><strong><u>Cache slice Computations:</u></strong></p><p><strong>Cache depth = (nSets * nWays)/nDataBanks</strong></p><p style="margin-left: 90.0px;">      nDataBanks = 2 power of DataBankSelBits</p><p> </p><p><strong>Cache width = wPoison + (wData * nBeatsPerBank) +wErrorBits</strong></p><p> </p><p>wErrorBits = Math.ceil(Math.log2(wInstData + Math.ceil(Math.log2(wInstData)) + 1)) + 1</p><p>                       Log2 of [(wInstData + log2 (wInstData) +1] +1</p><p> </p><p>wInstData = wPoison + (wData * nBeatsPerBank) + log2(Depth)</p><p>wPoison = 1 (always 1)</p><p> </p><p><strong>Example: </strong></p><p>Config: hw_config_10_lite</p><ol start="1"><li><p><strong><u>DMI dataMem</u></strong></p></li></ol><p>      nSets = 2048</p><p>      nWays = 16</p><p>      wdata = 256</p><p>               </p><p style="margin-left: 30.0px;"><strong>Cache Size</strong> = <strong>nSets * nWays * 64 </strong>=<strong> </strong>2048 * 16 * 64 = 2097152 = ~2MB</p><p style="margin-left: 30.0px;"><strong>Data Depth = (nSets * nWays)/nDataBanks</strong></p><p>                              nDataBanks = 2 power of DataBankSelBilts = [list 9 11] which is 2 (i.e, bit 9 and bit 11)</p><p>                              or</p><p>                              nDataBanks value can be found in JSON file</p><p>                           = (2048 *16)/4 = 32768/4 = 8192</p><p> </p><p>        <strong>Data</strong> <strong>Width = wPoison + (wData * nBeatsPerBank) +wErrorBits</strong></p><p>                                wInstData =  wPoison + (wData * nBeatsPerBank) + log2(Depth)</p><p>                                                = 1 + (256 *2) + log2 (8192)</p><p style="margin-left: 60.0px;">                                  = 1 + 512 + 13 = 526</p><p>                               wErrorBits = Math.ceil[log2 of {wInstData + Math.ceil(log2 (wInstData)) + 1}] +1</p><p>                                                = Math.ceil[log2 of {526 + Math.ceil(log2(526)) + 1}] + 1</p><p>                                                = Math.ceil[log 2 of {526 + 10 + 1}] + 1</p><p>                                                = Math.ceil[log 2 of (537] + 1</p><p>                                                = Math.ceil(9.0687) + 1</p><p>                                                = 10 + 1 = 11</p><p>                               <em>Note</em>: Math.log2 (526) = log2 (526) = 9.0389 = 9</p><p>                                        Math.ceil(log2(526)) = Math.ceil(9.0389) = 10    </p><p /><p><strong>  Data Width = wPoison + (wData * nBeatsPerBank) +wErrorBits</strong></p><p>                       = 1 + (256 * 2) + 11 = 1 + 512 + 1 = 524</p><p><strong>  </strong></p><p><strong>  </strong><em><strong>Data Mem Slice: 524 x 8192 (width x depth)</strong></em></p><p>                             </p><ol start="2"><li><p><strong><u>DMI tagMem</u></strong></p></li></ol><p style="margin-left: 30.0px;">wAddr = 48</p><p style="margin-left: 30.0px;">TagBankSelBits = [list 9] = 1</p><p> </p><p style="margin-left: 30.0px;"><strong>Tag depth = nSets/nTagBanks</strong></p><p style="margin-left: 120.0px;">nTagBanks = 2 power of TagBankSelBits</p><p style="margin-left: 90.0px;">                         = 2048/2 power of 1 = 2048/2 = 1024</p><p><strong> </strong></p><p style="margin-left: 30.0px;"><strong>Tag width = nWays * (wSecurity + wTagEntry +wState +wNRU + wErrorBits)</strong></p><p style="margin-left: 30.0px;">                  = 16 * (1 + 31 + 2 +0 + 7) = 656</p><p>                        wTagEntry = wAddr - wCachelineOffset - PriSubDiagAddrBits.length - PortPriSubDiagAddrBits.length + log2ceil( Math.pow(2, PortPriSubDiagAddrBits.length))</p><p>                                  = 48 – 6 – 11 + 0 + 0 = 31</p><p>              Log2.ceil (Math.pow(2,0)) = log2ceil(2 power of 0 = 1) = log2 ceil (1) = 0</p><p>              NRU (Near Reply Policy; if it is RANDOM = 0, if not 1)</p><p>              Note:   Math.pow(base, exponent) = 2 power of 0 = 0</p><p>                         wSecurity, wCachelineOffset, PortPriSubDiagAddrBits.length comes from JSON file.</p><p>                         PriSubDiagAddrBits.length comes from post_map_params.tcl</p><p>                      </p><p style="margin-left: 60.0px;">       wInstData = (wSecurity + wTagEntry + wState + wNRU) + log2ceil(Depth)</p><p>                                      = (1 + 31 + 2 + 0) + log2(1024)</p><p>                                      = 33 + 10 = 43</p><p style="margin-left: 30.0px;">              wErrorBits = Math.ceil(Math.log2(wInstData + Math.ceil(Math.log2(wInstData)) + 1)) + 1</p><p style="margin-left: 60.0px;">                        = Math.ceil[log2{43 + Math.ceil(log2 of 43) + 1}] + 1</p><p style="margin-left: 60.0px;">                        = Math.ceil[log2{43 + 6 +1}] + 1</p><p style="margin-left: 90.0px;">                 = 6 + 1 = 7</p><p><em><strong>Data Tag slice : 656 x 1024 (width x depth)</strong></em></p><p> </p><p>References:</p><p>Config tcls: /scratch/smusini/devel/projects/hw_cfg_10_lite/hw_cfg_10_lite_Ncore_3.6.0-10153_rtl_120823/hw-test-projects/ncore_v3.6_configs/base_configs/hw_config_10_lite/*.tcl</p><p>JSON files: /scratch/smusini/devel/projects/hw_cfg_10_lite/hw_cfg_10_lite_Ncore_3.6.0-10153_rtl_120823/output/debug/debug_json</p><p>Memory sizes: /scratch/smusini/devel/projects/hw_cfg_10_lite/hw_cfg_10_lite_Ncore_3.6.0-10153_rtl_120823/output/rtl/models/memories</p>